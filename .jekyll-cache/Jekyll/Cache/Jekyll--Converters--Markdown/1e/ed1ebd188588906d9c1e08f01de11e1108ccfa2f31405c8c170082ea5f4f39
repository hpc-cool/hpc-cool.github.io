I"ì2<p>æˆ‘ä»¬ä¼šä½¿ç”¨æ§ä»¶æ‹–åŠ¨ï¼Œå¯ä»¥è®©æˆ‘ä»¬åšå‡ºå¥½çœ‹çš„åŠ¨ç”»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç§»åŠ¨æ§ä»¶ï¼Œæˆ‘å°†ä¼šå‘Šè¯‰å¤§å®¶å¤šä¸ªæ–¹æ³•ã€‚å…¶ä¸­ç¬¬ä¸€ä¸ªæ˜¯æœ€å·®çš„ï¼Œæœ€åçš„æ‰æ˜¯æˆ‘å¸Œæœ›å¤§ç¥ä½ å»ç”¨ã€‚</p>

<!--more-->

<!-- CreateTime:2018/8/10 19:16:50 -->

<div id="toc"></div>

<h2 id="margin-ç§»åŠ¨">Margin ç§»åŠ¨</h2>

<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Marginç§»åŠ¨ï¼Œä½†è¿™æ˜¯wrè¯´ä¸è¦è¿™æ ·åšã€‚</p>

<blockquote>
  <p>We can move the control by Margin,but using this method is not recommended.</p>
</blockquote>

<p>æˆ‘ä»¬å¯ä»¥åœ¨xamlå†™ä¸€ä¸ªButtonï¼Œç„¶åå°±ä½¿ç”¨å·¦é”®è·å–é¼ æ ‡ï¼Œè¿™ä¸ªå¯ä»¥å»çœ‹ win10 uwp è·å–æŒ‰é’®é¼ æ ‡å·¦é”®æŒ‰ä¸‹</p>

<p>http://lindexi.oschina.io/lindexi/post/win10-uwp-%E8%8E%B7%E5%8F%96%E6%8C%89%E9%92%AE%E9%BC%A0%E6%A0%87%E5%B7%A6%E9%94%AE%E6%8C%89%E4%B8%8B/</p>

<p>äºæ˜¯åœ¨Button_OnPointerMovedï¼Œæˆ‘ä»¬è·å–ç§»åŠ¨çš„xy</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PointerPoint</span> <span class="n">point</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="nf">GetCurrentPoint</span><span class="p">(</span><span class="n">btn</span><span class="p">);</span>

</code></pre></div></div>

<p>è¿™æ ·<code class="language-plaintext highlighter-rouge">point.Position.X</code>å°±æ˜¯ç§»åŠ¨çš„å·¦è¾¹</p>

<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code class="language-plaintext highlighter-rouge">x += point.Position.X - btn.ActualWidth / 2.0;</code></p>

<p>è¿™æ˜¯å› ä¸º<code class="language-plaintext highlighter-rouge">btn.ActualWidth / 2.0</code>ä¸ç”¨çš„è¯ä¼šæ˜¯æ§ä»¶çš„å·¦ä¸Šè§’ã€‚</p>

<p>æˆ‘ä»¬æŠŠå®ƒç»™Margin</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">Button_OnPointerMoved</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">PointerRoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Button</span> <span class="n">btn</span><span class="p">=</span><span class="n">sender</span> <span class="k">as</span> <span class="n">Button</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">btn</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">e</span><span class="p">.</span><span class="n">Handled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

            <span class="n">PointerPoint</span> <span class="n">point</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="nf">GetCurrentPoint</span><span class="p">(</span><span class="n">btn</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">.</span><span class="n">Properties</span><span class="p">.</span><span class="n">IsLeftButtonPressed</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">double</span> <span class="n">x</span> <span class="p">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">btn</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">Canvas</span><span class="p">.</span><span class="n">LeftProperty</span><span class="p">);</span>
                <span class="kt">double</span> <span class="n">y</span> <span class="p">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">btn</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">Canvas</span><span class="p">.</span><span class="n">TopProperty</span><span class="p">);</span>
                <span class="n">x</span> <span class="p">+=</span> <span class="n">point</span><span class="p">.</span><span class="n">Position</span><span class="p">.</span><span class="n">X</span> <span class="p">-</span> <span class="n">btn</span><span class="p">.</span><span class="n">ActualWidth</span> <span class="p">/</span> <span class="m">2.0</span><span class="p">;</span>
                <span class="n">y</span> <span class="p">+=</span> <span class="n">point</span><span class="p">.</span><span class="n">Position</span><span class="p">.</span><span class="n">Y</span> <span class="p">-</span> <span class="n">btn</span><span class="p">.</span><span class="n">ActualHeight</span> <span class="p">/</span> <span class="m">2.0</span><span class="p">;</span>
                <span class="n">btn</span><span class="p">.</span><span class="n">Margin</span><span class="p">=</span><span class="k">new</span> <span class="nf">Thickness</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

</code></pre></div></div>

<h2 id="canvas-æ‹–åŠ¨æ§ä»¶">Canvas æ‹–åŠ¨æ§ä»¶</h2>

<p>æˆ‘ä»¬éœ€è¦æŠŠæ§ä»¶æ”¾åœ¨Canvasï¼Œç„¶åä½¿ç”¨Marginä¸€æ ·çš„</p>

<p>æˆ‘ä»¬éœ€è¦è®¾ç½®é™„ä»¶å±æ€§ï¼Œ<code class="language-plaintext highlighter-rouge">btn.SetValue(Canvas.LeftProperty, x)</code>å°±æ˜¯è®¾ç½®<code class="language-plaintext highlighter-rouge">Canvas.Left</code></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">Button_OnPointerMoved</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">PointerRoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Button</span> <span class="n">btn</span><span class="p">=</span><span class="n">sender</span> <span class="k">as</span> <span class="n">Button</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">btn</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">e</span><span class="p">.</span><span class="n">Handled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

            <span class="n">PointerPoint</span> <span class="n">point</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="nf">GetCurrentPoint</span><span class="p">(</span><span class="n">btn</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">point</span><span class="p">.</span><span class="n">Properties</span><span class="p">.</span><span class="n">IsLeftButtonPressed</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">double</span> <span class="n">x</span> <span class="p">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">btn</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">Canvas</span><span class="p">.</span><span class="n">LeftProperty</span><span class="p">);</span>
                <span class="kt">double</span> <span class="n">y</span> <span class="p">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">btn</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">Canvas</span><span class="p">.</span><span class="n">TopProperty</span><span class="p">);</span>
                <span class="n">x</span> <span class="p">+=</span> <span class="n">point</span><span class="p">.</span><span class="n">Position</span><span class="p">.</span><span class="n">X</span> <span class="p">-</span> <span class="n">btn</span><span class="p">.</span><span class="n">ActualWidth</span> <span class="p">/</span> <span class="m">2.0</span><span class="p">;</span>
                <span class="n">y</span> <span class="p">+=</span> <span class="n">point</span><span class="p">.</span><span class="n">Position</span><span class="p">.</span><span class="n">Y</span> <span class="p">-</span> <span class="n">btn</span><span class="p">.</span><span class="n">ActualHeight</span> <span class="p">/</span> <span class="m">2.0</span><span class="p">;</span>
                <span class="n">btn</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">Canvas</span><span class="p">.</span><span class="n">LeftProperty</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
                <span class="n">btn</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">Canvas</span><span class="p">.</span><span class="n">TopProperty</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

</code></pre></div></div>

<h2 id="manipulation-æ‹–åŠ¨æ§ä»¶">Manipulation æ‹–åŠ¨æ§ä»¶</h2>

<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ‰‹åŠ¿ï¼Œè¿™ä¸ªéœ€è¦åœ¨æ§ä»¶è®¾ç½®<code class="language-plaintext highlighter-rouge">ManipulationMode="All"</code>ï¼Œä½¿ç”¨<code class="language-plaintext highlighter-rouge">ManipulationDelta</code></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">Button_OnManipulationDelta</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">ManipulationDeltaRoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Button</span> <span class="n">btn</span> <span class="p">=</span> <span class="n">sender</span> <span class="k">as</span> <span class="n">Button</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">btn</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">dragTranslation</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">dragTranslation</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TranslateTransform</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="n">btn</span><span class="p">.</span><span class="n">RenderTransform</span> <span class="p">=</span> <span class="n">dragTranslation</span><span class="p">;</span>

            <span class="n">dragTranslation</span><span class="p">.</span><span class="n">X</span> <span class="p">+=</span> <span class="n">e</span><span class="p">.</span><span class="n">Delta</span><span class="p">.</span><span class="n">Translation</span><span class="p">.</span><span class="n">X</span><span class="p">;</span>
            <span class="n">dragTranslation</span><span class="p">.</span><span class="n">Y</span> <span class="p">+=</span> <span class="n">e</span><span class="p">.</span><span class="n">Delta</span><span class="p">.</span><span class="n">Translation</span><span class="p">.</span><span class="n">Y</span><span class="p">;</span>
        <span class="p">}</span>

</code></pre></div></div>

<p>åšå¥½ä¹‹åï¼Œæˆ‘ä»¬å‘ç°å®åœ¨å¥‡æ€ª</p>

<p><img src="http://image.acmx.xyz/%E6%8B%96%E5%8A%A8%E6%8E%A7%E4%BB%B62016%E5%B9%B412%E6%9C%8818%E6%97%A5151534.gif" alt="" /></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">å¤§ç¥ï¼Œè¯·ç”¨åŠ›åˆ’ã€‚</span>

<span class="err">å¤§ç¥ï¼šæˆ‘çš„æ§ä»¶å“ªå»ï¼Ÿ</span>

<span class="err">æ§ä»¶ï¼šè°å«ä½ é‚£ä¹ˆç”¨åŠ›</span>

<span class="n">Canvas</span><span class="err">ï¼šæˆ‘çš„å·¦è¾¹å¯ä»¥é•¿åº¦æ— é™ã€‚</span>

<span class="err">â€¦â€¦</span>

</code></pre></div></div>

<p>å¥½åœ¨<a href="https://leoldev.wordpress.com/2016/12/18/uwp-manipulationdeltaï¼Ÿè›¤ï¼Ÿ/">OneWindows</a>çš„å¸®åŠ©</p>

<p>å‚è§ï¼šhttp://www.cnblogs.com/cjw1115/p/5323339.html</p>

:ET