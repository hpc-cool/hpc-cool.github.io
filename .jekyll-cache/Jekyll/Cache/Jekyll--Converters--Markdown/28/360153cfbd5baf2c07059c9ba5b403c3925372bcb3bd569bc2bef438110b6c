I"Z<p>å°ä¼™ä¼´éƒ½ç”¨è¿‡ VisualStudio éƒ½åœ¨è¾“å‡ºçª—å£çœ‹åˆ°ä¸åŒçš„å­çª—å£ï¼Œå¦‚ gitlab çš„è¾“å‡ºçª—å£ï¼Œè°ƒè¯•çš„è¾“å‡ºçª—å£ï¼Œæœ¬æ–‡å‘Šè¯‰å¤§å®¶å¦‚ä½•å†™æ’ä»¶åœ¨è¾“å‡ºçª—å£é‡Œé¢æ·»åŠ ä¸€ä¸ªçª—å£</p>

<!--more-->

<!-- CreateTime:2019/2/3 11:41:40 -->

<!-- csdn -->
<!-- æ ‡ç­¾ï¼š VisualStudio -->

<p>åœ¨<a href="https://lindexi.oschina.io/lindexi/post/VisualStudio-%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91-%E6%B7%BB%E5%8A%A0%E8%8F%9C%E5%8D%95.html">æ·»åŠ èœå•</a> å‘Šè¯‰å¤§å®¶å¦‚ä½•ç®€å•åœ¨ VisualStudio çš„å·¥å…·æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œé€šè¿‡ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ‰èƒ½ä½¿ç”¨æ’ä»¶</p>

<p>äºæ˜¯è¯·å…ˆçœ‹ä¸€ä¸‹å¦‚ä½•æ·»åŠ æŒ‰é’®çš„åšå®¢ï¼Œè¿™æ ·æœ¬æ–‡å°±å¯ä»¥ç›´æ¥å¼€å§‹å‘Šè¯‰å¤§å®¶åœ¨<a href="https://lindexi.oschina.io/lindexi/post/VisualStudio-%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91-%E6%B7%BB%E5%8A%A0%E8%8F%9C%E5%8D%95.html">è¿™ç¯‡åšå®¢</a> ç”¨åˆ°æ–¹æ³•é‡Œé¢å¿«é€Ÿæ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„è¾“å‡ºçª—å£</p>

<p>åœ¨è¾“å‡ºçª—å£é‡Œé¢çš„çª—å£åœ¨ VisualStudio å®˜æ–¹çš„å‘½åæ˜¯ Pane ä¹Ÿå°±æ˜¯æœ¬æ–‡æ˜¯å‘Šè¯‰å¤§å®¶å¦‚ä½•åœ¨ VisualStudio çš„ OutputWindow æ·»åŠ ä¸€ä¸ª Pane åœ¨è¿™ä¸ª Pane é‡Œé¢è¾“å‡º</p>

<p>åœ¨ VisualStudio çš„ OutputWindow åŒ…å«äº†ä¸€ç»„å¯è¯»å¯å†™çš„æ–‡æœ¬ é»˜è®¤çš„ VisualStudio ä¼šå¸¦å¾ˆå¤šçš„ Pane å¦‚ Build è¿™æ˜¯ä¸€ä¸ªé¡¹ç›®å…³äºç¼–è¯‘çš„è¾“å‡ºï¼Œè¿˜æœ‰ General è¿™æ˜¯ VisualStudio è¿™ä¸ªå·¥å…·çš„ä¸€äº›ä¿¡æ¯ã€‚é€šè¿‡ <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsbuildableprojectcfg?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsBuildableProjectCfg</a> æ¥å£å¯ä»¥è‡ªåŠ¨ç»‘å®šè¾“å‡ºåˆ° Build å¦‚è°ƒç”¨ç¼–è¯‘ã€‚é€šè¿‡ <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.svsgeneraloutputwindowpane?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">SVsGeneralOutputWindowPane</a> æœåŠ¡å¯ä»¥ç›´æ¥è®¿é—® General è·å–é‡Œé¢çš„è¾“å‡ºã€‚</p>

<p>å¼€å‘è€…å¯ä»¥é€šè¿‡ VisualStudio SDK åˆ›å»ºç®¡ç†è‡ªå·±çš„è‡ªå®šä¹‰çª—å£ã€‚</p>

<p>é€šè¿‡ <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsoutputwindow?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsOutputWindow</a> å’Œ <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsoutputwindowpane?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsOutputWindowPane</a> æ¥å£å¯ä»¥æ§åˆ¶è¾“å‡ºçª—å£ã€‚é€šè¿‡ <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.svsoutputwindow?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">SVsOutputWindow</a> æœåŠ¡å¯ä»¥æ‹¿åˆ° <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsoutputwindow?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsOutputWindow</a> æ¥å£ã€‚é€šè¿‡ <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsoutputwindow?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsOutputWindow</a> å¯ä»¥è·å–åˆ° <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsoutputwindowpane?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsOutputWindowPane</a> æˆ–è€…åˆ›å»ºå…³é—­</p>

<p>é€šè¿‡ <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsoutputwindowpane?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsOutputWindowPane</a> çš„æ–¹æ³•å¯ä»¥æ¿€æ´» Pane æˆ–éšè— Pane æ»šåŠ¨é‡Œé¢çš„æ–‡æœ¬æˆ–æ¸…ç©ºè¾“å‡º</p>

<p>åœ¨å¼€å‘ VisualStudio æ’ä»¶çš„æ—¶å€™ï¼Œå› ä¸ºæ–‡æ¡£ä¸å¤šï¼ŒåŒæ—¶å¼€å‘çš„æ—¶å€™ä¼šå‘ç°æœ‰ä¸€äº›æ–‡æ¡£æ²¡æœ‰æ›´æ–°ï¼Œæ‰€ä»¥éš¾åº¦ä¼šæ¯”è¾ƒå¤§</p>

<h2 id="åˆ›å»ºè‡ªå®šä¹‰çš„è¾“å‡ºçª—å£">åˆ›å»ºè‡ªå®šä¹‰çš„è¾“å‡ºçª—å£</h2>

<p>åœ¨ Execute æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ NowkuPurqicowFourocafem çš„ Execute æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨<a href="https://lindexi.oschina.io/lindexi/post/VisualStudio-%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91-%E6%B7%BB%E5%8A%A0%E8%8F%9C%E5%8D%95.html">è¿™ç¯‡åšå®¢</a> å·²ç»æœ‰å‘Šè¯‰å¤§å®¶ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æˆ·ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™å°±ä¼šä½¿ç”¨å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ä¸€ä¸ª Pane è¯·çœ‹ä»£ç </p>

<!-- ![](image/VisualStudio æ‰©å±•å¼€å‘ æ·»åŠ è¾“å‡ºçª—å£/VisualStudio æ‰©å±•å¼€å‘ æ·»åŠ è¾“å‡ºçª—å£0.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20192395555251" alt="" /></p>

<p>ä¹Ÿå°±æ˜¯è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯è‡ªå·±å†™çš„</p>

<p>é€šè¿‡ <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.svsoutputwindow?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">SVsOutputWindow</a> æ‹¿åˆ° <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsoutputwindow?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsOutputWindow</a> æ¥å£</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">IVsOutputWindow</span> <span class="n">output</span> <span class="p">=</span>   
                <span class="p">(</span><span class="n">IVsOutputWindow</span><span class="p">)</span> <span class="n">Package</span><span class="p">.</span><span class="nf">GetGlobalService</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">SVsOutputWindow</span><span class="p">));</span>  
</code></pre></div></div>

<p>è¿™é‡Œçš„ Package æ˜¯ Microsoft.VisualStudio.Shell æ˜¯ä¸€ä¸ªé™æ€ç±»é‡Œé¢çš„æ–¹æ³•ï¼Œé™¤äº†ä½¿ç”¨é™æ€ç±»è·å–ï¼Œè¿˜å¯ä»¥é€šè¿‡ NowkuPurqicowFourocafem ç±»é‡Œé¢çš„ package è·å–ï¼Œä½†æ˜¯é‡Œé¢çš„è·å–æ–¹æ³•æ˜¯å¼‚æ­¥çš„</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// VS Package that provides this command, not null.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">AsyncPackage</span> <span class="n">package</span><span class="p">;</span>
</code></pre></div></div>

<p>è¿™ä¸ªå­—æ®µæ˜¯åœ¨ InitializeAsync é™æ€æ–¹æ³•æ³¨å…¥çš„</p>

<p>æ‹¿åˆ°äº† <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsoutputwindow?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsOutputWindow</a> å°±å¯ä»¥æ·»åŠ è¾“å‡ºçª—å£</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">void</span> <span class="nf">CreatePane</span><span class="p">(</span><span class="n">Guid</span> <span class="n">paneGuid</span><span class="p">,</span> <span class="kt">string</span> <span class="n">title</span><span class="p">,</span>   
            <span class="kt">bool</span> <span class="n">visible</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">clearWithSolution</span><span class="p">)</span>  
        <span class="p">{</span>  
            <span class="n">ThreadHelper</span><span class="p">.</span><span class="nf">ThrowIfNotOnUIThread</span><span class="p">();</span>
            
            <span class="n">IVsOutputWindow</span> <span class="n">output</span> <span class="p">=</span>   
                <span class="p">(</span><span class="n">IVsOutputWindow</span><span class="p">)</span><span class="n">Package</span><span class="p">.</span><span class="nf">GetGlobalService</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">SVsOutputWindow</span><span class="p">));</span>

            <span class="c1">// Create a new pane.  </span>
            <span class="n">output</span><span class="p">.</span><span class="nf">CreatePane</span><span class="p">(</span>  
                <span class="k">ref</span> <span class="n">paneGuid</span><span class="p">,</span>   
                <span class="n">title</span><span class="p">,</span>   
                <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">visible</span><span class="p">),</span>   
                <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt32</span><span class="p">(</span><span class="n">clearWithSolution</span><span class="p">));</span>  
        <span class="p">}</span>
</code></pre></div></div>

<p>è¿™é‡Œä¼ å…¥çš„ paneGuid æ˜¯è‡ªå·±å®šä¹‰çš„ï¼Œé€šè¿‡è¿™ä¸ª paneGuid å°±å¯ä»¥è·å–è¾“å‡ºçª—å£</p>

<p>ä¸Šé¢çš„ä»£ç åªæ˜¯åˆ›å»ºï¼Œå¦‚æœæƒ³è¦æ‹¿åˆ° Pane è¿˜éœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="c1">// Retrieve the new pane.  </span>
            <span class="n">output</span><span class="p">.</span><span class="nf">GetPane</span><span class="p">(</span><span class="k">ref</span> <span class="n">paneGuid</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">pane</span><span class="p">);</span>
</code></pre></div></div>

<p>è¿™æ ·å°±å¯ä»¥æ‹¿åˆ° <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsoutputwindowpane?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsOutputWindowPane</a> æ¥å£</p>

<p>æ‹¿åˆ°äº† <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.ivsoutputwindowpane?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">IVsOutputWindowPane</a> å°±å¯ä»¥è¾“å‡ºè¯·çœ‹ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="n">pane</span><span class="p">.</span><span class="nf">OutputString</span><span class="p">(</span><span class="s">"æ¬¢è¿è®¿é—®æˆ‘åšå®¢ http://lindexi.gitee.io é‡Œé¢æœ‰å¤§é‡ UWP WPF åšå®¢ \n"</span><span class="p">);</span> 
</code></pre></div></div>

<!-- ![](image/VisualStudio æ‰©å±•å¼€å‘ æ·»åŠ è¾“å‡ºçª—å£/VisualStudio æ‰©å±•å¼€å‘ æ·»åŠ è¾“å‡ºçª—å£1.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F201923102029610" alt="" /></p>

<p>é™¤äº†é€šè¿‡ <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.shell.interop.svsoutputwindow?redirectedfrom=MSDN&amp;view=visualstudiosdk-2017">SVsOutputWindow</a> åˆ›å»ºè¾“å‡ºçª—å£ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ OutputWindow åˆ›å»ºè¾“å‡ºçª—å£</p>

<p>æ·»åŠ  CreatePane é‡è½½</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">CreatePane</span><span class="p">(</span><span class="kt">string</span> <span class="n">title</span><span class="p">)</span> 
<span class="p">{</span>

<span class="p">}</span>
</code></pre></div></div>

<p>ç°åœ¨é€šè¿‡ package æ‹¿åˆ° DTE é€šè¿‡ DTE å¯ä»¥æ‹¿åˆ°è¾“å‡ºçª—å£</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">CreatePane</span><span class="p">(</span><span class="kt">string</span> <span class="n">title</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">await</span> <span class="n">ThreadHelper</span><span class="p">.</span><span class="n">JoinableTaskFactory</span><span class="p">.</span><span class="nf">SwitchToMainThreadAsync</span><span class="p">();</span>
            <span class="n">DTE2</span> <span class="n">dte</span> <span class="p">=</span> <span class="p">(</span><span class="n">DTE2</span><span class="p">)</span> <span class="k">await</span> <span class="n">package</span><span class="p">.</span><span class="nf">GetServiceAsync</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">DTE</span><span class="p">))</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>é€šè¿‡ package éœ€è¦ä½¿ç”¨å¼‚æ­¥çš„æ–¹æ³•æ‹¿åˆ°æœåŠ¡</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="n">OutputWindowPanes</span> <span class="n">panes</span> <span class="p">=</span>
                <span class="n">dte</span><span class="p">.</span><span class="n">ToolWindows</span><span class="p">.</span><span class="n">OutputWindow</span><span class="p">.</span><span class="n">OutputWindowPanes</span><span class="p">;</span>
</code></pre></div></div>

<p>ä½†æ˜¯ OutputWindowPanes ä¸æ˜¯åˆ—è¡¨ï¼Œéœ€è¦é€šè¿‡ä¸‹é¢çš„ä»£ç å»æ‹¿åˆ° Pane æˆ–åˆ›å»º</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="k">try</span>
            <span class="p">{</span>
                <span class="c1">// If the pane exists already, write to it.  </span>
                <span class="n">OutputWindowPane</span> <span class="n">pane</span> <span class="p">=</span> <span class="n">panes</span><span class="p">.</span><span class="nf">Item</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">ArgumentException</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// Create a new pane and write to it.  </span>
                <span class="kt">var</span> <span class="n">pane</span> <span class="p">=</span> <span class="n">panes</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
            <span class="p">}</span>
</code></pre></div></div>

<p>è™½ç„¶é€šè¿‡å¼‚å¸¸åˆ¤æ–­æ˜¯å¦å·²ç»å­˜åœ¨ Pane ä¸å­˜åœ¨å°±åˆ›å»ºçš„ä»£ç æ¯”è¾ƒå·®ï¼Œä½†æ˜¯å¯ä»¥ç®€å•å‘Šè¯‰å¤§å®¶å¦‚ä½•é€šè¿‡ OutputWindowPanes åˆ›å»º</p>

<p>è¿™é‡Œæ‹¿åˆ°çš„ Pane æ˜¯ OutputWindowPane å’Œä¸Šé¢ IVsOutputWindowPane æ˜¯æœ‰ç‚¹ä¸ä¸€æ ·çš„ï¼Œé€šè¿‡ OutputWindowPane å¯ä»¥æ‹¿åˆ°è¾“å‡º</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       <span class="k">private</span> <span class="k">void</span> <span class="nf">GetText</span><span class="p">(</span><span class="n">OutputWindowPane</span> <span class="n">pane</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ThreadHelper</span><span class="p">.</span><span class="nf">ThrowIfNotOnUIThread</span><span class="p">();</span>
            <span class="n">TextDocument</span> <span class="n">document</span> <span class="p">=</span> <span class="n">pane</span><span class="p">.</span><span class="n">TextDocument</span><span class="p">;</span>
            <span class="n">EditPoint</span> <span class="n">point</span> <span class="p">=</span> <span class="n">document</span><span class="p">.</span><span class="n">StartPoint</span><span class="p">.</span><span class="nf">CreateEditPoint</span><span class="p">();</span>

            <span class="c1">// ä¸‹é¢ str å°±æ˜¯è¾“å‡º</span>
            <span class="kt">var</span> <span class="n">str</span> <span class="p">=</span> <span class="n">point</span><span class="p">.</span><span class="nf">GetText</span><span class="p">(</span><span class="n">document</span><span class="p">.</span><span class="n">EndPoint</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>è¿™é‡Œè·å–è¾“å‡ºè¯·çœ‹ <a href="https://lindexi.oschina.io/lindexi/post/VisualStudio-%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91-%E8%8E%B7%E5%BE%97%E8%BE%93%E5%87%BA%E7%AA%97%E5%8F%A3%E5%86%85%E5%AE%B9.html">VisualStudio æ‰©å±•å¼€å‘ è·å¾—è¾“å‡ºçª—å£å†…å®¹</a></p>

<p>è¿™ä¸ª CreatePane æ–¹æ³•å…¨éƒ¨ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       <span class="k">private</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">CreatePane</span><span class="p">(</span><span class="kt">string</span> <span class="n">title</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">await</span> <span class="n">ThreadHelper</span><span class="p">.</span><span class="n">JoinableTaskFactory</span><span class="p">.</span><span class="nf">SwitchToMainThreadAsync</span><span class="p">();</span>
            <span class="n">DTE2</span> <span class="n">dte</span> <span class="p">=</span> <span class="p">(</span><span class="n">DTE2</span><span class="p">)</span> <span class="k">await</span> <span class="n">package</span><span class="p">.</span><span class="nf">GetServiceAsync</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">DTE</span><span class="p">));</span>
            <span class="n">OutputWindowPanes</span> <span class="n">panes</span> <span class="p">=</span>
                <span class="n">dte</span><span class="p">.</span><span class="n">ToolWindows</span><span class="p">.</span><span class="n">OutputWindow</span><span class="p">.</span><span class="n">OutputWindowPanes</span><span class="p">;</span>

            <span class="k">try</span>
            <span class="p">{</span>
                <span class="c1">// If the pane exists already, write to it.  </span>
                <span class="n">OutputWindowPane</span> <span class="n">pane</span> <span class="p">=</span> <span class="n">panes</span><span class="p">.</span><span class="nf">Item</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">ArgumentException</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// Create a new pane and write to it.  </span>
                <span class="kt">var</span> <span class="n">pane</span> <span class="p">=</span> <span class="n">panes</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
                <span class="n">pane</span><span class="p">.</span><span class="nf">OutputString</span><span class="p">(</span><span class="s">"æ¬¢è¿è®¿é—®æˆ‘åšå®¢ http://lindexi.gitee.io é‡Œé¢æœ‰å¤§é‡ UWP WPF åšå®¢ \n"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>åœ¨ Execute æ–¹æ³•ä½¿ç”¨ä¸‹é¢ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="nf">CreatePane</span><span class="p">(</span><span class="s">"æ—å¾·ç†™æ˜¯é€—æ¯”"</span><span class="p">);</span>
</code></pre></div></div>

<p>è¿è¡Œå¯ä»¥çœ‹åˆ°ä¸‹é¢ä»£ç </p>

<!-- ![](image/VisualStudio æ‰©å±•å¼€å‘ æ·»åŠ è¾“å‡ºçª—å£/VisualStudio æ‰©å±•å¼€å‘ æ·»åŠ è¾“å‡ºçª—å£2.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F201923103441364" alt="" /></p>

<p>ä½†æ˜¯é€šè¿‡ OutputWindow çš„æ–¹æ³•è·å–ä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºæœ‰å¤šè¯­è¨€ï¼Œå¯èƒ½åœ¨æ—¥æœ¬ä½¿ç”¨çš„è°ƒè¯•çª—å£å†™çš„æ˜¯ãƒ‡ãƒãƒƒã‚°å¯èƒ½å†™çš„æ’ä»¶åªèƒ½åœ¨è‡ªå·±çš„è¯­è¨€ä½¿ç”¨ï¼Œæ‰€ä»¥è¿˜æ˜¯å»ºè®®ä½¿ç”¨ GUID çš„æ–¹æ³•åˆ›å»º</p>

<h2 id="è·å–-general-çª—å£">è·å– General çª—å£</h2>

<p>åœ¨ VisualStudio æœ‰ä¸¤ä¸ªè¾“å‡ºçª—å£æ˜¯é»˜è®¤çš„ï¼Œå°±æ˜¯ General å’Œ Build è¾“å‡ºçª—å£</p>

<p>é€šè¿‡æœåŠ¡çš„æ–¹å¼å¯ä»¥æ‹¿åˆ° General çª—å£</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetGeneralPane</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">await</span> <span class="n">ThreadHelper</span><span class="p">.</span><span class="n">JoinableTaskFactory</span><span class="p">.</span><span class="nf">SwitchToMainThreadAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">pane</span> <span class="p">=</span> <span class="p">(</span><span class="n">IVsOutputWindowPane</span><span class="p">)</span> <span class="k">await</span> <span class="n">package</span><span class="p">.</span><span class="nf">GetServiceAsync</span><span class="p">(</span>
                <span class="k">typeof</span><span class="p">(</span><span class="n">SVsGeneralOutputWindowPane</span><span class="p">));</span>
        <span class="p">}</span> 
</code></pre></div></div>

<h2 id="è·å–-build-çª—å£">è·å– Build çª—å£</h2>

<p>é€šè¿‡ä¸‹é¢å¯ä»¥è·å– Build çª—å£</p>

<p>åœ¨ <a href="https://docs.microsoft.com/en-us/visualstudio/extensibility/ide-guids?view=vs-2017">IDE GUIDs</a> æ‰¾åˆ° Build çª—å£çš„ id ç„¶åé€šè¿‡ id æ‰¾åˆ°çª—å£</p>

<p>ç°åœ¨å°±ä¸ä½¿ç”¨ä¸Šé¢çš„é€šè¿‡ Name çš„æ–¹æ³•æ‰¾åˆ°çª—å£</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           <span class="k">await</span> <span class="n">ThreadHelper</span><span class="p">.</span><span class="n">JoinableTaskFactory</span><span class="p">.</span><span class="nf">SwitchToMainThreadAsync</span><span class="p">();</span>
            <span class="n">DTE2</span> <span class="n">dte</span> <span class="p">=</span> <span class="p">(</span><span class="n">DTE2</span><span class="p">)</span> <span class="k">await</span> <span class="n">package</span><span class="p">.</span><span class="nf">GetServiceAsync</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">DTE</span><span class="p">));</span>
            <span class="n">OutputWindowPanes</span> <span class="n">panes</span> <span class="p">=</span>
                <span class="n">dte</span><span class="p">.</span><span class="n">ToolWindows</span><span class="p">.</span><span class="n">OutputWindow</span><span class="p">.</span><span class="n">OutputWindowPanes</span><span class="p">;</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="n">EnvDTE</span><span class="p">.</span><span class="n">OutputWindowPane</span> <span class="n">pane</span> <span class="k">in</span> <span class="n">panes</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pane</span><span class="p">.</span><span class="n">Guid</span> <span class="p">==</span> <span class="s">"{"</span> <span class="p">+</span>
                    <span class="s">"1BD8A850-02D1-11D1-BEE7-00A0C913D1F8}"</span><span class="p">)</span>               
                <span class="p">{</span>
                <span class="p">}</span>
            <span class="p">}</span>
</code></pre></div></div>

<p>è¿™æ ·å°±å¯ä»¥æ‹¿åˆ° Build çª—å£ï¼Œå°è¯•åœ¨è¿™ä¸ªçª—å£è¾“å‡º ç¼–è¯‘å¤±è´¥ è®©ä½ çš„å°ä¼™ä¼´å®‰è£…äº†æ’ä»¶å°±æ— æ³•ç¼–è¯‘æˆåŠŸï¼Œè™½ç„¶å®é™…å°ä¼™ä¼´è¿˜æ˜¯å¯ä»¥è¿è¡Œä»£ç </p>

<p>å¾®è½¯å®˜æ–¹çš„æ–‡æ¡£æœ‰å¾ˆå¤šé”™è¯¯ï¼Œçœ‹è¿™ç¯‡<a href="https://docs.microsoft.com/en-us/visualstudio/extensibility/extending-the-output-window?view=vs-2017">Extending the Output Window </a>æ–‡æ¡£ä¸å¦‚çœ‹æœ¬æ–‡</p>

<p><a href="https://docs.microsoft.com/en-us/visualstudio/extensibility/extending-the-output-window?view=vs-2017">Extending the Output Window </a></p>

:ET