I"õ<p>æœ¬æ–‡å‘Šè¯‰å¤§å®¶å¦‚æœå¤åˆ¶ç½‘ä¸Šä¸€æ®µä»£ç å‘ç° System.ServiceProcess æç¤ºæ‰¾ä¸åˆ°æ–¹æ³•æˆ–å®šä¹‰ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ å¼•ç”¨</p>

<!--more-->

<!-- CreateTime:2019/10/18 21:24:04 -->

<p>ä¾‹å¦‚ä¸‹é¢ä¸€æ®µä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.ServiceProcess</span><span class="p">;</span>

        <span class="k">private</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">IsWindowsManagementInstrumentationAvailable</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">try</span>
                <span class="p">{</span>
                    <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">serviceController</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ServiceController</span><span class="p">(</span><span class="s">"Winmgmt"</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="k">return</span> <span class="n">serviceController</span><span class="p">.</span><span class="n">Status</span> <span class="p">==</span> <span class="n">ServiceControllerStatus</span><span class="p">.</span><span class="n">Running</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>åœ¨ç¼–è¯‘çš„æ—¶å€™æç¤º</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The type or namespace name 'ServiceProcess' does not exist in the namespace 'System' (are you missing an assembly reference?)


é”™è¯¯	CS0246	æœªèƒ½æ‰¾åˆ°ç±»å‹æˆ–å‘½åç©ºé—´åâ€œServiceControllerâ€(æ˜¯å¦ç¼ºå°‘ using æŒ‡ä»¤æˆ–ç¨‹åºé›†å¼•ç”¨?)
</code></pre></div></div>

<p>ä¿®å¤æ–¹æ³•æ˜¯å³å‡»ä¾èµ–é¡¹ï¼Œç‚¹å‡»æ·»åŠ å¼•ç”¨ï¼Œåœ¨ç¨‹åºé›†æ‰¾åˆ° System.ServiceProcess ç‚¹å‡»å¼•ç”¨å°±å¯ä»¥</p>

<p>å¦‚æœæ˜¯ SDK çš„ csproj å¯ä»¥ç›´æ¥åœ¨é¡¹ç›®æ–‡ä»¶æ·»åŠ ä¸‹é¢ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">&lt;</span><span class="n">ItemGroup</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="n">Reference</span> <span class="n">Include</span><span class="p">=</span><span class="s">"System.ServiceProcess"</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="n">ItemGroup</span><span class="p">&gt;</span>
</code></pre></div></div>

:ET