I"÷<p>åœ¨ ScrollViewer å¦‚æœéœ€è¦æ”¶åˆ°è§¦æ‘¸æ¶ˆæ¯ï¼Œé€šè¿‡ Manipulation è§¦æ‘¸æ»šåŠ¨ï¼Œä¸èƒ½åªæ˜¯é€šè¿‡è®¾ç½® IsManipulationEnabled æ–¹æ³•ï¼Œè¿˜éœ€è¦è®¾ç½® PanningMode æ‰å¯ä»¥</p>

<!--more-->

<!-- CreateTime:2019/11/29 10:21:47 -->

<!-- csdn -->

<p>é‚£ä¹ˆå¦‚ä½•çŸ¥é“æ»šåŠ¨æ¡çš„è§¦æ‘¸äº‹ä»¶æ˜¯å¦è§¦å‘ï¼Œå¯ä»¥å†™ä¸€ä¸ªç±»ç»§æ‰¿æ»šåŠ¨æ¡</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">public</span> <span class="k">class</span> <span class="nc">StisvearpaHudalserevow</span> <span class="p">:</span> <span class="n">ScrollViewer</span>
    <span class="p">{</span>
        <span class="c1">/// &lt;inheritdoc /&gt;</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnManipulationDelta</span><span class="p">(</span><span class="n">ManipulationDeltaEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"OnManipulationDelta"</span><span class="p">);</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">OnManipulationDelta</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;inheritdoc /&gt;</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnManipulationCompleted</span><span class="p">(</span><span class="n">ManipulationCompletedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"OnManipulationCompleted"</span><span class="p">);</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">OnManipulationCompleted</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;inheritdoc /&gt;</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnManipulationStarted</span><span class="p">(</span><span class="n">ManipulationStartedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"OnManipulationStarted"</span><span class="p">);</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">OnManipulationStarted</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</code></pre></div></div>

<p>åœ¨ç•Œé¢æ·»åŠ è¿™ä¸ªç±»ï¼Œå¦‚æœæœ‰è§¦æ‘¸è¾“å…¥å°±å¯ä»¥é€šè¿‡è¾“å‡ºçœ‹åˆ°äº†ï¼Œç®€å•ä¸€ä¸ªç•Œé¢ï¼Œå¯ä»¥çœ‹åˆ°é»˜è®¤çš„æ»šåŠ¨æ¡æ˜¯ä¸èƒ½æ»šåŠ¨çš„</p>

<!-- ![](image/WPF å¼€å¯ ScrollViewer çš„è§¦æ‘¸æ»šåŠ¨/WPF å¼€å¯ ScrollViewer çš„è§¦æ‘¸æ»šåŠ¨0.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F2018122612330218" alt="" /></p>

<p>åŒæ—¶è§¦æ‘¸çš„æ—¶å€™æ²¡æœ‰è¾“å‡º</p>

<p>å°è¯•æ·»åŠ  IsManipulationEnabled æ–¹æ³•</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="n">local</span><span class="p">:</span><span class="n">StisvearpaHudalserevow</span> <span class="n">IsManipulationEnabled</span><span class="p">=</span><span class="s">"True"</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>å¯ä»¥çœ‹åˆ°æœ‰è¾“å‡ºä½†æ˜¯å°±æ˜¯ä¸èƒ½æ»šåŠ¨</p>

<p>åœ¨æˆ‘åšå®¢ <a href="https://blog.lindexi.com/post/WPF-%E6%8B%96%E5%8A%A8%E6%BB%9A%E5%8A%A8.html">WPF æ‹–åŠ¨æ»šåŠ¨</a> å‘Šè¯‰å¤§å®¶é€šè¿‡ PanningMode çš„æ–¹æ³•å¯ä»¥è®©æ»šåŠ¨æ¡æ»šåŠ¨</p>

<p>åªè¦åœ¨åˆå§‹çš„è¿‡ç¨‹è®¾ç½®äº† PanningMode å› ä¸ºåœ¨ä»£ç é‡Œé¢é€šè¿‡ InvalidateProperty é‡æ–°è®¾ç½® IsManipulationEnabled çš„å€¼ï¼Œæ‰€ä»¥åªéœ€è¦è®¾ç½® PanningMode å°±å¯ä»¥</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">///     Method which sets IsManipulationEnabled</span>
        <span class="c1">///     property based on the PanningMode</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">void</span> <span class="nf">OnPanningModeChanged</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">PanningMode</span> <span class="n">mode</span> <span class="p">=</span> <span class="n">PanningMode</span><span class="p">;</span>
 
            <span class="c1">// Call InvalidateProperty for IsManipulationEnabledProperty</span>
            <span class="c1">// to reset previous SetCurrentValueInternal if any. </span>
            <span class="c1">// Then call SetCurrentValueInternal to</span>
            <span class="c1">// set the value of these properties if needed.</span>
            <span class="nf">InvalidateProperty</span><span class="p">(</span><span class="n">IsManipulationEnabledProperty</span><span class="p">);</span>
 
            <span class="k">if</span> <span class="p">(</span><span class="n">mode</span> <span class="p">!=</span> <span class="n">PanningMode</span><span class="p">.</span><span class="n">None</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nf">SetCurrentValueInternal</span><span class="p">(</span><span class="n">IsManipulationEnabledProperty</span><span class="p">,</span> <span class="n">BooleanBoxes</span><span class="p">.</span><span class="n">TrueBox</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>ä½†æ˜¯å¦‚æœåœ¨è§¦æ‘¸çš„è¿‡ç¨‹ï¼Œå‡ºç°äº†è®¾ç½® IsManipulationEnabled ä¸º false å°±ä¼šè§¦å‘ OnManipulationCompleted äº‹ä»¶</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnManipulationStarted</span><span class="p">(</span><span class="n">ManipulationStartedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"OnManipulationStarted"</span><span class="p">);</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">OnManipulationStarted</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>

            <span class="n">Task</span><span class="p">.</span><span class="nf">Delay</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">3</span><span class="p">)).</span><span class="nf">ContinueWith</span><span class="p">(</span><span class="n">_</span> <span class="p">=&gt;</span> <span class="n">IsManipulationEnabled</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span>
                <span class="n">TaskScheduler</span><span class="p">.</span><span class="nf">FromCurrentSynchronizationContext</span><span class="p">());</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>è¿˜å¯ä»¥é€šè¿‡è®¾ç½® <code class="language-plaintext highlighter-rouge">IsHitTestVisible = false</code> è§¦å‘ OnManipulationCompleted åŒæ—¶è§¦å‘ä¹‹åä¹Ÿæ²¡æœ‰è§¦æ‘¸</p>

:ET