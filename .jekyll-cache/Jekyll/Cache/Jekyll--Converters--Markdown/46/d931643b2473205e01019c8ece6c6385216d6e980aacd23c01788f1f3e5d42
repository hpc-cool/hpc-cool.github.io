I"œK<p>åœ¨ 2018 å¹´ 10 æœˆ 13 å·å‚åŠ äº† <a href="http://www.csharpkit.com/">å¼ é˜Ÿé•¿</a> çš„ <a href="https://www.cnblogs.com/adalovelacer/archive/2018/09/16/9657143.html">Office 365 è®­ç»ƒè¥</a> å­¦ä¹ å¦‚ä½•å¼€å‘ Office 365 æ’ä»¶å’Œ OAuth 2.0 å¼€å‘ï¼Œäºæ˜¯æˆ‘å°±ä½¿ç”¨ UWP å°è¯•ä½¿ç”¨ Microsoft.Graph ç»è¿‡äº†ä¸€å¤©çš„æµ‹è¯•ç»ˆäºæˆåŠŸä½¿ç”¨å‘é€é‚®ä»¶
æœ¬æ–‡å‘Šè¯‰å¤§å®¶å¦‚ä½•åœ¨ UWP è°ƒç”¨ Microsoft.Graph å‘é€é‚®ä»¶</p>

<!--more-->

<!-- CreateTime:2019/12/24 9:27:54 -->

<p>åœ¨ä»”ç»†é˜…è¯»äº†<a href="https://www.cnblogs.com/chenxizhang/p/7904255.html">Microsoft Graph æ¡Œé¢åº”ç”¨ç¨‹åº - é™ˆå¸Œç« </a>çš„æ–‡ç« ä¹‹åï¼ŒæŒ‰ç…§æ–‡ç« çš„æ–¹æ³•å°è¯•äº†å¾ˆä¹…ç»ˆäºæˆåŠŸå‘é€äº†é‚®ä»¶</p>

<p>å¯ä»¥ä½¿ç”¨ Microsoft.Graph è°ƒç”¨ Office 365 çš„å‡ ä¹æ‰€æœ‰åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘åªæœ‰æˆåŠŸä½¿ç”¨é‚®ä»¶çš„åŠŸèƒ½ï¼Œæš‚æ—¶å°±å…ˆå‘Šè¯‰å¤§å®¶å¦‚ä½•åœ¨ UWP ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶</p>

<p>ä¹‹åçš„å…¶ä»–åŠŸèƒ½ç­‰æˆ‘è·‘é€šäº†ï¼Œå†å‘Šè¯‰å¤§å®¶</p>

<p>å› ä¸º Microsoft.Graph å¼€å‘é€Ÿåº¦æ˜¯å¾ˆå¿«çš„ï¼Œæœ¬æ–‡å®‰è£…çš„ Nuget éƒ½ä¼šå‘Šè¯‰å¤§å®¶æŒ‡å®šçš„ç‰ˆæœ¬ï¼Œé˜²æ­¢å› ä¸ºå¾®è½¯çš„ç‰ˆæœ¬ä¿®æ”¹è€Œè®©å¤§å®¶æ— æ³•æŒ‰ç…§æœ¬æ–‡æä¾›çš„æ–¹å¼</p>

<h2 id="æ³¨å†Œåº”ç”¨">æ³¨å†Œåº”ç”¨</h2>

<p>é¦–å…ˆç™»é™† <a href="https://apps.dev.microsoft.com/">Microsoft Applications</a> å¹³å°ï¼Œåœ¨ç™»é™†ä¹‹åå¯ä»¥çœ‹åˆ°ä¸‹é¢ç•Œé¢</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶0.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015121212521" alt="" /></p>

<p>æœ¬æ–‡ç”¨çš„ä¾‹å­éƒ½æ˜¯ä½¿ç”¨å›½é™…ç‰ˆçš„ Office 365 ç‰ˆæœ¬ï¼Œè€Œä¸ä¼šä½¿ç”¨å›½å†…çš„ç‰ˆæœ¬ï¼Œå› ä¸ºå›½å†…çš„ç‰ˆæœ¬å°‘äº†å¾ˆå¤šåŠŸèƒ½</p>

<p>ç‚¹å‡»æ·»åŠ åº”ç”¨ï¼Œéšæ„ç»™ä¸€ä¸ªåº”ç”¨çš„å‘½åï¼Œæˆ‘è¿™é‡Œç»™äº†ä¸€ä¸ª LasecouDofalerJornowserewel åº”ç”¨</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶1.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015121656595" alt="" /></p>

<p>éœ€è¦è®°ä¸‹ç¨‹åºçš„ ID åœ¨åº”ç”¨ä¼šç”¨åˆ°</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶2.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015121755354" alt="" /></p>

<p>æ·»åŠ æƒé™ï¼Œè¦å‘é€é‚®ä»¶ï¼Œéœ€è¦æ·»åŠ  <code class="language-plaintext highlighter-rouge">"User.Read", "Mail.Read", "Mail.Send","Files.Read"</code> æƒé™</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶3.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F2018101514950830" alt="" /></p>

<p>ç‚¹å‡»æ·»åŠ æƒé™</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶4.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F2018101514114175" alt="" /></p>

<p>ç‚¹å‡»æ·»åŠ åº”ç”¨ç¨‹åºæƒé™</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶5.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015141238603" alt="" /></p>

<p>å…³äºæƒé™è¿™ä¸€æ­¥ï¼Œè¯·å…ˆç…§ç€ç‚¹ï¼Œè¯¦ç»†è¯·çœ‹<a href="https://chenxizhang.gitbooks.io/office365devguide">Office 365 å¼€å‘å…¥é—¨æŒ‡å—</a></p>

<p>è¿˜æœ‰è¿™ä¸ªæ­¥éª¤æœ€é‡è¦çš„ï¼Œç‚¹å‡»ä¸‹æ–¹çš„ä¿å­˜ï¼Œæœ‰å°ä¼™ä¼´å°±å‘Šè¯‰æˆ‘æŒ‰ç…§æˆ‘çš„æ•™ç¨‹æ— æ³•æˆåŠŸï¼Œè¿‡äº†å¾ˆé•¿çš„æ—¶é—´æ‰å‘ç°æ˜¯æ²¡æœ‰ä¿å­˜</p>

<h2 id="åˆ›å»º-uwp-ç¨‹åº">åˆ›å»º UWP ç¨‹åº</h2>

<p>æ‰“å¼€ VisualStudio åˆ›å»ºä¸€ä¸ª UWP é¡¹ç›®ï¼Œå°½å¯èƒ½é€‰æ‹©æ–°ç‰ˆæœ¬ï¼Œåªæœ‰åœ¨è‡ªå·±è·‘é€šäº†ä¹‹åæ‰ä½¿ç”¨å°çš„ç‰ˆæœ¬ï¼Œé˜²æ­¢å› ä¸ºç‰ˆæœ¬é—®é¢˜åœ¨å°è¯•å¼€å‘çš„æ—¶å€™åšåˆ°æ”¾å¼ƒ</p>

<p>æˆ‘åˆ›å»ºäº†ä¸€ä¸ª BalreMahouVoomawbatu é¡¹ç›®ï¼Œæœ€ä½ç‰ˆæœ¬æ˜¯ 17134 ä¹Ÿå°±æ˜¯ç°åœ¨æœ€æ–°çš„</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶6.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F2018101514206621" alt="" /></p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶7.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015142032258" alt="" /></p>

<h2 id="å®‰è£…-nuget-åŒ…">å®‰è£… nuget åŒ…</h2>

<p>å³å‡»é¡¹ç›®ï¼Œç‚¹å‡»ç®¡ç† Nuget åŒ…</p>

<p>å…ˆç‚¹å‡»å®‰è£… Microsoft.Graph çš„ 1.11 ç‰ˆæœ¬</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶8.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F2018101514228335" alt="" /></p>

<p>ç„¶åå‹¾é€‰åŒ…å«é¢„å‘è¡Œç‰ˆï¼Œæ‰¾åˆ° Microsoft.Identity.Client çš„ 2.2 ç‰ˆæœ¬</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶9.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015142347648" alt="" /></p>

<h2 id="æ·»åŠ è®¿é—®æƒé™">æ·»åŠ è®¿é—®æƒé™</h2>

<p>æ‰“å¼€ UWP çš„ MainPage.xaml.cs æ–‡ä»¶ï¼Œæ·»åŠ  Load äº‹ä»¶</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶10.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015142546269" alt="" /></p>

<p>åœ¨ Load äº‹ä»¶çš„å‡½æ•°æ·»åŠ è‡ªå·±çš„ä»£ç ï¼Œé¦–å…ˆä½¿ç”¨ DelegateAuthenticationProvider æ‹¿åˆ°è®¿é—®çš„æƒé™ï¼Œåœ¨ Microsoft.Graph çš„æ‰€æœ‰è®¿é—®éƒ½éœ€è¦å…ˆè·å¾— OAuth çš„æƒé™</p>

<p>åœ¨æ–‡ä»¶çš„æœ€ä¸Šé¢æ·»åŠ å¼•ç”¨</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">Microsoft.Graph</span><span class="p">;</span>

</code></pre></div></div>

<p>ç„¶ååœ¨ MainPage_Loaded æ·»åŠ ä¸‹é¢ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="kt">var</span> <span class="n">provider</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DelegateAuthenticationProvider</span><span class="p">(</span><span class="n">AuthenticateRequestAsyncDelegate</span><span class="p">);</span>

</code></pre></div></div>

<p>åˆ›å»ºæ–¹æ³• AuthenticateRequestAsyncDelegate è¯·çœ‹ä¸‹é¢</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="n">Task</span> <span class="nf">AuthenticateRequestAsyncDelegate</span><span class="p">(</span><span class="n">HttpRequestMessage</span> <span class="n">request</span><span class="p">)</span>
        <span class="p">{</span>
            
        <span class="p">}</span>
</code></pre></div></div>

<p>ç°åœ¨çš„ä»£ç è¿˜æ˜¯æ— æ³•è¿è¡Œé€šè¿‡çš„ï¼Œéœ€è¦åœ¨ AuthenticateRequestAsyncDelegate æ·»åŠ è®¿é—®çš„ Token æ‹¿åˆ°æƒé™</p>

<p>è¿˜è®°å¾—åˆšæ‰è®°ä¸‹æ¥çš„ç¨‹åº ID ç°åœ¨å°±éœ€è¦ç”¨åˆ°ä»–äº†</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶11.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F2018101514327508" alt="" /></p>

<p>è¯·çœ‹ä¸‹é¢ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="n">Task</span> <span class="nf">AuthenticateRequestAsyncDelegate</span><span class="p">(</span><span class="n">HttpRequestMessage</span> <span class="n">request</span><span class="p">)</span>
        <span class="p">{</span>

            <span class="kt">string</span> <span class="n">clientID</span> <span class="p">=</span> <span class="s">"2f56798a-66f7-4330-9bc4-d3a8a0898642"</span><span class="p">;</span> <span class="c1">//è¿™ä¸ªIDæ˜¯æˆ‘åˆ›å»ºçš„ä¸€ä¸ªä¸´æ—¶Appçš„IDï¼Œè¯·æ›¿æ¢ä¸ºè‡ªå·±çš„</span>
            <span class="kt">string</span><span class="p">[]</span> <span class="n">scopes</span> <span class="p">=</span> <span class="p">{</span><span class="s">"User.Read"</span><span class="p">,</span> <span class="s">"Mail.Read"</span><span class="p">,</span> <span class="s">"Mail.Send"</span><span class="p">,</span> <span class="s">"Files.Read"</span><span class="p">};</span>

        <span class="p">}</span>
</code></pre></div></div>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶12.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015143311916" alt="" /></p>

<p>é€šè¿‡ clientID åˆ›å»º <code class="language-plaintext highlighter-rouge">Microsoft.Identity.Client.PublicClientApplication</code> è¯·çœ‹ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>             <span class="kt">string</span> <span class="n">clientID</span> <span class="p">=</span> <span class="s">"2f56798a-66f7-4330-9bc4-d3a8a0898642"</span><span class="p">;</span> <span class="c1">//è¿™ä¸ªIDæ˜¯æˆ‘åˆ›å»ºçš„ä¸€ä¸ªä¸´æ—¶Appçš„IDï¼Œè¯·æ›¿æ¢ä¸ºè‡ªå·±çš„</span>
            <span class="kt">string</span><span class="p">[]</span> <span class="n">scopes</span> <span class="p">=</span> <span class="p">{</span><span class="s">"User.Read"</span><span class="p">,</span> <span class="s">"Mail.Read"</span><span class="p">,</span> <span class="s">"Mail.Send"</span><span class="p">,</span> <span class="s">"Files.Read"</span><span class="p">};</span>

            <span class="kt">var</span> <span class="n">clientApplication</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PublicClientApplication</span><span class="p">(</span><span class="n">clientID</span><span class="p">);</span>

</code></pre></div></div>

<p>ä½¿ç”¨ clientApplication è·å¾—æƒé™</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="kt">var</span> <span class="n">authenticationResult</span> <span class="p">=</span> <span class="k">await</span> <span class="n">clientApplication</span><span class="p">.</span><span class="nf">AcquireTokenAsync</span><span class="p">(</span><span class="n">scopes</span><span class="p">);</span>

</code></pre></div></div>

<p>è¿è¡Œåˆ°è¿™ä¸€æ­¥å°±ä¼šè¯·æ±‚ç”¨æˆ·çš„æƒé™</p>

<p>ä»è·å–åˆ°çš„æƒé™ç»™ä¼ å…¥çš„å‚æ•°</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Authorization</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AuthenticationHeaderValue</span><span class="p">(</span><span class="s">"Bearer"</span><span class="p">,</span> <span class="n">authenticationResult</span><span class="p">.</span><span class="n">AccessToken</span><span class="p">);</span>

</code></pre></div></div>

<p>è¯¦ç»†å…³äº OAuth è·å–æƒé™çš„è¯·çœ‹å¼ é˜Ÿé•¿çš„åšå®¢ï¼Œè¿™é‡Œçš„åšå®¢å¾ˆå¤šï¼Œè¯·çœ‹æ–‡ç« çš„æœ€å</p>

<p>ç°åœ¨å¯ä»¥çœ‹åˆ°çš„ AuthenticateRequestAsyncDelegate ä»£ç æ˜¯è¿™æ ·</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">AuthenticateRequestAsyncDelegate</span><span class="p">(</span><span class="n">HttpRequestMessage</span> <span class="n">request</span><span class="p">)</span>
        <span class="p">{</span>

            <span class="kt">string</span> <span class="n">clientID</span> <span class="p">=</span> <span class="s">"2f56798a-66f7-4330-9bc4-d3a8a0898642"</span><span class="p">;</span> <span class="c1">//è¿™ä¸ªIDæ˜¯æˆ‘åˆ›å»ºçš„ä¸€ä¸ªä¸´æ—¶Appçš„IDï¼Œè¯·æ›¿æ¢ä¸ºè‡ªå·±çš„</span>
            <span class="kt">string</span><span class="p">[]</span> <span class="n">scopes</span> <span class="p">=</span> <span class="p">{</span> <span class="s">"User.Read"</span><span class="p">,</span> <span class="s">"Mail.Read"</span><span class="p">,</span> <span class="s">"Mail.Send"</span><span class="p">,</span> <span class="s">"Files.Read"</span> <span class="p">};</span>

            <span class="kt">var</span> <span class="n">clientApplication</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PublicClientApplication</span><span class="p">(</span><span class="n">clientID</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">authenticationResult</span> <span class="p">=</span> <span class="k">await</span> <span class="n">clientApplication</span><span class="p">.</span><span class="nf">AcquireTokenAsync</span><span class="p">(</span><span class="n">scopes</span><span class="p">);</span>

            <span class="n">request</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Authorization</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">AuthenticationHeaderValue</span><span class="p">(</span><span class="s">"Bearer"</span><span class="p">,</span> <span class="n">authenticationResult</span><span class="p">.</span><span class="n">AccessToken</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>æ³¨æ„éœ€è¦æ›¿æ¢è¿™é‡Œçš„ clientID ä¸ºä½ è‡ªå·±çš„ clientID å½“ç„¶ä»£ç å¯ä»¥æŒ‰ç…§æˆ‘çš„ä½¿ç”¨ï¼Œå› ä¸ºç”¨æˆ‘çš„ ID ä¹Ÿæ˜¯æ²¡é—®é¢˜</p>

<h2 id="å‘é€é‚®ä»¶">å‘é€é‚®ä»¶</h2>

<p>åœ¨è·å–åˆ°æƒé™ä¹‹åï¼Œå¾ˆå®¹æ˜“å°±å¯ä»¥è°ƒç”¨ Microsoft.Graph å‘é€é‚®ä»¶ï¼Œè¯·çœ‹ä»£ç </p>

<p>åˆ›å»º GraphServiceClient ä¹‹åè°ƒç”¨ SendMail å°±å¯ä»¥ï¼Œé‚®ä»¶é‡Œé¢çš„å†…å®¹è¯·è‡ªå·±ä¿®æ”¹</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="n">Me</span><span class="p">.</span><span class="nf">SendMail</span><span class="p">(</span><span class="k">new</span> <span class="nf">Message</span><span class="p">()</span>
            <span class="p">{</span>
                <span class="n">Subject</span> <span class="p">=</span> <span class="s">"è°ƒç”¨Microsoft Graphå‘å‡ºçš„é‚®ä»¶"</span><span class="p">,</span>
                <span class="n">Body</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ItemBody</span><span class="p">()</span>
                <span class="p">{</span>
                    <span class="n">ContentType</span> <span class="p">=</span> <span class="n">BodyType</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span>
                    <span class="n">Content</span> <span class="p">=</span> <span class="s">"è¿™æ˜¯ä¸€å°è°ƒç”¨äº†Microsoft GraphæœåŠ¡å‘å‡ºçš„é‚®ä»¶ï¼ŒèŒƒä¾‹å‚è€ƒ https://github.com/chenxizhang/office365dev"</span>
                <span class="p">},</span>
                <span class="n">ToRecipients</span> <span class="p">=</span> <span class="k">new</span><span class="p">[]</span>
                <span class="p">{</span>
                    <span class="k">new</span> <span class="nf">Recipient</span><span class="p">()</span>
                    <span class="p">{</span>
                        <span class="n">EmailAddress</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">EmailAddress</span><span class="p">()</span> <span class="p">{</span><span class="n">Address</span> <span class="p">=</span> <span class="s">"lindexi_gd@outlook.com"</span><span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span> <span class="n">SaveToSentItems</span><span class="p">:</span> <span class="k">true</span> <span class="cm">/*ä¿å­˜åˆ°å‘é€é‚®ä»¶å¤¹*/</span><span class="p">).</span><span class="nf">Request</span><span class="p">().</span><span class="nf">PostAsync</span><span class="p">();</span>
</code></pre></div></div>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶13.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F2018101514456116" alt="" /></p>

<p>ç‰¹åˆ«æ˜¯ EmailAddress è¯·ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„é‚®ç®±ï¼Œå› ä¸ºå·²ç»è®¾ç½® SaveToSentItems å³ä½¿å‘é€ç»™æˆ‘ä¹Ÿå¯ä»¥åœ¨è‡ªå·±çš„å·²ç»å‘é€é‚®ä»¶å¤¹æ‰¾åˆ°è¿™ä¸ªé‚®ä»¶</p>

<p>ç°åœ¨å°è¯•è¿è¡Œä¸€ä¸‹è¿™ä¸ª UWP ç¨‹åºï¼Œåœ¨è¿è¡Œä¹‹å‰éœ€è¦å³å‡»éƒ¨ç½²ä¸€ä¸‹</p>

<p>è¿è¡Œä¹‹åéœ€è¦ç­‰å¾…å¾ˆä¹…æ‰å¯ä»¥çœ‹åˆ°è¿™ä¸ªç•Œé¢ï¼Œåœ¨å›½å†…çš„ç½‘ç»œä¸æ˜¯å¾ˆå¥½ï¼Œæ‰€ä»¥å¯èƒ½ä¼šçœ‹åˆ°è¿™ä¸ªç•Œé¢</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶14.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015144838376" alt="" /></p>

<p>å¦‚æœçœ‹åˆ°ä¸‹é¢è¿™ä¸ªç•Œé¢ï¼Œè¯·å¤šæ¬¡é‡è¯•</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶15.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015144929880" alt="" /></p>

<p>æˆ–è€…ç»™ IE å¯ä»¥ç”¨çš„ä»£ç†ï¼Œé»˜è®¤çš„ UWP ç¨‹åºä¼šä½¿ç”¨ IE çš„ä»£ç†</p>

<p>å¦‚æœçœ‹åˆ°è¿™ä¸ªé¡µé¢ï¼Œè¯æ˜å¯ä»¥è®¿é—®</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶16.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015145042878" alt="" /></p>

<p>å› ä¸ºæ‰€æœ‰çš„ä»£ç éƒ½æ²¡æœ‰æ¶‰åŠåˆ°ç•Œé¢ï¼Œç™»é™†ä¹‹åç­‰å¾…ä¸€ä¼šï¼Œå°±å¯ä»¥æ‰“å¼€è‡ªå·±çš„ Outlook é‚®ç®±çœ‹åˆ°åˆšæ‰å‘é€çš„é‚®ä»¶</p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶17.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20181015145249465" alt="" /></p>

<!-- ![](image/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶/win10 uwp ä½¿ç”¨ Microsoft.Graph å‘é€é‚®ä»¶18.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F201810151511767" alt="" /></p>

<p>çœ‹åˆ°è¿™é‡Œå°±å¯ä»¥çŸ¥é“ï¼Œç°åœ¨UWPå‘é€é‚®ä»¶æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼Œæœ¬æ–‡æ˜¯å…¶ä¸­ä¸€ä¸ªï¼Œå…¶ä»–æ–¹æ³•è¯·çœ‹<a href="https://lindexi.gitee.io/post/win10-UWP-%E5%8F%91%E9%82%AE%E4%BB%B6.html">win10 UWP å‘é‚®ä»¶</a></p>

<p>æœ¬æ–‡ä»£ç æ”¾åœ¨ <a href="https://github.com/lindexi/lindexi_gd/blob/22a89c4f916dc891e384324b29138dda3dfdb426/BalreMahouVoomawbatu/">github</a> æ¬¢è¿å°ä¼™ä¼´è®¿é—®</p>

<p>å‚è€ƒ</p>

<p><a href="https://www.cnblogs.com/chenxizhang/p/7904255.html">Microsoft Graph æ¡Œé¢åº”ç”¨ç¨‹åº - é™ˆå¸Œç«  - åšå®¢å›­</a></p>

<p><a href="http://www.csharpkit.com/2018-05-28_99073.html">ASP.NET Core Identity å®æˆ˜ï¼ˆ1ï¼‰â€”â€”Identity åˆæ¬¡ä½“éªŒ - .Net Core å¾®æœåŠ¡ - .Net Core å¼€æºå¾®æœåŠ¡ å¥—ä»¶ å·¥å…·åŒ… CSharpKit</a></p>

<p><a href="http://www.csharpkit.com/2018-05-28_50086.html">ASP.NET Core Identity Hands Onï¼ˆ2ï¼‰â€”â€”æ³¨å†Œã€ç™»å½•ã€Claim - .Net Core å¾®æœåŠ¡ - .Net Core å¼€æºå¾®æœåŠ¡ å¥—ä»¶ å·¥å…·åŒ… CSharpKit</a></p>

<p><a href="http://www.csharpkit.com/2017-09-23_69971.html">OAuth2æˆæƒ - .Net Core å¾®æœåŠ¡ - .Net Core å¼€æºå¾®æœåŠ¡ å¥—ä»¶ å·¥å…·åŒ… CSharpKit</a></p>

<p><a href="http://www.csharpkit.com/2017-09-23_51057.html">æ•™ä½ å®è·µASP.NET Core Authorization - .Net Core å¾®æœåŠ¡ - .Net Core å¼€æºå¾®æœåŠ¡ å¥—ä»¶ å·¥å…·åŒ… CSharpKit</a></p>

<p><a href="http://www.csharpkit.com/2017-09-23_56275.html">ASP.NET Core ä¹‹ Identity å…¥é—¨ï¼ˆä¸€ï¼‰ - .Net Core å¾®æœåŠ¡ - .Net Core å¼€æºå¾®æœåŠ¡ å¥—ä»¶ å·¥å…·åŒ… CSharpKit</a></p>

<p><a href="http://www.csharpkit.com/2017-09-23_51500.html">ASP.NET Core ä¹‹ Identity å…¥é—¨ï¼ˆäºŒï¼‰ - .Net Core å¾®æœåŠ¡ - .Net Core å¼€æºå¾®æœåŠ¡ å¥—ä»¶ å·¥å…·åŒ… CSharpKit</a></p>

:ET