I"í(<p>This article is written in both <a href="#English">English</a> and <a href="#ä¸­æ–‡">Chinese</a>. 
æœ¬æ–‡ä½¿ç”¨<a href="#ä¸­æ–‡">ä¸­æ–‡</a>å’Œ<a href="#English">è‹±æ–‡</a>ä¸¤ä¸ªç‰ˆæœ¬ã€‚
åœ¨ win10 çš„ 17025ï¼ˆç›´åˆ° 17134 ä¹Ÿå°±æ˜¯æ­£å¼ç‰ˆ 1803 ä¹Ÿæ²¡æœ‰ä¿®å¤ï¼‰ å¯ä»¥å®¹æ˜“è®© UWP è§¦æ‘¸å¤±æ•ˆã€‚åšæ³•æ˜¯åˆ›å»ºä¸€ä¸ªçª—å£èƒŒæ™¯æ˜¯é€æ˜çš„ wpf ç¨‹åºï¼ŒæŠŠä»–ç½®é¡¶ï¼Œè¿™æ—¶æ‰€æœ‰ uwp ç¨‹åºå°±æ— æ³•è§¦æ‘¸ã€‚åœ¨æ­£å¼ç‰ˆ 17134 æ˜¯æ‰€æœ‰çš„è§¦æ‘¸ç¨‹åºéƒ½è§¦æ‘¸å¤±æ•ˆï¼Œé™¤äº†å¯ä»¥æŠŠè§¦æ‘¸è½¬é¼ æ ‡çš„ç¨‹åºå¦‚ VisualStudio å’Œ QQ è¿˜èƒ½ä½¿ç”¨ï¼Œå¦‚ Edge å’Œ Chrome éƒ½æ— æ³•ä½¿ç”¨ã€‚
I found the easy way to make the UWP app touch not work in win10 17025(until 17134). To create a wpf app with transparent background and make it Topmost, you can see all of the UWP appâ€™s touch not work.</p>

<!--more-->

<!-- CreateTime:2018/9/1 9:50:18 -->

<!-- æ ‡ç­¾ï¼šWPFï¼ŒUWPï¼Œè§¦æ‘¸ -->

<h2 id="ä¸­æ–‡">ä¸­æ–‡</h2>

<p>å†™è‹±æ–‡çš„åŸå› æ˜¯ç»™å¾®è½¯æŠ¥è¿™ä¸ªé—®é¢˜ï¼Œç°åœ¨å‘åœ¨ <a href="https://developercommunity.visualstudio.com/content/problem/255063/on-windows-10-1803-all-applications-lost-touch-or.html">å¾®è½¯åé¦ˆ</a> å¸Œæœ›å¤§å®¶æŠ•ç¥¨ã€‚</p>

<p>æ­¥éª¤ï¼š</p>

<ol>
  <li>
    <p>åˆ›å»ºä¸€ä¸ª wpf ç¨‹åº</p>
  </li>
  <li>
    <p>è®¾ç½® wpf çš„çª—å£æœ€å¤§åŒ–</p>
  </li>
  <li>
    <p>è®¾ç½® wpf ç¨‹åºçš„èƒŒæ™¯ä¸ºé€æ˜</p>
  </li>
  <li>
    <p>å¯åŠ¨ wpf ç¨‹åº</p>
  </li>
</ol>

<p>è¿™æ—¶å°±å¯ä»¥çœ‹åˆ° Edge ç­‰è½¯ä»¶éƒ½æ— æ³•è§¦æ‘¸</p>

<p>åœ¨æ£€æŸ¥çš„æ—¶å€™å¯ä»¥ä½¿ç”¨<a href="https://github.com/walterlv/ManipulationDemo">ManipulationDemo</a>ï¼Œå¯ä»¥çœ‹åˆ°åœ¨è§¦æ‘¸çš„æ—¶å€™æ²¡æœ‰ Pointer æ¶ˆæ¯ã€‚</p>

<p><img src="http://image.acmx.xyz/34fdad35-5dfe-a75b-2b4b-8c5e313038e2%2F201711231645122017112316470.jpg" alt="" /></p>

<p>ä¸‹é¢æ˜¯å…³é—­ wpf ç¨‹åºä¹‹åï¼Œå¯ä»¥çœ‹åˆ°æœ€ä¸‹é¢æœ‰ Pointer æ¶ˆæ¯</p>

<p><img src="http://image.acmx.xyz/34fdad35-5dfe-a75b-2b4b-8c5e313038e2%2F2017112316451220171123165235.jpg" alt="" /></p>

<p>ä¸‹é¢æ˜¯è¿™ä¸ªwpfè½¯ä»¶ä»£ç ï¼š</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">public</span> <span class="nf">MainWindow</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span>

            <span class="n">AllowsTransparency</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">WindowStyle</span> <span class="p">=</span> <span class="n">WindowStyle</span><span class="p">.</span><span class="n">None</span><span class="p">;</span>
            <span class="n">WindowState</span> <span class="p">=</span> <span class="n">WindowState</span><span class="p">.</span><span class="n">Maximized</span><span class="p">;</span>
            <span class="n">Background</span> <span class="p">=</span> <span class="n">Brushes</span><span class="p">.</span><span class="n">Transparent</span><span class="p">;</span>
            <span class="n">Topmost</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="p">}</span>
</code></pre></div></div>

<h3 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h3>

<p>æœ€æ–°çš„å¾®è½¯è¡¥ä¸<a href="https://support.microsoft.com/zh-cn/help/4346783/windows-10-update-kb4346783">August 30, 2018â€”KB4346783</a> ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦åœ¨ç”¨æˆ·çš„è®¾å¤‡å®‰è£…è¿™ä¸ªè¡¥ä¸å°±å¯ä»¥è§£å†³</p>

<!-- ![](image/win10 17025 è§¦æ‘¸bug/win10 17025 è§¦æ‘¸bug0.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F2018919495409" alt="" /></p>

<p>ä¸‹é¢æ˜¯ä¸ä½¿ç”¨è¡¥ä¸çš„æ–¹æ³•</p>

<p>å¦‚æœè®¾ç½®äº†ä¸€ä¸ªçª—å£æ»¡è¶³ä¸‹é¢çš„å±æ€§</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="n">WindowStyle</span> <span class="p">=</span> <span class="n">WindowStyle</span><span class="p">.</span><span class="n">None</span><span class="p">;</span>
            <span class="n">WindowState</span> <span class="p">=</span> <span class="n">WindowState</span><span class="p">.</span><span class="n">Maximized</span><span class="p">;</span>
</code></pre></div></div>

<p>æˆ–</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="n">WindowStyle</span><span class="p">=</span><span class="s">"None"</span> 
            <span class="n">AllowsTransparency</span><span class="p">=</span><span class="s">"True"</span>
</code></pre></div></div>

<p>é‚£ä¹ˆå°±å¿…é¡»è¦è®¾ç½® <code class="language-plaintext highlighter-rouge">ResizeMode="NoResize"</code> ä¸ç„¶å°±ä¼šå‡ºç°ä¸‹é¢çš„é—®é¢˜</p>

<ul>
  <li>
    <p>åœ¨ win10 17025-17134 ç‰ˆæœ¬ï¼Œå¦‚æœåŒæ—¶è®¾ç½®<code class="language-plaintext highlighter-rouge">AllowsTransparency = true;</code>çª—å£ä¸‹é¢æ‰€æœ‰ç¨‹åºè§¦æ‘¸å¤±æ•ˆ</p>
  </li>
  <li>
    <p>è¿˜åŸçª—å£å†æœ€å¤§åŒ–ï¼Œçª—å£å‡ºç°åç§»</p>
  </li>
  <li>
    <p>åˆ‡æ¢å±å¹•ï¼Œçª—å£å‡ºç°åç§»</p>
  </li>
</ul>

<h2 id="english">English</h2>

<p>Step:</p>

<ol>
  <li>
    <p>Create a wpf app</p>
  </li>
  <li>
    <p>Set the wpf appâ€™s windows state is Maximized</p>
  </li>
  <li>
    <p>Set the wpf appâ€™s windows background is transparent</p>
  </li>
  <li>
    <p>Run the wpf app</p>
  </li>
</ol>

<p>Then you can see all of the uwp appâ€™s such as edge and setting touch not work.</p>

<p>You can use <a href="https://github.com/walterlv/ManipulationDemo">ManipulationDemo</a> to help you see the Pointer message that cant get when touch. I use <a href="https://github.com/walterlv/ManipulationDemo">ManipulationDemo</a> to find the pointer message have not be received. The app can only receive the mouse message.</p>

<p><img src="http://image.acmx.xyz/34fdad35-5dfe-a75b-2b4b-8c5e313038e2%2F201711231645122017112316470.jpg" alt="" /></p>

<p>I took an image that shows the pointer message when I closed the wpf app.</p>

<p><img src="http://image.acmx.xyz/34fdad35-5dfe-a75b-2b4b-8c5e313038e2%2F2017112316451220171123165235.jpg" alt="" /></p>

<p>This is the wpf appâ€™s code:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">public</span> <span class="nf">MainWindow</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span>

            <span class="n">AllowsTransparency</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">WindowStyle</span> <span class="p">=</span> <span class="n">WindowStyle</span><span class="p">.</span><span class="n">None</span><span class="p">;</span>
            <span class="n">WindowState</span> <span class="p">=</span> <span class="n">WindowState</span><span class="p">.</span><span class="n">Maximized</span><span class="p">;</span>
            <span class="n">Background</span> <span class="p">=</span> <span class="n">Brushes</span><span class="p">.</span><span class="n">Transparent</span><span class="p">;</span>
            <span class="n">Topmost</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>This is my system and I think in win10 17025 the windows cant make the app uses pointer message to work that exists another transparent background app in above.</p>

<p><img src="http://image.acmx.xyz/34fdad35-5dfe-a75b-2b4b-8c5e313038e2%2F201711231645122017112317012.jpg" alt="" /></p>

<h3 id="solution">Solution</h3>

<p>Microsoft has fixed this issue in <strong><a href="https://blogs.msdn.microsoft.com/dotnet/2018/08/30/net-framework-august-2018-preview-of-quality-rollup/">.NET Framework August 2018 Preview of Quality Rollup</a></strong>.</p>

<ul>
  <li><a href="https://support.microsoft.com/zh-cn/help/4346783/windows-10-update-kb4346783">August 30, 2018â€”KB4346783 (OS Build 17134.254)</a></li>
</ul>

<blockquote>
  <p>Addresses an issue where touch and mouse events were handled differently in Windows Presentation Foundation (WPF) applications that have a transparent overlay window.</p>
</blockquote>

<p><img src="http://image.acmx.xyz/lindexi%2F2018919495409" alt="" /></p>

<hr />

<p>If you have a Window that set the following properties.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="n">WindowStyle</span> <span class="p">=</span> <span class="n">WindowStyle</span><span class="p">.</span><span class="n">None</span><span class="p">;</span>
            <span class="n">WindowState</span> <span class="p">=</span> <span class="n">WindowState</span><span class="p">.</span><span class="n">Maximized</span><span class="p">;</span>
</code></pre></div></div>

<p>Or</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="n">WindowStyle</span><span class="p">=</span><span class="s">"None"</span> 
            <span class="n">AllowsTransparency</span><span class="p">=</span><span class="s">"True"</span>
</code></pre></div></div>

<p>You must set <code class="language-plaintext highlighter-rouge">ResizeMode="NoResize"</code> to avoid some problems as</p>

<ul>
  <li>
    <p>All applications lost touch or stylus if a WPF transparent window covers on them.</p>
  </li>
  <li>
    <p>Windows appears offset when set it to <code class="language-plaintext highlighter-rouge">Maximized</code> from <code class="language-plaintext highlighter-rouge">Normal</code>.</p>
  </li>
  <li>
    <p>Windows appears offset when switch screen.</p>
  </li>
</ul>

<p>See <a href="https://stackoverflow.com/questions/50382605/on-windows-10-1803-all-applications-lost-touch-or-stylus-if-a-wpf-transparent">c# - On Windows 10 (1803), all applications lost touch or stylus if a WPF transparent window covers on them</a></p>

<p><a href="https://developercommunity.visualstudio.com/content/problem/255063/on-windows-10-1803-all-applications-lost-touch-or.html">On Windows 10 (1803), all applications lost touch or stylus if a WPF transparent window covers on them - Developer Community</a></p>

<p><a href="https://github.com/dotnet-campus/TouchIssueOnWindows10.0.17134">dotnet-campus/TouchIssueOnWindows10.0.17134: On Windows 10 (1803), all applications lost touch or stylus if a WPF transparent window covers on them</a></p>

:ET