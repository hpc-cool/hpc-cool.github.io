I"	<p>调用 SetWindowLong 方法给 GWL_EXSTYLE 设置 WS_EX_TRANSPARENT 让窗口透明，此时应用程序只能收到鼠标消息但收不到触摸消息</p>

<!--more-->

<!-- CreateTime:6/16/2020 8:46:23 AM -->

<p>最简单的 demo 是在 Load 事件添加下面代码</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">MainWindow_Loaded</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IntPtr</span> <span class="n">hwnd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WindowInteropHelper</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">Handle</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">extendedStyle</span> <span class="p">=</span> <span class="nf">GetWindowLong</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">GWL_EXSTYLE</span><span class="p">);</span>
            <span class="nf">SetWindowLong</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">GWL_EXSTYLE</span><span class="p">,</span> <span class="n">extendedStyle</span> <span class="p">|</span> <span class="n">WS_EX_TRANSPARENT</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>此时可以发现窗口的 MouseDown 能收到，但是 TouchDown 事件收不到</p>

<p>最简单的 demo 放在 <a href="https://github.com/dotnet-campus/wpf-issues/tree/master/CanNotReceiveTouchMessageWS_EX_TRANSPARENT">github</a> 欢迎小伙伴访问</p>

<p>此问题报告为官方，请看 <a href="https://github.com/dotnet/wpf/issues/3145">WPF can not receive the touch message when set WS_EX_TRANSPARENT to window</a></p>

<p>因为小伙伴很少会用到这个方法设置透明，因此此问题影响很小</p>

<p>正规的透明设置方法请看 <a href="https://blog.walterlv.com/post/wpf-transparent-window-without-allows-transparency.html">WPF 制作高性能的透明背景异形窗口（使用 WindowChrome 而不要使用 AllowsTransparency=True） - walterlv</a></p>

:ET