I"¦¯<p>ç»å¸¸ä¼šå‘ç°è‡ªå·±çš„åšå®¢è¢«ä¸€äº›åƒåœ¾ç½‘ç«™æŠ“å–ï¼Œæˆ‘å°±åœ¨åšå®¢è¿›è¡ŒåŠ å¯†ï¼Œåœ¨è®¿é—®çš„æ—¶å€™è¿›è¡Œè§£å¯†ï¼Œäºæ˜¯çˆ¬è™«å¦‚æœä¸æ‰§è¡Œjså°±æ— æ³•è·å¾—å†…å®¹ã€‚
æœ¬æ–‡å‘Šè¯‰å¤§å®¶å¦‚ä½•åŠ å¯†åšå®¢ã€‚</p>

<!--more-->

<!-- CreateTime:2019/1/29 16:26:17 -->

<p>åŠ å¯†ä½¿ç”¨æŠŠæ–‡ç« å†…å®¹è½¬æ¢ä¸º Html ä¹‹åè½¬æ¢ä¸º base64 ç„¶ååœ¨åŠ è½½å®Œæˆä¹‹åæŠŠ base64 è½¬æ¢ä¸º html ï¼Œè¿™ä¸ªæ–¹å¼å°±å¯ä»¥è§£å¯†æ–‡ç« ã€‚</p>

<p>æ–‡ç« çš„æ‘˜è¦å¯ä»¥ä¸åŠ å¯†ï¼Œä½†æ˜¯æ–‡ç« å†…å®¹å¯ä»¥ä½¿ç”¨è¿™æ–¹æ³•è¿›è¡ŒåŠ å¯†ã€‚</p>

<p>æˆ‘ä½¿ç”¨ Pandoc è½¬æ¢ html ï¼Œæ¨èä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚ç„¶åæŠŠæˆ‘çš„æ–‡ç« è½¬æ¢å¾—åˆ°çš„ html åœ¨ <a href="http://base64.xpcha.com/">base64 è½¬å›¾ç‰‡ åœ¨çº¿è§£ç ç¼–ç </a>è½¬æ¢å¾—åˆ° base64 ã€‚ç„¶åæŠŠè¿™äº›ä»£ç æ”¾åœ¨ä¸€ä¸ª div å†…ï¼Œåœ¨é¡µé¢åŠ è½½å®Œæˆå°±æŠŠä»–è½¬æ¢ä¸º html</p>

<p>æˆ‘ä¸‹é¢ä¼šæŠŠ js æ”¾åœ¨æ–‡ç« æœ€åï¼Œå¤§å®¶å¯ä»¥å¤åˆ¶å»è‡ªå·±åšå®¢ä½¿ç”¨ï¼Œä½¿ç”¨åªéœ€è¦æŠŠè½¬æ¢ html åçš„ä»£ç æ”¾åœ¨ä¸‹é¢çš„ div é‡Œ</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="err">="</span><span class="nc">src</span><span class="s">"&gt;
</span><span class="n">base64</span>
<span class="p">&lt;/</span><span class="n">div</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>åœ¨é¡µé¢åŠ è½½å®Œæˆå°±ä¼šæŠŠ base64 è½¬æ¢ä¸º html ã€‚</p>

<p>è¿™æ—¶ä¼šå‘ç°ï¼Œæ‰“å¼€é¡µé¢çœ‹åˆ°çš„æ˜¯base64ï¼Œæ‰€ä»¥å¯ä»¥å…ˆæŠŠä»–éšè—ï¼Œè®¾ç½® css éšè— src ï¼Œè¯·çœ‹ä¸‹é¢çš„ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">.</span><span class="n">src</span>
<span class="p">{</span>
    <span class="n">display</span><span class="p">:</span> <span class="n">none</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>å…³é”® js ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="err">$</span><span class="p">(</span><span class="n">document</span><span class="p">).</span><span class="nf">ready</span><span class="p">(</span><span class="nf">function</span><span class="p">()</span> 
       <span class="p">{</span>
             <span class="kt">var</span> <span class="n">src</span> <span class="p">=</span> <span class="n">document</span><span class="p">.</span><span class="nf">getElementsByClassName</span><span class="p">(</span><span class="err">'</span><span class="n">src</span><span class="err">'</span><span class="p">);</span>
             <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">src</span><span class="p">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> 
             <span class="p">{</span>
                 <span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">innerHTML</span> <span class="p">=</span> <span class="nf">utf8to16</span><span class="p">(</span><span class="nf">base64decode</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">innerText</span><span class="p">));</span>
                 <span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">style</span><span class="p">.</span><span class="n">display</span> <span class="p">=</span> <span class="s">"inline"</span><span class="p">;</span>
             <span class="p">}</span>
         <span class="p">});</span>
</code></pre></div></div>

<p>ä½†æ˜¯å¾ˆå¤šçˆ¬è™«è¿˜æ˜¯ä¼šæ‰§è¡Œä¸€ä¸‹ä»£ç ï¼Œäºæ˜¯ä»–è¿˜æ˜¯å¯ä»¥è·å¾—æºä»£ç ï¼Œå¦‚ä½•è®©ä»–æ— æ³•è·å¾—æºä»£ç ï¼Ÿå®é™…ä¸Šæˆ‘è¿˜æƒ³åˆ°å¦ä¸€ä¸ªæ–¹æ³•ï¼Œå…ˆæŠŠ html è½¬æ¢ä¸º äºŒè¿›åˆ¶ï¼Œ ç„¶åä» 0-1000 é€‰ä¸€ä¸ªæ•°ä½œä¸ºå¯†ç ï¼Œå¯¹ä»–åŠ å¯†ã€‚å¾—åˆ°çš„å†…å®¹è½¬æ¢ä¸º base64 ç„¶åæ”¾åœ¨ä¸Šé¢çš„ div è¿™æ ·åœ¨é¡µé¢åŠ è½½å®Œæˆä¹‹åï¼Œæ‰§è¡Œä»£ç ï¼Œå°è¯•ä» 0-1000 è¿›è¡Œè§£å¯†ï¼Œäºæ˜¯å°±å¯ä»¥è·å¾—ä¸€ä¸ªæ­£ç¡® html è¿™æ ·å°±å¯ä»¥è®©jsæ‰§è¡Œæ—¶é—´å˜é•¿ï¼Œä¸€èˆ¬çš„åƒåœ¾ç½‘ç«™ä¸ä¼šè®©è‡ªå·±çš„ç½‘ç«™çˆ¬è¿™æ ·çš„æ–‡ç« ã€‚</p>

<ol>
  <li>
    <p>è½¬æ¢ html</p>
  </li>
  <li>
    <p>html è½¬ äºŒè¿›åˆ¶</p>
  </li>
  <li>
    <p>éšæœºä» 0-1000 é€‰ä¸€ä¸ªæ•°å­—</p>
  </li>
  <li>
    <p>æŠŠ â€œlindexiâ€ è½¬äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”æŠŠä»–è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†çš„å¯†ç å°±æ˜¯ä¸Šé¢é€‰çš„æ•°å­—ã€‚</p>
  </li>
  <li>
    <p>æŠŠ html è½¬æ¢å¾—åˆ°çš„äºŒè¿›åˆ¶è¿›è¡ŒåŠ å¯†</p>
  </li>
  <li>
    <p>æŠŠä¸Šé¢åŠ å¯†çš„å†…å®¹è½¬æ¢ä¸º base64 æ”¾åœ¨åšå®¢é‡Œ</p>
  </li>
</ol>

<p>æ‰“å¼€ç½‘é¡µæ—¶çš„ç®—æ³•</p>

<ol>
  <li>
    <p>è·å¾—ä» lindexi è½¬æ¢äºŒè¿›åˆ¶åŠ å¯†çš„ base64 ä» 0-1000 é€‰æ•°å­—ï¼Œçœ‹å“ªä¸ªæ•°å­—å¯ä»¥è§£å¯†å¾—åˆ° â€œlindexiâ€</p>
  </li>
  <li>
    <p>ä»ä¸Šä¸€æ­¥æ‹¿åˆ°çš„æ•°å­—å¯¹ html åŠ å¯†åçš„äºŒè¿›åˆ¶è¿›è¡Œè§£å¯†</p>
  </li>
  <li>
    <p>æ˜¾ç¤ºè§£å¯†åçš„html</p>
  </li>
</ol>

<p>æˆ‘æƒ³çš„è¿™ä¸ªç®—æ³•æ„Ÿè§‰æ¯”è¾ƒå¥½ï¼Œä½†æ˜¯ä¸ä¼šå†™ï¼Œä¸çŸ¥é“æœ‰å“ªä½å¤§ç¥å¯ä»¥å¸®æˆ‘å†™ã€‚</p>

<p>å½“ç„¶è¿™æ ·ä¹Ÿå¯ä»¥åšåšå®¢åŠ å¯†ï¼Œå°±æ˜¯æŠŠéšæœºé€‰ä¸€ä¸ªæ•°å­—å˜ä¸ºè‡ªå·±è®¾ç½®ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ç„¶åæ‰“å¼€ç½‘é¡µå¼¹å‡ºçª—å£è¾“å…¥å­—ç¬¦ä¸²è§£å¯†ã€‚</p>

<p>å…¨éƒ¨ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">base64EncodeChars</span> <span class="p">=</span> <span class="s">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">base64DecodeChars</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Array</span><span class="p">(</span>
    <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span>
    <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span>
    <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="m">62</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="m">63</span><span class="p">,</span>
    <span class="m">52</span><span class="p">,</span> <span class="m">53</span><span class="p">,</span> <span class="m">54</span><span class="p">,</span> <span class="m">55</span><span class="p">,</span> <span class="m">56</span><span class="p">,</span> <span class="m">57</span><span class="p">,</span> <span class="m">58</span><span class="p">,</span> <span class="m">59</span><span class="p">,</span> <span class="m">60</span><span class="p">,</span> <span class="m">61</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span>
    <span class="p">-</span><span class="m">1</span><span class="p">,</span>  <span class="m">0</span><span class="p">,</span>  <span class="m">1</span><span class="p">,</span>  <span class="m">2</span><span class="p">,</span>  <span class="m">3</span><span class="p">,</span>  <span class="m">4</span><span class="p">,</span>  <span class="m">5</span><span class="p">,</span>  <span class="m">6</span><span class="p">,</span>  <span class="m">7</span><span class="p">,</span>  <span class="m">8</span><span class="p">,</span>  <span class="m">9</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">11</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">13</span><span class="p">,</span> <span class="m">14</span><span class="p">,</span>
    <span class="m">15</span><span class="p">,</span> <span class="m">16</span><span class="p">,</span> <span class="m">17</span><span class="p">,</span> <span class="m">18</span><span class="p">,</span> <span class="m">19</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">21</span><span class="p">,</span> <span class="m">22</span><span class="p">,</span> <span class="m">23</span><span class="p">,</span> <span class="m">24</span><span class="p">,</span> <span class="m">25</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span>
    <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="m">26</span><span class="p">,</span> <span class="m">27</span><span class="p">,</span> <span class="m">28</span><span class="p">,</span> <span class="m">29</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="m">31</span><span class="p">,</span> <span class="m">32</span><span class="p">,</span> <span class="m">33</span><span class="p">,</span> <span class="m">34</span><span class="p">,</span> <span class="m">35</span><span class="p">,</span> <span class="m">36</span><span class="p">,</span> <span class="m">37</span><span class="p">,</span> <span class="m">38</span><span class="p">,</span> <span class="m">39</span><span class="p">,</span> <span class="m">40</span><span class="p">,</span>
    <span class="m">41</span><span class="p">,</span> <span class="m">42</span><span class="p">,</span> <span class="m">43</span><span class="p">,</span> <span class="m">44</span><span class="p">,</span> <span class="m">45</span><span class="p">,</span> <span class="m">46</span><span class="p">,</span> <span class="m">47</span><span class="p">,</span> <span class="m">48</span><span class="p">,</span> <span class="m">49</span><span class="p">,</span> <span class="m">50</span><span class="p">,</span> <span class="m">51</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span>

<span class="n">function</span> <span class="nf">base64encode</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">var</span> <span class="k">out</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">len</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">;</span>

    <span class="n">len</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
    <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="k">out</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">c1</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++)</span> <span class="p">&amp;</span> <span class="m">0xff</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">base64EncodeChars</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(</span><span class="n">c1</span> <span class="p">&gt;&gt;</span> <span class="m">2</span><span class="p">);</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">base64EncodeChars</span><span class="p">.</span><span class="nf">charAt</span><span class="p">((</span><span class="n">c1</span> <span class="p">&amp;</span> <span class="m">0x3</span><span class="p">)</span> <span class="p">&lt;&lt;</span> <span class="m">4</span><span class="p">);</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="s">"=="</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">c2</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="p">==</span> <span class="n">len</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">base64EncodeChars</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(</span><span class="n">c1</span> <span class="p">&gt;&gt;</span> <span class="m">2</span><span class="p">);</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">base64EncodeChars</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(((</span><span class="n">c1</span> <span class="p">&amp;</span> <span class="m">0x3</span><span class="p">)&lt;&lt;</span> <span class="m">4</span><span class="p">)</span> <span class="p">|</span> <span class="p">((</span><span class="n">c2</span> <span class="p">&amp;</span> <span class="m">0xF0</span><span class="p">)</span> <span class="p">&gt;&gt;</span> <span class="m">4</span><span class="p">));</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">base64EncodeChars</span><span class="p">.</span><span class="nf">charAt</span><span class="p">((</span><span class="n">c2</span> <span class="p">&amp;</span> <span class="m">0xF</span><span class="p">)</span> <span class="p">&lt;&lt;</span> <span class="m">2</span><span class="p">);</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="s">"="</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">c3</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++);</span>
    <span class="k">out</span> <span class="p">+=</span> <span class="n">base64EncodeChars</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(</span><span class="n">c1</span> <span class="p">&gt;&gt;</span> <span class="m">2</span><span class="p">);</span>
    <span class="k">out</span> <span class="p">+=</span> <span class="n">base64EncodeChars</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(((</span><span class="n">c1</span> <span class="p">&amp;</span> <span class="m">0x3</span><span class="p">)&lt;&lt;</span> <span class="m">4</span><span class="p">)</span> <span class="p">|</span> <span class="p">((</span><span class="n">c2</span> <span class="p">&amp;</span> <span class="m">0xF0</span><span class="p">)</span> <span class="p">&gt;&gt;</span> <span class="m">4</span><span class="p">));</span>
    <span class="k">out</span> <span class="p">+=</span> <span class="n">base64EncodeChars</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(((</span><span class="n">c2</span> <span class="p">&amp;</span> <span class="m">0xF</span><span class="p">)</span> <span class="p">&lt;&lt;</span> <span class="m">2</span><span class="p">)</span> <span class="p">|</span> <span class="p">((</span><span class="n">c3</span> <span class="p">&amp;</span> <span class="m">0xC0</span><span class="p">)</span> <span class="p">&gt;&gt;</span><span class="m">6</span><span class="p">));</span>
    <span class="k">out</span> <span class="p">+=</span> <span class="n">base64EncodeChars</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(</span><span class="n">c3</span> <span class="p">&amp;</span> <span class="m">0x3F</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">out</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">function</span> <span class="nf">base64decode</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">var</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">i</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="k">out</span><span class="p">;</span>

    <span class="n">len</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
    <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="k">out</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* c1 */</span>
    <span class="k">do</span> <span class="p">{</span>
        <span class="n">c1</span> <span class="p">=</span> <span class="n">base64DecodeChars</span><span class="p">[</span><span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++)</span> <span class="p">&amp;</span> <span class="m">0xff</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span> <span class="p">&amp;&amp;</span> <span class="n">c1</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c1</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="cm">/* c2 */</span>
    <span class="k">do</span> <span class="p">{</span>
        <span class="n">c2</span> <span class="p">=</span> <span class="n">base64DecodeChars</span><span class="p">[</span><span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++)</span> <span class="p">&amp;</span> <span class="m">0xff</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span> <span class="p">&amp;&amp;</span> <span class="n">c2</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c2</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">out</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">((</span><span class="n">c1</span> <span class="p">&lt;&lt;</span> <span class="m">2</span><span class="p">)</span> <span class="p">|</span> <span class="p">((</span><span class="n">c2</span> <span class="p">&amp;</span> <span class="m">0x30</span><span class="p">)</span> <span class="p">&gt;&gt;</span> <span class="m">4</span><span class="p">));</span>

    <span class="cm">/* c3 */</span>
    <span class="k">do</span> <span class="p">{</span>
        <span class="n">c3</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++)</span> <span class="p">&amp;</span> <span class="m">0xff</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">c3</span> <span class="p">==</span> <span class="m">61</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">out</span><span class="p">;</span>
        <span class="n">c3</span> <span class="p">=</span> <span class="n">base64DecodeChars</span><span class="p">[</span><span class="n">c3</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span> <span class="p">&amp;&amp;</span> <span class="n">c3</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c3</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">out</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(((</span><span class="n">c2</span> <span class="p">&amp;</span> <span class="m">0XF</span><span class="p">)</span> <span class="p">&lt;&lt;</span> <span class="m">4</span><span class="p">)</span> <span class="p">|</span> <span class="p">((</span><span class="n">c3</span> <span class="p">&amp;</span> <span class="m">0x3C</span><span class="p">)</span> <span class="p">&gt;&gt;</span> <span class="m">2</span><span class="p">));</span>

    <span class="cm">/* c4 */</span>
    <span class="k">do</span> <span class="p">{</span>
        <span class="n">c4</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++)</span> <span class="p">&amp;</span> <span class="m">0xff</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">c4</span> <span class="p">==</span> <span class="m">61</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">out</span><span class="p">;</span>
        <span class="n">c4</span> <span class="p">=</span> <span class="n">base64DecodeChars</span><span class="p">[</span><span class="n">c4</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span> <span class="p">&amp;&amp;</span> <span class="n">c4</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">c4</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">out</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(((</span><span class="n">c3</span> <span class="p">&amp;</span> <span class="m">0x03</span><span class="p">)</span> <span class="p">&lt;&lt;</span> <span class="m">6</span><span class="p">)</span> <span class="p">|</span> <span class="n">c4</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">out</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">function</span> <span class="nf">utf16to8</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">var</span> <span class="k">out</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>

    <span class="k">out</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="n">len</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> <span class="p">{</span>
    <span class="n">c</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">c</span> <span class="p">&gt;=</span> <span class="m">0x0001</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="p">&lt;=</span> <span class="m">0x007F</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="p">&gt;</span> <span class="m">0x07FF</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(</span><span class="m">0xE0</span> <span class="p">|</span> <span class="p">((</span><span class="n">c</span> <span class="p">&gt;&gt;</span> <span class="m">12</span><span class="p">)</span> <span class="p">&amp;</span> <span class="m">0x0F</span><span class="p">));</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(</span><span class="m">0x80</span> <span class="p">|</span> <span class="p">((</span><span class="n">c</span> <span class="p">&gt;&gt;</span>  <span class="m">6</span><span class="p">)</span> <span class="p">&amp;</span> <span class="m">0x3F</span><span class="p">));</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(</span><span class="m">0x80</span> <span class="p">|</span> <span class="p">((</span><span class="n">c</span> <span class="p">&gt;&gt;</span>  <span class="m">0</span><span class="p">)</span> <span class="p">&amp;</span> <span class="m">0x3F</span><span class="p">));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(</span><span class="m">0xC0</span> <span class="p">|</span> <span class="p">((</span><span class="n">c</span> <span class="p">&gt;&gt;</span>  <span class="m">6</span><span class="p">)</span> <span class="p">&amp;</span> <span class="m">0x1F</span><span class="p">));</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(</span><span class="m">0x80</span> <span class="p">|</span> <span class="p">((</span><span class="n">c</span> <span class="p">&gt;&gt;</span>  <span class="m">0</span><span class="p">)</span> <span class="p">&amp;</span> <span class="m">0x3F</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">out</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">function</span> <span class="nf">utf8to16</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">var</span> <span class="k">out</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">char2</span><span class="p">,</span> <span class="n">char3</span><span class="p">;</span>

    <span class="k">out</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="n">len</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
    <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">c</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++);</span>
    <span class="k">switch</span><span class="p">(</span><span class="n">c</span> <span class="p">&gt;&gt;</span> <span class="m">4</span><span class="p">)</span>
    <span class="p">{</span> 
      <span class="k">case</span> <span class="m">0</span><span class="p">:</span> <span class="k">case</span> <span class="m">1</span><span class="p">:</span> <span class="k">case</span> <span class="m">2</span><span class="p">:</span> <span class="k">case</span> <span class="m">3</span><span class="p">:</span> <span class="k">case</span> <span class="m">4</span><span class="p">:</span> <span class="k">case</span> <span class="m">5</span><span class="p">:</span> <span class="k">case</span> <span class="m">6</span><span class="p">:</span> <span class="k">case</span> <span class="m">7</span><span class="p">:</span>
        <span class="c1">// 0xxxxxxx</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charAt</span><span class="p">(</span><span class="n">i</span><span class="p">-</span><span class="m">1</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="m">12</span><span class="p">:</span> <span class="k">case</span> <span class="m">13</span><span class="p">:</span>
        <span class="c1">// 110x xxxx   10xx xxxx</span>
        <span class="n">char2</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++);</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(((</span><span class="n">c</span> <span class="p">&amp;</span> <span class="m">0x1F</span><span class="p">)</span> <span class="p">&lt;&lt;</span> <span class="m">6</span><span class="p">)</span> <span class="p">|</span> <span class="p">(</span><span class="n">char2</span> <span class="p">&amp;</span> <span class="m">0x3F</span><span class="p">));</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="m">14</span><span class="p">:</span>
        <span class="c1">// 1110 xxxx  10xx xxxx  10xx xxxx</span>
        <span class="n">char2</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++);</span>
        <span class="n">char3</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++);</span>
        <span class="k">out</span> <span class="p">+=</span> <span class="n">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(((</span><span class="n">c</span> <span class="p">&amp;</span> <span class="m">0x0F</span><span class="p">)</span> <span class="p">&lt;&lt;</span> <span class="m">12</span><span class="p">)</span> <span class="p">|</span>
                       <span class="p">((</span><span class="n">char2</span> <span class="p">&amp;</span> <span class="m">0x3F</span><span class="p">)</span> <span class="p">&lt;&lt;</span> <span class="m">6</span><span class="p">)</span> <span class="p">|</span>
                       <span class="p">((</span><span class="n">char3</span> <span class="p">&amp;</span> <span class="m">0x3F</span><span class="p">)</span> <span class="p">&lt;&lt;</span> <span class="m">0</span><span class="p">));</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">out</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">function</span> <span class="nf">CharToHex</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">var</span> <span class="k">out</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="p">;</span>
    <span class="k">out</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="n">len</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
    <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="p">&lt;</span> <span class="n">len</span><span class="p">)</span> 
    <span class="p">{</span>
	    <span class="n">c</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="n">i</span><span class="p">++);</span>
	    <span class="n">h</span> <span class="p">=</span> <span class="n">c</span><span class="p">.</span><span class="nf">toString</span><span class="p">(</span><span class="m">16</span><span class="p">);</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">length</span> <span class="p">&lt;</span> <span class="m">2</span><span class="p">)</span>
	    	<span class="n">h</span> <span class="p">=</span> <span class="s">"0"</span> <span class="p">+</span> <span class="n">h</span><span class="p">;</span>
	    
	    <span class="k">out</span> <span class="p">+=</span> <span class="s">"\\x"</span> <span class="p">+</span> <span class="n">h</span> <span class="p">+</span> <span class="s">" "</span><span class="p">;</span>
	    <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">i</span> <span class="p">%</span> <span class="m">8</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
	    	<span class="k">out</span> <span class="p">+=</span> <span class="s">"\r\n"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">out</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">function</span> <span class="nf">doEncode</span><span class="p">()</span> <span class="p">{</span>
	<span class="kt">var</span> <span class="n">src</span> <span class="p">=</span> <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">'</span><span class="n">src</span><span class="err">'</span><span class="p">).</span><span class="k">value</span><span class="p">;</span>
	<span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">'</span><span class="n">dest</span><span class="err">'</span><span class="p">).</span><span class="k">value</span> <span class="p">=</span> <span class="nf">base64encode</span><span class="p">(</span><span class="nf">utf16to8</span><span class="p">(</span><span class="n">src</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">function</span> <span class="nf">doDecode</span><span class="p">()</span> <span class="p">{</span>
	<span class="kt">var</span> <span class="n">src</span> <span class="p">=</span> <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">'</span><span class="n">src</span><span class="err">'</span><span class="p">).</span><span class="k">value</span><span class="p">;</span>
	<span class="kt">var</span> <span class="n">opts</span> <span class="p">=</span> <span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">'</span><span class="n">opt</span><span class="err">'</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span><span class="n">opts</span><span class="p">.</span><span class="k">checked</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">'</span><span class="n">dest</span><span class="err">'</span><span class="p">).</span><span class="k">value</span> <span class="p">=</span> <span class="nf">CharToHex</span><span class="p">(</span><span class="nf">base64decode</span><span class="p">(</span><span class="n">src</span><span class="p">));</span>
	<span class="p">}</span>
	<span class="k">else</span>
	<span class="p">{</span>
		<span class="n">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="err">'</span><span class="n">dest</span><span class="err">'</span><span class="p">).</span><span class="k">value</span> <span class="p">=</span> <span class="nf">utf8to16</span><span class="p">(</span><span class="nf">base64decode</span><span class="p">(</span><span class="n">src</span><span class="p">));</span>
	<span class="p">}</span>
<span class="p">}</span>

       <span class="err">$</span><span class="p">(</span><span class="n">document</span><span class="p">).</span><span class="nf">ready</span><span class="p">(</span><span class="nf">function</span><span class="p">()</span> 
       <span class="p">{</span>
             <span class="kt">var</span> <span class="n">src</span> <span class="p">=</span> <span class="n">document</span><span class="p">.</span><span class="nf">getElementsByClassName</span><span class="p">(</span><span class="err">'</span><span class="n">src</span><span class="err">'</span><span class="p">);</span>
             <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">src</span><span class="p">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span> 
             <span class="p">{</span>
                 <span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">innerHTML</span> <span class="p">=</span> <span class="nf">utf8to16</span><span class="p">(</span><span class="nf">base64decode</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">innerText</span><span class="p">));</span>
                 <span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">style</span><span class="p">.</span><span class="n">display</span> <span class="p">=</span> <span class="s">"inline"</span><span class="p">;</span>
             <span class="p">}</span>
         <span class="p">});</span>



</code></pre></div></div>

:ET