I"]ö<p>åœ¨ OpenXML çš„ PPT çš„æ–‡æœ¬çš„å­—ä½“æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„æ¦‚å¿µï¼Œå³ä½¿åœ¨ OpenXML SDK çš„è¾…åŠ©ä¸‹ï¼Œä¹Ÿéœ€è¦è‡ªå·±å†™å¾ˆå¤šçš„é€»è¾‘ã€‚é€šè¿‡ ECMA 376 æ–‡æ¡£é‡Œé¢æ•£è½åœ¨å„åœ°çš„æè¿°ï¼Œå’Œ dotnetCampus.OfficeDocumentZipper å·¥å…·çš„å®éªŒå¸®åŠ©ä¹‹ä¸‹ï¼Œæˆ‘æ‘¸åˆ°äº†æœ¬æ–‡å°†è¦å‘Šè¯‰å¤§å®¶çš„è§„åˆ™ï¼Œä»¥åŠé€»è¾‘çš„å®ç°</p>

<!--more-->

<!-- CreateTime:2020/8/10 10:17:20 -->

<p>æœ‰å¤§é‡çš„ Office ç›¸å…³è½¯ä»¶åœ¨è§£æ PPT æ–‡æ¡£ä½¿ç”¨çš„æ–‡æœ¬æ®µçš„å­—ä½“éƒ½éå¸¸ç®€å•ï¼Œå½“ç„¶ï¼Œè¿™éƒ¨åˆ†å¤„ç†ä¹Ÿå°±ä¸å…¨é¢</p>

<p>å…ˆè®©å’±çœ‹ä¸€ä¸ªç®€å•çš„ PPT æ–‡æ¡£çš„å­—ä½“å®šä¹‰å†™æ³•</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a:r&gt;</span>
    <span class="nt">&lt;a:rPr</span> <span class="na">lang=</span><span class="s">"zh-CN"</span> <span class="na">altLang=</span><span class="s">"en-US"</span> <span class="na">dirty=</span><span class="s">"0"</span> <span class="na">smtClean=</span><span class="s">"0"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a:ea</span> <span class="na">typeface=</span><span class="s">"æ¥·ä½“"</span> <span class="na">panose=</span><span class="s">"02010609060101010101"</span> <span class="na">pitchFamily=</span><span class="s">"49"</span> <span class="na">charset=</span><span class="s">"-122"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/a:rPr&gt;</span>
    <span class="nt">&lt;a:t&gt;</span>ä¸€è¡Œæ–‡æœ¬<span class="nt">&lt;/a:t&gt;</span>
<span class="nt">&lt;/a:r&gt;</span>
</code></pre></div></div>

<p>è¯·é—®å½“å‰æ–‡æœ¬çš„å­—ä½“æ˜¯ä»€ä¹ˆï¼Ÿäººç±»ç®€å•å°±èƒ½å›ç­”æ˜¯ <code class="language-plaintext highlighter-rouge">æ¥·ä½“</code> äº†</p>

<p>é‚£ä¹ˆæ›´è¿›ä¸€æ­¥çš„ï¼Œå¦‚ä¸‹é¢çš„ PPT æ–‡æ¡£å‘¢ï¼Ÿ</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a:r&gt;</span>
    <span class="nt">&lt;a:rPr</span> <span class="na">lang=</span><span class="s">"zh-CN"</span> <span class="na">altLang=</span><span class="s">"en-US"</span> <span class="na">sz=</span><span class="s">"2000"</span> <span class="na">dirty=</span><span class="s">"0"</span> <span class="na">smtClean=</span><span class="s">"0"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a:latin</span> <span class="na">typeface=</span><span class="s">"Jokerman"</span> <span class="na">panose=</span><span class="s">"02010609060101010101"</span> <span class="na">pitchFamily=</span><span class="s">"49"</span> <span class="na">charset=</span><span class="s">"-122"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:ea</span> <span class="na">typeface=</span><span class="s">"å®‹ä½“"</span> <span class="na">panose=</span><span class="s">"02010609060101010101"</span> <span class="na">pitchFamily=</span><span class="s">"49"</span> <span class="na">charset=</span><span class="s">"-122"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/a:rPr&gt;</span>
    <span class="nt">&lt;a:t&gt;</span>aæ–‡æœ¬<span class="nt">&lt;/a:t&gt;</span>
<span class="nt">&lt;/a:r&gt;</span>
</code></pre></div></div>

<p>æ­¤æ—¶çš„ <code class="language-plaintext highlighter-rouge">a:latin</code> å’Œ <code class="language-plaintext highlighter-rouge">a:ea</code> è¡¨ç¤ºçš„æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿéœ€è¦ä½¿ç”¨å“ªä¸ªå­—ä½“æ‰å¯¹ï¼Ÿå…¶å®è¿™æ˜¯ PPT çš„å…è®¸è¥¿æ–‡å’Œä¸­æ–‡ä½¿ç”¨ä¸åŒå­—ä½“çš„åŠŸèƒ½</p>

<!-- ![](image/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£0.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20208101034419639.jpg" alt="" /></p>

<p>è¿™å°±æ˜¯éœ€è¦è®©ä¸åŒçš„å­—ç¬¦é€‰æ‹©ä¸åŒçš„å­—ä½“çš„åŠŸèƒ½ï¼Œè§£ææ–¹å¼è¯·çœ‹ <a href="https://blog.lindexi.com/post/dotnet-OpenXML-%E6%96%87%E6%9C%AC%E5%AD%97%E4%BD%93%E7%9A%84%E9%80%89%E6%8B%A9%E8%A7%84%E5%88%99.html">dotnet OpenXML æ–‡æœ¬å­—ä½“çš„é€‰æ‹©è§„åˆ™</a></p>

<p>æ˜¯ä¸æ˜¯è§‰å¾—æœ‰ç‚¹å¤æ‚äº†ï¼Ÿå…¶å®è¿™è¿˜ä¸ç®—å¤æ‚çš„</p>

<p>çœ‹çœ‹ä¸‹é¢è¿™ä»½ç®€æ´çš„ PPT æ–‡æ¡£</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;p:txBody&gt;</span>
    <span class="nt">&lt;a:bodyPr</span> <span class="na">wrap=</span><span class="s">"square"</span> <span class="na">rtlCol=</span><span class="s">"0"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a:spAutoFit/&gt;</span>
    <span class="nt">&lt;/a:bodyPr&gt;</span>
    <span class="nt">&lt;a:lstStyle/&gt;</span>
    <span class="nt">&lt;a:p&gt;</span>
        <span class="nt">&lt;a:r&gt;</span>
            <span class="nt">&lt;a:rPr</span> <span class="na">lang=</span><span class="s">"zh-CN"</span> <span class="na">altLang=</span><span class="s">"en-US"</span> <span class="na">smtClean=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;a:t&gt;</span>ä¸€è¡Œæ–‡æœ¬<span class="nt">&lt;/a:t&gt;</span>
        <span class="nt">&lt;/a:r&gt;</span>
        <span class="nt">&lt;a:endParaRPr</span> <span class="na">lang=</span><span class="s">"en-US"</span> <span class="na">dirty=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/a:p&gt;</span>
<span class="nt">&lt;/p:txBody&gt;</span>
</code></pre></div></div>

<p>è¯·é—®è¿™ä»½æ–‡æ¡£çš„å­—ä½“æ˜¯ä»€ä¹ˆï¼Ÿå…¶å®ä¸Šé¢çš„ä»£ç æ²¡æœ‰å†™ä»»ä½•çš„å­—ä½“ï¼Œé‚£ä¹ˆ PPT æ˜¯å¦‚ä½•çŸ¥é“çš„ï¼Ÿè¿™å°±éœ€è¦ç”¨åˆ°ä¸Šé¢ä»£ç ä¸€ä¸ªæ²¡æœ‰å†™å®Œæˆçš„åŠŸèƒ½ï¼Œå°±æ˜¯æ ·å¼åˆ—è¡¨äº†</p>

<p>å°ä¼™ä¼´å¯ä»¥æ³¨æ„åˆ°ä¸Šé¢ä»£ç çš„ä¸€è¡Œå†…å®¹ <code class="language-plaintext highlighter-rouge">&lt;a:lstStyle/&gt;</code> è¿™ä¸ªçš„æ„æ€æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ OpenXML SDK é‡Œé¢æœ‰è¿™ä¸ªå®šä¹‰ï¼Œè¯·çœ‹ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kt">var</span> <span class="n">textBodyListStyle</span> <span class="p">=</span> <span class="n">textBody</span><span class="p">.</span><span class="n">ListStyle</span><span class="p">;</span>
</code></pre></div></div>

<p>æˆ‘å‡†å¤‡äº†è¿™ä»½ç®€æ´çš„æ–‡æ¡£ï¼Œè¿™ä»½æ–‡æ¡£å°†éœ€è¦ç”¨åˆ°æœ¬æ–‡è¯´è®²åˆ°çš„å¤§éƒ¨åˆ†çŸ¥è¯†æ‰èƒ½è§£æå‡ºå®é™…çš„å­—ä½“æ˜¯å“ªä¸ªã€‚æœ¬æ–‡ç”¨çš„æµ‹è¯•æ–‡æ¡£æ”¾åœ¨ <a href="https://github.com/lindexi/lindexi_gd/tree/e1c54f474820d4fcfe91a81e8e6b3b07c8bec53a/GojolerbeeLerechelhajerefawwha">github</a> æ¬¢è¿å°ä¼™ä¼´ä¸‹è½½æµ‹è¯•ã€‚å¦å¤–æ¨è <a href="https://blog.lindexi.com/post/dotnet-OpenXML-%E8%A7%A3%E5%8E%8B%E7%BC%A9%E6%96%87%E6%A1%A3%E4%B8%BA%E6%96%87%E4%BB%B6%E5%A4%B9%E5%B7%A5%E5%85%B7.html">dotnetCampus.OfficeDocumentZipper</a> å·¥å…·ï¼Œè¿™ä¸ªå·¥å…·å¯ä»¥æ›´å¥½çš„ååŠ©å°ä¼™ä¼´æµ‹è¯•æ–‡æ¡£</p>

<p>æ•´ä¸ªæ–‡æœ¬çš„å®šä¹‰å¦‚ä¸‹</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;p:sp&gt;</span>
    <span class="nt">&lt;p:nvSpPr&gt;</span>
        <span class="nt">&lt;p:cNvPr</span> <span class="na">id=</span><span class="s">"4"</span> <span class="na">name=</span><span class="s">"æ–‡æœ¬æ¡† 3"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;p:cNvSpPr</span> <span class="na">txBox=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;p:nvPr/&gt;</span>
    <span class="nt">&lt;/p:nvSpPr&gt;</span>
    <span class="nt">&lt;p:spPr&gt;</span>
        <span class="nt">&lt;a:xfrm&gt;</span>
            <span class="nt">&lt;a:off</span> <span class="na">x=</span><span class="s">"4168346"</span> <span class="na">y=</span><span class="s">"914401"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;a:ext</span> <span class="na">cx=</span><span class="s">"3048000"</span> <span class="na">cy=</span><span class="s">"369332"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/a:xfrm&gt;</span>
        <span class="nt">&lt;a:prstGeom</span> <span class="na">prst=</span><span class="s">"rect"</span><span class="nt">&gt;&lt;/a:prstGeom&gt;</span>
    <span class="nt">&lt;/p:spPr&gt;</span>
    <span class="nt">&lt;p:txBody&gt;</span>
        <span class="nt">&lt;a:bodyPr</span> <span class="na">wrap=</span><span class="s">"square"</span> <span class="na">rtlCol=</span><span class="s">"0"</span><span class="nt">&gt;&lt;/a:bodyPr&gt;</span>
        <span class="nt">&lt;a:lstStyle/&gt;</span>
        <span class="nt">&lt;a:p&gt;</span>
            <span class="nt">&lt;a:r&gt;</span>
                <span class="nt">&lt;a:rPr</span> <span class="na">lang=</span><span class="s">"zh-CN"</span> <span class="na">altLang=</span><span class="s">"en-US"</span> <span class="na">smtClean=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;a:t&gt;</span>ä¸€è¡Œæ–‡æœ¬<span class="nt">&lt;/a:t&gt;</span>
            <span class="nt">&lt;/a:r&gt;</span>
            <span class="nt">&lt;a:endParaRPr</span> <span class="na">lang=</span><span class="s">"en-US"</span> <span class="na">dirty=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/a:p&gt;</span>
    <span class="nt">&lt;/p:txBody&gt;</span>
<span class="nt">&lt;/p:sp&gt;</span>
</code></pre></div></div>

<p>ä»ä¸Šé¢çš„å†…å®¹å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªæ”¾åœ¨å ä½ç¬¦çš„æ–‡æœ¬ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯æ”¾åœ¨å ä½ç¬¦çš„æ–‡æœ¬ï¼Ÿå¦‚æœ <code class="language-plaintext highlighter-rouge">&lt;p:nvPr/&gt;</code> æ²¡æœ‰å†…å®¹ï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºä¸æ˜¯å ä½ç¬¦çš„æ–‡æœ¬ã€‚è€Œå¦‚æœæ˜¯å ä½ç¬¦é‚£ä¹ˆ <code class="language-plaintext highlighter-rouge">p:nvpr</code> å°†ä¼šæ˜¯å¦‚ä¸‹æ ¼å¼</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="nt">&lt;p:nvpr&gt;</span>
            <span class="nt">&lt;p:ph</span> <span class="na">type=</span><span class="s">"ctrTitle"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;/p:ph&gt;</span>
        <span class="nt">&lt;/p:nvpr&gt;</span>
</code></pre></div></div>

<p>å¯¹äº å ä½ç¬¦ éœ€è¦é€šè¿‡ç»§æ‰¿å±æ€§æ·»åŠ æ›´å¤šå†…å®¹ï¼Œè¯·çœ‹ <a href="https://blog.lindexi.com/post/dotnet-OpenXML-SDK-%E6%96%87%E6%9C%AC%E5%8D%A0%E4%BD%8D%E7%AC%A6%E8%A7%A3%E6%9E%90.html">dotnet OpenXML SDK æ–‡æœ¬å ä½ç¬¦è§£æ</a></p>

<p>å½“ç„¶ï¼Œæœ¬æ–‡çš„ä¾‹å­ä¸æ˜¯å ä½ç¬¦æ˜¯æ¯”è¾ƒç®€å•çš„å…ƒç´ </p>

<p>ä½†æ˜¯è¿™ä¸ªå½¢çŠ¶æ²¡æœ‰ç»™ä¸€ä¸ªæ˜ç¡®çš„å­—ä½“ï¼Œé‚£ä¹ˆè¯·é—®è¿™ä¸ªå½¢çŠ¶ç”¨çš„å­—ä½“æ˜¯ä»€ä¹ˆï¼Ÿæ­¤æ—¶æ¶‰åŠåˆ°äº†ä¸€ä¸ªæ–‡æœ¬æ ·å¼ç­‰çº§çš„æ¦‚å¿µ</p>

<p>åœ¨æ–‡æ¡£é‡Œé¢æœ‰è¿™ä¸€å¥ä»£ç  <code class="language-plaintext highlighter-rouge">&lt;a:lstStyle/&gt;</code> è¡¨ç¤ºæ–‡æœ¬æœ¬èº«æ²¡æœ‰é‡æ–°å®šä¹‰æ ·å¼ç­‰çº§ï¼Œéœ€è¦ä¸€å±‚å±‚å¯»æ‰¾</p>

<p>å¯ä»¥åœ¨ Slide çš„ Layout å’Œ Slide çš„ Master æ‰¾åˆ°å¯¹åº”çš„ <code class="language-plaintext highlighter-rouge">p:txStyles</code> å†…å®¹ï¼Œä¸è¿‡æ ·å¼ç­‰çº§æ˜¯å¦å¤–çš„çŸ¥è¯†ç‚¹ï¼Œä¸åœ¨æœ¬æ–‡å›´å†…ã€‚å¯ä»¥å‘Šè¯‰å¤§å®¶çš„æ˜¯åœ¨è¿™ä»½æµ‹è¯•è¯¾ä»¶é‡Œé¢ï¼Œå…¶å® SlideLayout å’Œ SlideMaster çš„ <code class="language-plaintext highlighter-rouge">p:txStyles</code> éƒ½ä¸æ˜¯æ­¤æ–‡æœ¬çš„æ ·å¼ã€‚å› ä¸ºè¿™ä¸ªå…ƒç´ éœ€è¦çš„æ˜¯ <code class="language-plaintext highlighter-rouge">&lt;p:defaultTextStyle&gt;</code> é»˜è®¤æ–‡æœ¬æ ·å¼</p>

<p>é‚£ä¹ˆåœ¨å“ªå¯ä»¥æ‹¿åˆ° <code class="language-plaintext highlighter-rouge">&lt;p:defaultTextStyle&gt;</code> é»˜è®¤æ–‡æœ¬æ ·å¼ï¼Ÿè¿™æ˜¯æ–‡æ¡£å…¨å±€çš„è®¾ç½®ï¼Œå› æ­¤éœ€è¦åœ¨ Presentation.xml æ‹¿åˆ°ï¼Œå¯¹åº”çš„ OpenXML ä»£ç å¦‚ä¸‹</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">presentationDocument</span> <span class="p">=</span>
       <span class="n">DocumentFormat</span><span class="p">.</span><span class="n">OpenXml</span><span class="p">.</span><span class="n">Packaging</span><span class="p">.</span><span class="n">PresentationDocument</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="s">"æµ‹è¯•.pptx"</span><span class="p">,</span> <span class="k">false</span><span class="p">))</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">presentationPart</span> <span class="p">=</span> <span class="n">presentationDocument</span><span class="p">.</span><span class="n">PresentationPart</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">presentation</span> <span class="p">=</span> <span class="n">presentationPart</span><span class="p">.</span><span class="n">Presentation</span><span class="p">;</span>

    <span class="kt">var</span> <span class="n">defaultTextStyle</span> <span class="p">=</span> <span class="n">presentation</span><span class="p">.</span><span class="n">DefaultTextStyle</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>è¿™å°±æ˜¯ DefaultTextStyle çš„è·å–æ–¹æ³•ï¼Œä» Presentation ç±»çš„å±æ€§å®šä¹‰ä¹Ÿèƒ½äº†è§£åˆ°è¿™ä¸ªè§„åˆ™</p>

<p>äºæ˜¯æŒ‰ç…§è§„åˆ™ï¼Œé»˜è®¤å¦‚æœæ–‡æœ¬å­˜åœ¨ ListStyle é‚£ä¹ˆå°±ä½¿ç”¨æ–‡æœ¬è‡ªå·±çš„ï¼Œå¦åˆ™é‡‡ç”¨æ–‡æ¡£çº§çš„ã€‚å½“ç„¶ï¼Œå¦‚æœæ˜¯å ä½ç¬¦ç­‰å…ƒç´ ï¼Œé‚£å°±æ›´å¤æ‚äº†ï¼Œå’±å…ˆå¿½ç•¥</p>

<p>åœ¨è¿™ä»½è¯¾ä»¶é‡Œé¢æ–‡æœ¬å…ƒç´ æ²¡æœ‰è‡ªå·±çš„æ ·å¼é‡å†™ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢ä»£ç åˆ¤æ–­</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">defaultTextStyle</span> <span class="p">=</span> <span class="n">presentation</span><span class="p">.</span><span class="n">DefaultTextStyle</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">textBody</span> <span class="p">=</span> <span class="n">shape</span><span class="p">.</span><span class="n">TextBody</span><span class="p">;</span>

<span class="kt">var</span> <span class="n">textBodyListStyle</span> <span class="p">=</span> <span class="n">textBody</span><span class="p">.</span><span class="n">ListStyle</span><span class="p">;</span>

<span class="n">Debug</span><span class="p">.</span><span class="nf">Assert</span><span class="p">(</span><span class="n">textBodyListStyle</span><span class="p">.</span><span class="n">ChildElements</span><span class="p">.</span><span class="n">Count</span> <span class="p">==</span> <span class="m">0</span><span class="p">);</span>
</code></pre></div></div>

<p>è€Œ TextStyle å…¶å®å‡†ç¡®è¯´æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæœ‰ä» Level1 åˆ° Level9 çš„æ ·å¼ï¼Œé‚£ä¹ˆå¦‚ä½•çŸ¥é“ä½¿ç”¨å“ªä¸€ä¸ª</p>

<p>å…¶å®æ ·å¼åˆ—è¡¨é’ˆå¯¹çš„æ˜¯æ®µçº§çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ–‡æœ¬é‡Œé¢çš„å¤šä¸ªä¸åŒçš„æ®µè½å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ ·å¼ç­‰çº§ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">paragraph</span> <span class="p">=</span> <span class="n">textBody</span><span class="p">.</span><span class="n">Descendants</span><span class="p">&lt;</span><span class="n">Paragraph</span><span class="p">&gt;().</span><span class="nf">First</span><span class="p">();</span>
<span class="kt">var</span> <span class="n">level</span> <span class="p">=</span> <span class="n">paragraph</span><span class="p">.</span><span class="n">ParagraphProperties</span><span class="p">?.</span><span class="n">Level</span><span class="p">?.</span><span class="n">Value</span> <span class="p">??</span> <span class="m">1</span><span class="p">;</span>
<span class="n">Debug</span><span class="p">.</span><span class="nf">Assert</span><span class="p">(</span><span class="n">level</span> <span class="p">==</span> <span class="m">1</span><span class="p">);</span>
<span class="n">Debug</span><span class="p">.</span><span class="nf">Assert</span><span class="p">(</span><span class="n">paragraph</span><span class="p">.</span><span class="n">ParagraphProperties</span> <span class="p">==</span> <span class="k">null</span><span class="p">);</span>

<span class="kt">var</span> <span class="n">paragraphProperties</span> <span class="p">=</span> <span class="n">defaultTextStyle</span><span class="p">.</span><span class="n">Level1ParagraphProperties</span><span class="p">;</span>
</code></pre></div></div>

<p>è¿™æ˜¯æµ‹è¯•ä»£ç ï¼Œå› æ­¤ä»…è·å–ç¬¬ä¸€æ®µï¼Œè€ŒæŒ‰ç…§æµ‹è¯•çš„æ–‡æ¡£ï¼Œå¯ä»¥äº†è§£åˆ°æ­¤æ—¶çš„ level å°±æ˜¯ 1 åŒæ—¶æ–‡æœ¬æœ¬èº«æ²¡æœ‰é‡å†™æ ·å¼ï¼Œå› æ­¤ä½¿ç”¨çš„å°±æ˜¯ defaultTextStyle.Level1ParagraphProperties ä½œä¸ºæ®µè½æ ·å¼</p>

<p>æ–‡æœ¬çš„æ ·å¼æ®µè½é‡Œé¢åŒ…å«äº†æ®µè½çš„é»˜è®¤å±æ€§ï¼Œä¹Ÿå°±æ˜¯æ–‡æœ¬çš„ Run å¦‚æœæ²¡æœ‰å®šä¹‰å¦‚å­—ä½“ç­‰è¿™äº›å±æ€§ï¼Œå°†ä¼šä½¿ç”¨æ®µè½é»˜è®¤å±æ€§</p>

<p>å¯ä»¥ä½¿ç”¨ä¸‹é¢ä»£ç è·å–æ®µè½çš„æ–‡æœ¬</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">run</span> <span class="k">in</span> <span class="n">paragraph</span><span class="p">.</span><span class="n">Descendants</span><span class="p">&lt;</span><span class="n">Run</span><span class="p">&gt;())</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">runProperties</span> <span class="p">=</span> <span class="n">run</span><span class="p">.</span><span class="n">RunProperties</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">eastAsianFont</span> <span class="p">=</span> <span class="n">runProperties</span><span class="p">.</span><span class="n">GetFirstChild</span><span class="p">&lt;</span><span class="n">EastAsianFont</span><span class="p">&gt;();</span>
    <span class="n">Debug</span><span class="p">.</span><span class="nf">Assert</span><span class="p">(</span><span class="n">eastAsianFont</span> <span class="p">==</span> <span class="k">null</span><span class="p">);</span>
    <span class="c1">// å¿½ç•¥ä»£ç </span>
<span class="p">}</span>
</code></pre></div></div>

<p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œæµ‹è¯•æ–‡æ¡£æ˜¯ä¸å­˜åœ¨ EastAsianFont å­—ä½“çš„ï¼Œæ­¤æ—¶å°±éœ€è¦ç”¨åˆ° defaultTextStyle å®šä¹‰çš„å†…å®¹ï¼Œåœ¨å¼€å§‹å†™ä»£ç ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€ä¸‹åœ¨æ–‡æ¡£é‡Œé¢æ˜¯å¦‚ä½•å®šä¹‰çš„</p>

<p>åœ¨æµ‹è¯•æ–‡æ¡£é‡Œé¢çš„ Presentation.xml æ˜¯è¿™æ ·å®šä¹‰çš„ï¼Œè¿™ä»½æ–‡æ¡£æ”¾åœ¨ <a href="https://github.com/lindexi/lindexi_gd/tree/6f972af439c4daf91318fbda8d7bf6ac88a069de/GojolerbeeLerechelhajerefawwha/GojolerbeeLerechelhajerefawwha/æµ‹è¯•.pptx">github</a> æ¬¢è¿å°ä¼™ä¼´è§£å‹ç¼©</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
<span class="nt">&lt;p:presentation</span> <span class="na">xmlns:a=</span><span class="s">"http://schemas.openxmlformats.org/drawingml/2006/main"</span> <span class="na">xmlns:r=</span><span class="s">"http://schemas.openxmlformats.org/officeDocument/2006/relationships"</span> <span class="na">xmlns:p=</span><span class="s">"http://schemas.openxmlformats.org/presentationml/2006/main"</span> <span class="na">saveSubsetFonts=</span><span class="s">"1"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p:sldMasterIdLst&gt;</span>
        <span class="nt">&lt;p:sldMasterId</span> <span class="na">id=</span><span class="s">"2147483648"</span> <span class="na">r:id=</span><span class="s">"rId1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/p:sldMasterIdLst&gt;</span>
    <span class="nt">&lt;p:sldIdLst&gt;</span>
        <span class="nt">&lt;p:sldId</span> <span class="na">id=</span><span class="s">"256"</span> <span class="na">r:id=</span><span class="s">"rId2"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/p:sldIdLst&gt;</span>
    <span class="nt">&lt;p:sldSz</span> <span class="na">cx=</span><span class="s">"12192000"</span> <span class="na">cy=</span><span class="s">"6858000"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;p:notesSz</span> <span class="na">cx=</span><span class="s">"6858000"</span> <span class="na">cy=</span><span class="s">"9144000"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;p:defaultTextStyle&gt;</span>
        <span class="nt">&lt;a:defPPr&gt;</span>
            <span class="nt">&lt;a:defRPr</span> <span class="na">lang=</span><span class="s">"en-US"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/a:defPPr&gt;</span>
        <span class="nt">&lt;a:lvl1pPr</span> <span class="na">marL=</span><span class="s">"0"</span> <span class="na">algn=</span><span class="s">"l"</span> <span class="na">defTabSz=</span><span class="s">"914400"</span> <span class="na">rtl=</span><span class="s">"0"</span> <span class="na">eaLnBrk=</span><span class="s">"1"</span> <span class="na">latinLnBrk=</span><span class="s">"0"</span> <span class="na">hangingPunct=</span><span class="s">"1"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a:defRPr</span> <span class="na">sz=</span><span class="s">"1800"</span> <span class="na">kern=</span><span class="s">"1200"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;a:solidFill&gt;</span>
                    <span class="nt">&lt;a:schemeClr</span> <span class="na">val=</span><span class="s">"tx1"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/a:solidFill&gt;</span>
                <span class="nt">&lt;a:latin</span> <span class="na">typeface=</span><span class="s">"+mn-lt"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;a:ea</span> <span class="na">typeface=</span><span class="s">"æ—å¾·ç†™"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;a:cs</span> <span class="na">typeface=</span><span class="s">"+mn-cs"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/a:defRPr&gt;</span>
        <span class="nt">&lt;/a:lvl1pPr&gt;</span>
    <span class="nt">&lt;/p:defaultTextStyle&gt;</span>
    <span class="nt">&lt;p:extLst&gt;</span>
        <span class="nt">&lt;p:ext</span> <span class="na">uri=</span><span class="s">"{EFAFB233-063F-42B5-8137-9DF3F51BA10A}"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p15:sldGuideLst</span> <span class="na">xmlns:p15=</span><span class="s">"http://schemas.microsoft.com/office/powerpoint/2012/main"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/p:ext&gt;</span>
    <span class="nt">&lt;/p:extLst&gt;</span>
<span class="nt">&lt;/p:presentation&gt;</span>
</code></pre></div></div>

<p>ä¹Ÿè®¸çœ‹èµ·æ¥çš„é€»è¾‘æœ‰ç‚¹å¤æ‚ï¼Œä½†æ˜¯å®é™…éœ€è¦äº†è§£çš„é€»è¾‘å¦‚ä¸‹</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a:lvl1pPr</span> <span class="na">marL=</span><span class="s">"0"</span> <span class="na">algn=</span><span class="s">"l"</span> <span class="na">defTabSz=</span><span class="s">"914400"</span> <span class="na">rtl=</span><span class="s">"0"</span> <span class="na">eaLnBrk=</span><span class="s">"1"</span> <span class="na">latinLnBrk=</span><span class="s">"0"</span> <span class="na">hangingPunct=</span><span class="s">"1"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;a:defRPr</span> <span class="na">sz=</span><span class="s">"1800"</span> <span class="na">kern=</span><span class="s">"1200"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a:solidFill&gt;</span>
            <span class="nt">&lt;a:schemeClr</span> <span class="na">val=</span><span class="s">"tx1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/a:solidFill&gt;</span>
        <span class="nt">&lt;a:latin</span> <span class="na">typeface=</span><span class="s">"+mn-lt"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:ea</span> <span class="na">typeface=</span><span class="s">"æ—å¾·ç†™"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:cs</span> <span class="na">typeface=</span><span class="s">"+mn-cs"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/a:defRPr&gt;</span>
<span class="nt">&lt;/a:lvl1pPr&gt;</span>
</code></pre></div></div>

<p>æ­¤æ—¶çš„ paragraphProperties çš„æ•°æ®ï¼Œå°†æ˜¯ä¸Šé¢çš„å†…å®¹ï¼Œé»˜è®¤ä½¿ç”¨ Level1 çš„å±æ€§</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">paragraphProperties</span> <span class="p">=</span> <span class="n">defaultTextStyle</span><span class="p">.</span><span class="n">Level1ParagraphProperties</span><span class="p">;</span>
</code></pre></div></div>

<p>æ­¤æ—¶è·å–çš„æ–¹æ³•å¦‚ä¸‹é¢ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eastAsianFont</span> <span class="p">=</span> <span class="n">paragraphProperties</span><span class="p">.</span><span class="n">GetFirstChild</span><span class="p">&lt;</span><span class="n">DefaultRunProperties</span><span class="p">&gt;()</span>
    <span class="p">.</span><span class="n">GetFirstChild</span><span class="p">&lt;</span><span class="n">EastAsianFont</span><span class="p">&gt;();</span>

<span class="kt">var</span> <span class="n">typeface</span> <span class="p">=</span> <span class="n">eastAsianFont</span><span class="p">.</span><span class="n">Typeface</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>

<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"å­—ä½“æ˜¯ </span><span class="p">{</span><span class="n">typeface</span><span class="p">}</span><span class="s">"</span><span class="p">);</span> 

<span class="c1">// typeface == "æ—å¾·ç†™"</span>
</code></pre></div></div>

<p>å½“ç„¶ï¼Œå°ä¼™ä¼´å¦‚æœæ²¡æœ‰å»é˜…è¯» <a href="https://blog.lindexi.com/post/dotnet-OpenXML-%E6%96%87%E6%9C%AC%E5%AD%97%E4%BD%93%E7%9A%84%E9%80%89%E6%8B%A9%E8%A7%84%E5%88%99.html">dotnet OpenXML æ–‡æœ¬å­—ä½“çš„é€‰æ‹©è§„åˆ™</a> ä¹Ÿè®¸å°±ä¼šå¥½å¥‡ä¸ºä»€ä¹ˆæˆ‘è¿™é‡Œçš„ä»£ç åªè¯»å– EastAsianFont å­—ä½“ï¼Œè€Œå¿½ç•¥å…¶ä»–çš„å­—ä½“</p>

<!-- ![](image/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£1.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20208101411367386.jpg" alt="" /></p>

<p>ä»æœ¬æ–‡åˆ°å½“å‰åªæ˜¯åœ¨å‘Šè¯‰å¤§å®¶å¦‚ä½•æ‹¿åˆ°å¯¹çš„å­—ä½“å±æ€§ï¼Œå­—ä½“å±æ€§æ˜¯å¯¹äºæ–‡æœ¬æ®µ Run æ¥è¯´çš„ï¼Œè€Œä¸æ˜¯æ®µè½æˆ–æ–‡æœ¬çš„ã€‚ä½†æ˜¯å¦‚æœæ–‡æœ¬æ®µ Run ä¸å­˜åœ¨å­—ä½“çš„å®šä¹‰ï¼Œé‚£ä¹ˆæ­¤æ—¶éœ€è¦å°è¯•å»è·å–æ®µè½çš„é»˜è®¤å±æ€§å®šä¹‰ã€‚ä½†æ˜¯å¦‚æœæ®µè½æ²¡æœ‰ä»»ä½•é»˜è®¤å±æ€§å®šä¹‰ï¼Œå°±éœ€è¦è·å–æ–‡æ¡£çš„æ–‡æœ¬æ ·å¼å®šä¹‰</p>

<p>è¿™éƒ¨åˆ†é€»è¾‘å±äº PPT çš„é€»è¾‘ï¼Œæˆ‘åœ¨ ECMA 376 æ²¡æœ‰æ‰¾åˆ°ç›¸å…³çš„æè¿°ï¼Œä¹Ÿå°±æ˜¯è¿™éƒ¨åˆ†é€»è¾‘æ˜¯æ²¡æœ‰æ–‡æ¡£å®šä¹‰çš„ã€‚è¿™ä¹Ÿå°±æ˜¯ OpenXML SDK è¿™ä¸ªåº“æ²¡æœ‰æä¾›è·å–æ–‡æœ¬æœ€ç»ˆå±æ€§çš„æ–¹æ³•çš„åŸå› </p>

<p>å¦‚æœå°ä¼™ä¼´è®¤ä¸ºè¿™ä¹ˆç®€å•å°±è·å–åˆ°å­—ä½“äº†ï¼Œé‚£ä¹ˆåç­‰ä½ ä½¿ç”¨äº†ä¸€ä¸ªå« <code class="language-plaintext highlighter-rouge">+mn-ea</code> çš„å­—ä½“ã€‚ç­‰ç­‰ï¼Œè¿™æ˜¯ä¸€ä¸ªä»€ä¹ˆå­—ä½“ï¼Ÿå…¶å®è¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„å†™æ³•</p>

<p>åœ¨æ‰¾åˆ°å¯¹åº”çš„å­—ä½“å±æ€§çš„æ—¶å€™ï¼Œä¸ä¸€å®šæ‹¿åˆ°æœ€ç»ˆä½¿ç”¨çš„å­—ä½“ï¼Œå¦‚æœåˆ¤æ–­æ˜¯ <code class="language-plaintext highlighter-rouge">+mn-ea</code> çš„æ ¼å¼ï¼Œé‚£ä¹ˆå°±éœ€è¦å†è¿›ä¸€æ­¥çš„è½¬æ¢</p>

<p>é¦–å…ˆåˆ¤æ–­çš„æ­£åˆ™ä»£ç å¦‚ä¸‹ï¼Œå¦‚æœè¿™ä¸ªä»£ç å†™é”™äº†ï¼Œè¿˜è¯·å°ä¼™ä¼´å‘Šè¯‰æˆ‘</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">Regex</span> <span class="n">ThemeFontTypePattern</span> <span class="p">=</span>
            <span class="k">new</span> <span class="nf">Regex</span><span class="p">(</span><span class="s">@"(^\+(mn|mj)\-(lt|cs|ea)$)"</span><span class="p">,</span> <span class="n">RegexOptions</span><span class="p">.</span><span class="n">Compiled</span><span class="p">);</span>
</code></pre></div></div>

<p>è¿™ä¸ªå®šä¹‰çš„æ–¹å¼æ˜¯ FontScheme çš„å®šä¹‰ï¼Œéœ€è¦å…ˆè§£æè¿™ä¸ªå­—ç¬¦ä¸²æ‰èƒ½äº†è§£</p>

<p>æŒ‰ç…§å®šä¹‰ï¼Œéœ€è¦å°†è¿™ä¸ªå­—ç¬¦ä¸²åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªå°±æ˜¯ <code class="language-plaintext highlighter-rouge">+mn</code> å¦ä¸€ä¸ªå°±æ˜¯ <code class="language-plaintext highlighter-rouge">-ea</code> ä¸¤ä¸ªéƒ¨åˆ†</p>

<p>å‰é¢éƒ¨åˆ†è¡¨ç¤ºå¦‚ä¸‹</p>

<ul>
  <li>mnï¼šMinorFont</li>
  <li>mjï¼šMajorFont</li>
</ul>

<p>åé¢çš„æšä¸¾è¡¨ç¤ºå¦‚ä¸‹</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">public</span> <span class="k">enum</span> <span class="n">FontLang</span>
    <span class="p">{</span>
        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// lt</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="n">LatinFont</span><span class="p">,</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// ea</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="n">EastAsianFont</span><span class="p">,</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// cs </span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="n">ComplexScriptFont</span><span class="p">,</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// sym</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="n">SymbolFont</span><span class="p">,</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">///  ä¸çŸ¥é“å“ªä¸ªè¯­è¨€</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="n">Unknown</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>é‚£ä¹ˆ MinorFont å’Œ MajorFont æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿå…¶å®å°±æ˜¯æ­£æ–‡å’Œæ ‡é¢˜çš„æç¤ºï¼Œå°ä¼™ä¼´å¯ä»¥åœ¨ PPT çš„å­—ä½“çœ‹åˆ°æœ‰æ‹¬å·å†™çš„æ ‡é¢˜å’Œæ­£æ–‡ï¼Œå°±æ˜¯å¯¹åº”çš„è¿™ä¸¤ä¸ªå±æ€§çš„å«ä¹‰</p>

<!-- ![](image/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£2.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F2020810150571943.jpg" alt="" /></p>

<p>è¿™ä¸ªä¸»é¢˜å¯ä»¥å¦‚ä½•è·å–ï¼Ÿè¯·çœ‹ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">private</span> <span class="k">static</span> <span class="n">FontScheme</span> <span class="nf">GetFontScheme</span><span class="p">(</span><span class="n">SlidePart</span> <span class="n">slidePart</span><span class="p">)</span>
 <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">slidePart</span><span class="p">.</span><span class="n">ThemeOverridePart</span><span class="p">?.</span><span class="n">ThemeOverride</span><span class="p">?.</span><span class="n">FontScheme</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">slidePart</span><span class="p">.</span><span class="n">ThemeOverridePart</span><span class="p">.</span><span class="n">ThemeOverride</span><span class="p">.</span><span class="n">FontScheme</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">var</span> <span class="n">slideLayoutPart</span> <span class="p">=</span> <span class="n">slidePart</span><span class="p">.</span><span class="n">SlideLayoutPart</span><span class="p">;</span>

    <span class="c1">//ä»SlideLayoutè·å–theme</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">slideLayoutPart</span><span class="p">.</span><span class="n">ThemeOverridePart</span><span class="p">?.</span><span class="n">ThemeOverride</span><span class="p">?.</span><span class="n">FontScheme</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">slideLayoutPart</span><span class="p">.</span><span class="n">ThemeOverridePart</span><span class="p">.</span><span class="n">ThemeOverride</span><span class="p">.</span><span class="n">FontScheme</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">var</span> <span class="n">slideMasterPart</span> <span class="p">=</span> <span class="n">slideLayoutPart</span><span class="p">.</span><span class="n">SlideMasterPart</span><span class="p">;</span>

    <span class="c1">//ä»SlideMasterè·å–theme</span>
    <span class="k">return</span> <span class="n">slideMasterPart</span><span class="p">?.</span><span class="n">ThemePart</span><span class="p">?.</span><span class="n">Theme</span><span class="p">?.</span><span class="n">ThemeElements</span><span class="p">?.</span><span class="n">FontScheme</span><span class="p">;</span>
 <span class="p">}</span>
</code></pre></div></div>

<p>è¯·å°ä¼™ä¼´æ¢ä¸€ä»½æµ‹è¯•è¯¾ä»¶ç”¨æ¥æµ‹è¯•é€»è¾‘ï¼Œæµ‹è¯•çš„è¯¾ä»¶æ”¾åœ¨ <a href="https://github.com/lindexi/lindexi_gd/tree/75bc1ef8d1cff8c334015b3b184cd19ddddd5f28/GojolerbeeLerechelhajerefawwha/GojolerbeeLerechelhajerefawwha/æµ‹è¯•.pptx">github</a> è¿™ä»½è¯¾ä»¶æ›´æ”¹äº† Presentation.xml å®šä¹‰ä¸ºä¸‹é¢ä»£ç </p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a:lvl1pPr</span> <span class="na">marL=</span><span class="s">"0"</span> <span class="na">algn=</span><span class="s">"l"</span> <span class="na">defTabSz=</span><span class="s">"914400"</span> <span class="na">rtl=</span><span class="s">"0"</span> <span class="na">eaLnBrk=</span><span class="s">"1"</span> <span class="na">latinLnBrk=</span><span class="s">"0"</span> <span class="na">hangingPunct=</span><span class="s">"1"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;a:defRPr</span> <span class="na">sz=</span><span class="s">"1800"</span> <span class="na">kern=</span><span class="s">"1200"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a:solidFill&gt;</span>
            <span class="nt">&lt;a:schemeClr</span> <span class="na">val=</span><span class="s">"tx1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/a:solidFill&gt;</span>
        <span class="nt">&lt;a:latin</span> <span class="na">typeface=</span><span class="s">"+mn-lt"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:ea</span> <span class="na">typeface=</span><span class="s">"+mn-ea"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:cs</span> <span class="na">typeface=</span><span class="s">"+mn-cs"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/a:defRPr&gt;</span>
<span class="nt">&lt;/a:lvl1pPr&gt;</span>
</code></pre></div></div>

<p>å¯ä»¥çœ‹åˆ°çš„æ˜¯åŸæœ¬æ˜¯æœ‰å…·ä½“çš„å­—ä½“çš„ <code class="language-plaintext highlighter-rouge">a:ea</code> è¢«æ›´æ”¹ä¸º <code class="language-plaintext highlighter-rouge">a:ea typeface="+mn-ea"</code> éœ€è¦ä½¿ç”¨ FontScheme æ‰¾åˆ°å¯¹åº”çš„é€»è¾‘</p>

<p>åœ¨è¿™ä»½æµ‹è¯•è¯¾ä»¶é‡Œé¢ï¼Œå…¶å®åªæœ‰ Theme1.xml æ–‡ä»¶æ‰æœ‰å®é™…çš„å®šä¹‰ï¼Œä¹Ÿå°±æ˜¯ <code class="language-plaintext highlighter-rouge">slideMasterPart?.ThemePart?.Theme?.ThemeElements?.FontScheme</code> æ‰æœ‰è¿”å›å€¼</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="n">ThemeFontTypePattern</span><span class="p">.</span><span class="nf">IsMatch</span><span class="p">(</span><span class="n">typeface</span><span class="p">))</span>
<span class="p">{</span>
    <span class="c1">// è¿›å…¥è¿™ä¸ªåˆ†æ”¯ï¼Œå­—ä½“æ˜¯ +mn-ea å­—ä½“</span>
    <span class="c1">// è¿™ä¸ªå­—ä½“çš„æ„æ€é‡Œé¢ mn è¡¨ç¤º Body å­—ä½“</span>
    <span class="c1">// è€Œ mj è¡¨ç¤º Title å­—ä½“ï¼Œä¹Ÿå°±æ˜¯ Major å­—ä½“</span>
    <span class="c1">// åç»­çš„ ea å’Œ lt ç­‰è¡¨ç¤ºé‡‡ç”¨ä¸œäºšæ–‡å­—æˆ–æ‹‰ä¸æ–‡ç­‰</span>
    <span class="c1">// æ­¤æ—¶éœ€è¦è·å–å­—ä½“ä¸»é¢˜</span>
    <span class="kt">var</span> <span class="n">fontScheme</span> <span class="p">=</span> <span class="nf">GetFontScheme</span><span class="p">(</span><span class="n">slidePart</span><span class="p">);</span>
    <span class="n">FontCollectionType</span> <span class="n">fontCollection</span><span class="p">;</span>

    <span class="c1">// mn çš„ n ä¼ å…¥å­—ç¬¦ä¸²æ˜¯ +mn-ea ä¹Ÿå°±æ˜¯ç¬¬ä¸‰ä¸ªå­—ç¬¦</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">typeface</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="p">==</span> <span class="sc">'n'</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">fontCollection</span> <span class="p">=</span> <span class="n">fontScheme</span><span class="p">.</span><span class="n">MinorFont</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">fontCollection</span> <span class="p">=</span> <span class="n">fontScheme</span><span class="p">.</span><span class="n">MajorFont</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// å¿½ç•¥ä»£ç </span>
<span class="p">}</span>
</code></pre></div></div>

<p>æŒ‰ç…§æœ¬æ–‡çš„é€»è¾‘ï¼Œä¸‹ä¸€æ­¥éœ€è¦è§£ææ˜¯å…·ä½“çš„è¯­è¨€</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="n">FontLang</span> <span class="n">fontLang</span> <span class="p">=</span> <span class="n">FontLang</span><span class="p">.</span><span class="n">Unknown</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">typeface</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"lt"</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">fontLang</span> <span class="p">=</span> <span class="n">FontLang</span><span class="p">.</span><span class="n">LatinFont</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">typeface</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"cs"</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">fontLang</span> <span class="p">=</span> <span class="n">FontLang</span><span class="p">.</span><span class="n">ComplexScriptFont</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">typeface</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"ea"</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">fontLang</span> <span class="p">=</span> <span class="n">FontLang</span><span class="p">.</span><span class="n">EastAsianFont</span><span class="p">;</span>
    <span class="p">}</span>

</code></pre></div></div>

<p>åœ¨å¼€å§‹è¯»å–å­—ä½“ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€ä¸‹ Theme1.xml æ–‡ä»¶çš„å®šä¹‰</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a:fontScheme</span> <span class="na">name=</span><span class="s">"Office"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;a:majorFont&gt;</span>
        <span class="nt">&lt;a:latin</span> <span class="na">typeface=</span><span class="s">"Calibri Light"</span> <span class="na">panose=</span><span class="s">"020F0302020204030204"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:ea</span> <span class="na">typeface=</span><span class="s">""</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:cs</span> <span class="na">typeface=</span><span class="s">""</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Jpan"</span> <span class="na">typeface=</span><span class="s">"ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Hang"</span> <span class="na">typeface=</span><span class="s">"ë§‘ì€ ê³ ë”•"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Hans"</span> <span class="na">typeface=</span><span class="s">"å®‹ä½“"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Hant"</span> <span class="na">typeface=</span><span class="s">"æ–°ç´°æ˜é«”"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/a:majorFont&gt;</span>
    <span class="nt">&lt;a:minorFont&gt;</span>
        <span class="nt">&lt;a:latin</span> <span class="na">typeface=</span><span class="s">"Calibri"</span> <span class="na">panose=</span><span class="s">"020F0502020204030204"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:ea</span> <span class="na">typeface=</span><span class="s">""</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:cs</span> <span class="na">typeface=</span><span class="s">""</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Jpan"</span> <span class="na">typeface=</span><span class="s">"ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Hang"</span> <span class="na">typeface=</span><span class="s">"ë§‘ì€ ê³ ë”•"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Hans"</span> <span class="na">typeface=</span><span class="s">"é€—æ¯”"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Hant"</span> <span class="na">typeface=</span><span class="s">"æ–°ç´°æ˜é«”"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/a:minorFont&gt;</span>
<span class="nt">&lt;/a:fontScheme&gt;</span>
</code></pre></div></div>

<p>å½“ç„¶ä¹Ÿè®¸ä½ ä¼šå‘ç°æ­¤æ—¶çš„ typeface ä¸æ˜¯æŸä¸ªå­—ä½“æˆ– â€œmn-ltâ€ ç­‰ï¼Œè€Œæ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚æ­¤æ—¶å°±éœ€è¦ç”¨åˆ° Theme Font Languagesï¼ˆThemeFontLang ECMA-376 17.15.1.88ï¼‰çš„åŠŸèƒ½äº†</p>

<p>è¯·é—®æ­¤æ—¶çš„å­—ä½“æ˜¯ä»€ä¹ˆï¼Ÿ</p>

<!-- ![](image/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£3.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20208101516112418.jpg" alt="" /></p>

<p>ä¸ºä»€ä¹ˆæ˜¯è¯»å– <code class="language-plaintext highlighter-rouge">&lt;a:font script="Hans" typeface="é€—æ¯”"/&gt;</code> ä½œä¸ºå­—ä½“çš„ï¼ŸåŸå› å°±æ˜¯éœ€è¦å…ˆåˆ¤æ–­è¯­è¨€</p>

<p>å°ä¼™ä¼´æ˜¯å¦è¿˜è®°å¾—åœ¨ Run çš„å±æ€§å®šä¹‰</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a:p&gt;</span>
    <span class="nt">&lt;a:r&gt;</span>
        <span class="nt">&lt;a:rPr</span> <span class="na">lang=</span><span class="s">"zh-CN"</span> <span class="na">altLang=</span><span class="s">"en-US"</span> <span class="na">sz=</span><span class="s">"2000"</span> <span class="na">smtClean=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:t&gt;</span>ä¸€è¡Œæ–‡æœ¬<span class="nt">&lt;/a:t&gt;</span>
    <span class="nt">&lt;/a:r&gt;</span>
    <span class="nt">&lt;a:endParaRPr</span> <span class="na">lang=</span><span class="s">"en-US"</span> <span class="na">dirty=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/a:p&gt;</span>
</code></pre></div></div>

<p>è¿™é‡Œæœ‰ä¸€ä¸ªå±æ€§ <code class="language-plaintext highlighter-rouge">lang</code> æ˜¯ä»€ä¹ˆä½œç”¨ï¼Ÿå…¶å®å°±æ˜¯ç”¨æ¥å†³å®šä½¿ç”¨é‚£ä¸ª Script å¯¹åº”çš„å­—ä½“çš„</p>

<p>è€Œ zh-CN å’Œ Hans æœ‰ä»€ä¹ˆå…³ç³»ï¼Œè¿™ä¸ªæ˜¯åœ¨ <a href="https://tools.ietf.org/html/rfc4646">RFC 4646</a> æ ‡å‡†å®šä¹‰çš„ï¼Œå¯ä»¥æ ¹æ®è¯­è¨€æ‹¿åˆ°ã€‚å…³äº zh-CN è¿™ä¸ªè¯­è¨€æ ¼å¼çš„æ ‡å‡†ï¼Œè¯·çœ‹ <a href="https://tools.ietf.org/html/bcp47">BCP47</a> æ ‡å‡†</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetScript</span><span class="p">(</span><span class="n">StringValue</span> <span class="n">language</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">language</span> <span class="p">==</span> <span class="s">"zh-CN"</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="s">"Hans"</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">language</span> <span class="p">==</span> <span class="s">"zh-Hant"</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="s">"Hant"</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// é»˜è®¤å€¼ï¼Œå½“ç„¶ï¼Œåœ¨ Office é‡Œé¢çš„é€»è¾‘æ˜¯ååˆ†å¤šçš„ï¼Œéœ€è¦æ ¹æ® [å›½å®¶-åœ°åŒºå­—ç¬¦ä¸²](https://docs.microsoft.com/zh-CN/cpp/c-runtime-library/country-region-strings?view=vs-2019 ) æ–‡æ¡£å†™ä»£ç ï¼Œåªæ˜¯è¿™éƒ¨åˆ†ä»£ç ä¸æ˜¯æœ¬æ–‡é‡ç‚¹</span>
            <span class="k">return</span> <span class="s">"Hans"</span><span class="p">;</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>ä¸Šé¢æ˜¯ç®€å•çš„é€»è¾‘ï¼Œæ›´å¤šä»£ç å°±éœ€è¦ä½ å»é€šè¿‡ <a href="https://tools.ietf.org/html/rfc4646">RFC 4646</a> æ ‡å‡†å»å†™ä»£ç äº†</p>

<p>åœ¨ä½¿ç”¨ GetScript è¿”å›äº† scriptTag å­—ç¬¦ä¸²ä¹‹åï¼Œå°±å¯ä»¥åœ¨ FontCollectionType éå†è·å–å­—ä½“</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       <span class="k">private</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetFontFromFontCollection</span><span class="p">(</span><span class="kt">string</span> <span class="n">scriptTag</span><span class="p">,</span> <span class="n">FontLang</span> <span class="n">themeTypefaceFontLang</span><span class="p">,</span>
            <span class="n">FontCollectionType</span> <span class="n">fontCollection</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">fontCollection</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// å‡å®šå­˜åœ¨å¯¹åº”çš„è¯­è¨€çš„å­—ä½“ï¼Œé‚£ä¹ˆè·å–å¯¹åº”çš„å­—ä½“</span>
            <span class="c1">// å­˜æ”¾æ–¹å¼å¦‚</span>
            <span class="cm">/*
            &lt;a:majorFont xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"&gt;
                &lt;a:latin typeface="Calibri Light" panose="020F0302020204030204" /&gt;
                &lt;a:ea typeface="" /&gt;
                &lt;a:cs typeface="" /&gt;
                &lt;a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯" /&gt;
                &lt;a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•" /&gt;
                &lt;a:font script="Hans" typeface="å®‹ä½“" /&gt;
            &lt;/a:majorFont&gt;
            &lt;a:minorFont xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"&gt;
                &lt;a:latin typeface="Calibri" panose="020F0502020204030204" /&gt;
                &lt;a:ea typeface="" /&gt;
                &lt;a:cs typeface="" /&gt;
                &lt;a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯" /&gt;
                &lt;a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•" /&gt;
                &lt;a:font script="Hans" typeface="å®‹ä½“" /&gt;
            &lt;/a:minorFont&gt;
             */</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">font</span> <span class="k">in</span> <span class="n">fontCollection</span><span class="p">.</span><span class="n">Elements</span><span class="p">&lt;</span><span class="n">SupplementalFont</span><span class="p">&gt;())</span>
            <span class="p">{</span>
                <span class="c1">// &lt;a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•" /&gt;</span>
                <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span><span class="n">font</span><span class="p">.</span><span class="n">Script</span><span class="p">,</span> <span class="n">scriptTag</span><span class="p">,</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">OrdinalIgnoreCase</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="k">return</span> <span class="n">font</span><span class="p">.</span><span class="n">Typeface</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="c1">// å¿½ç•¥ä»£ç </span>
        <span class="p">}</span>
</code></pre></div></div>

<p>æ­¤æ—¶çš„ä»£ç æ”¾åœ¨ <a href="https://github.com/lindexi/lindexi_gd/tree/a7b375da3ff6d0511ba7b064686eed4ba71aef5d/GojolerbeeLerechelhajerefawwha">github</a> æ¬¢è¿å°ä¼™ä¼´è®¿é—®ï¼Œæ­¤æ—¶å°±èƒ½æ‹¿åˆ°å­—ä½“</p>

<p>å¦‚æœæ­¤æ—¶çš„ Theme1.xml å®šä¹‰æ˜¯å¦‚ä¸‹å‘¢</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a:minorFont&gt;</span>
    <span class="nt">&lt;a:latin</span> <span class="na">typeface=</span><span class="s">"Calibri"</span> <span class="na">panose=</span><span class="s">"020F0502020204030204"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:ea</span> <span class="na">typeface=</span><span class="s">"æ—å¾·ç†™"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:cs</span> <span class="na">typeface=</span><span class="s">""</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Jpan"</span> <span class="na">typeface=</span><span class="s">"ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Hang"</span> <span class="na">typeface=</span><span class="s">"ë§‘ì€ ê³ ë”•"</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- &lt;a:font script="Hans" typeface="é€—æ¯”"/&gt;--&gt;</span>
<span class="nt">&lt;/a:minorFont&gt;</span>
</code></pre></div></div>

<p>ä¹Ÿå°±æ˜¯ font çš„ script æ˜¯ Hans çš„å®šä¹‰æ˜¯ä¸å­˜åœ¨çš„ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿæ­¤æ—¶çš„è§„åˆ™å°±æ˜¯ FontLang å¯¹åº”çš„å†…å®¹</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="c1">// ä¹Ÿå°±æ˜¯å…ˆå°è¯•è·å–è¯­è¨€æ–‡åŒ–çš„ï¼Œå¦‚æœè·å–ä¸åˆ°ï¼Œå°±é‡‡ç”¨å¯¹åº”è¯­è¨€çš„</span>
            <span class="n">TextFontType</span> <span class="n">textFont</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
            <span class="k">switch</span> <span class="p">(</span><span class="n">themeTypefaceFontLang</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">case</span> <span class="n">FontLang</span><span class="p">.</span><span class="n">LatinFont</span><span class="p">:</span>
                    <span class="n">textFont</span> <span class="p">=</span> <span class="n">fontCollection</span><span class="p">.</span><span class="n">LatinFont</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="n">FontLang</span><span class="p">.</span><span class="n">EastAsianFont</span><span class="p">:</span>
                    <span class="n">textFont</span> <span class="p">=</span> <span class="n">fontCollection</span><span class="p">.</span><span class="n">EastAsianFont</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="n">FontLang</span><span class="p">.</span><span class="n">ComplexScriptFont</span><span class="p">:</span>
                    <span class="n">textFont</span> <span class="p">=</span> <span class="n">fontCollection</span><span class="p">.</span><span class="n">ComplexScriptFont</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="n">FontLang</span><span class="p">.</span><span class="n">SymbolFont</span><span class="p">:</span>
                    <span class="c1">// ç‰¹åˆ«ä¸å¤„ç†ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</span>
                    <span class="c1">// åœ¨ fontCollection æ˜¯ä¸å­˜åœ¨çš„ SymbolFont çš„</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">default</span><span class="p">:</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentOutOfRangeException</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">themeTypefaceFontLang</span><span class="p">),</span> <span class="n">themeTypefaceFontLang</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="kt">var</span> <span class="n">typeface</span> <span class="p">=</span> <span class="n">textFont</span><span class="p">?.</span><span class="n">Typeface</span><span class="p">?.</span><span class="n">Value</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">typeface</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">typeface</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">Debug</span><span class="p">.</span><span class="nf">Assert</span><span class="p">(</span><span class="k">false</span><span class="p">,</span> <span class="s">"æ‰¾ä¸åˆ°å­—ä½“"</span><span class="p">);</span>

            <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
</code></pre></div></div>

<p>å…¶å®è¿™ä¸ªæ‰¾ä¸åˆ°å­—ä½“ <code class="language-plaintext highlighter-rouge">Debug.Assert(false, "æ‰¾ä¸åˆ°å­—ä½“")</code> çš„è¾“å‡ºä¹Ÿä¸å…¨å¯¹ï¼Œå¦‚æœ Theme1.xml å®šä¹‰æ˜¯å¦‚ä¸‹</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a:minorFont&gt;</span>
    <span class="nt">&lt;a:latin</span> <span class="na">typeface=</span><span class="s">"csdn"</span> <span class="na">panose=</span><span class="s">"020F0502020204030204"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:ea</span> <span class="na">typeface=</span><span class="s">""</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:cs</span> <span class="na">typeface=</span><span class="s">""</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Jpan"</span> <span class="na">typeface=</span><span class="s">"ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Hang"</span> <span class="na">typeface=</span><span class="s">"ë§‘ì€ ê³ ë”•"</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- &lt;a:font script="Hans" typeface="é€—æ¯”"/&gt;--&gt;</span>
<span class="nt">&lt;/a:minorFont&gt;</span>
</code></pre></div></div>

<p>ä¹Ÿå°±æ˜¯ Hans æ²¡æœ‰è¿™ä¸ªå®šä¹‰ï¼Œè€Œ ea ä¹Ÿæ²¡æœ‰å€¼ï¼Œæ­¤æ—¶å°†ä¼šé™çº§ä½¿ç”¨ latin çš„å­—ä½“</p>

<!-- ![](image/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£4.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20208101529131539.jpg" alt="" /></p>

<p>å¦‚æœ latin ä¹Ÿæ²¡æœ‰å†…å®¹å‘¢ï¼Ÿå°†ä½¿ç”¨æœ¬æœºçš„é»˜è®¤è¯­è¨€å­—ä½“</p>

<p>ä½†å°ä¼™ä¼´æ˜¯å¦è§‰å¾—ä¸Šé¢è¿˜æœ‰ä¸€ä¸ªæ²¡æœ‰ç”¨åˆ°çš„å±æ€§ï¼Œæ²¡é”™å°±æ˜¯ altLang è¿™ä¸ªå±æ€§</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a:p&gt;</span>
    <span class="nt">&lt;a:r&gt;</span>
        <span class="nt">&lt;a:rPr</span> <span class="na">lang=</span><span class="s">"zh-CN"</span> <span class="na">altLang=</span><span class="s">"en-US"</span> <span class="na">sz=</span><span class="s">"2000"</span> <span class="na">smtClean=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:t&gt;</span>ä¸€è¡Œæ–‡æœ¬<span class="nt">&lt;/a:t&gt;</span>
    <span class="nt">&lt;/a:r&gt;</span>
    <span class="nt">&lt;a:endParaRPr</span> <span class="na">lang=</span><span class="s">"en-US"</span> <span class="na">dirty=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/a:p&gt;</span>
</code></pre></div></div>

<p>è¿™ä¸ªå±æ€§æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Ÿè¿™æ˜¯ä¸€ä¸ªå¤‡ç”¨çš„å±æ€§ï¼ŒæŒ‰ç…§ ECMA-376 çš„ 21.1.2.3.2 defRPr (Default Text Run Properties) è¿™ä¸€ç« çš„æè¿°ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤‡ç”¨çš„å±æ€§ï¼Œé»˜è®¤æ˜¯ä¸å†™çš„ï¼Œä¸å†™çš„æ—¶å€™å°†ä¼šä½¿ç”¨ lang å±æ€§ã€‚è¿™ä¸ªå±æ€§å¯ä»¥ç”¨æ¥æ˜¾ç¤ºç•Œé¢æ§ä»¶æ—¶ä½¿ç”¨çš„å¤‡ç”¨è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯åœ¨ lang æ‰¾ä¸åˆ°è¯­è¨€çš„æ—¶å€™ï¼Œéœ€è¦å¯ç”¨ altLang å±æ€§å»è·å–</p>

<p>è€Œå®é™…ä¸Šæœ¬æ–‡çš„è§„åˆ™ä¸»è¦é’ˆå¯¹ PPT è€Œä¸æ˜¯ OpenXML çš„ ECMA-376 çš„æ ‡å‡†ï¼Œå› ä¸ºå®é™…ä¸Š PPT æœ‰äº›è¡Œä¸ºå’Œ ECMA-376 ä¸ç›¸åŒï¼Œæˆ–è€…è¯´æˆ‘æ²¡æœ‰ç†è§£å¯¹ ECMA-376 çš„æ„æ€ã€‚è€Œè¿™éƒ¨åˆ†ä¹Ÿæ˜¯ OpenXML SDK æ²¡æœ‰æä¾›æ¥å£æ–¹æ³•çš„</p>

<p>ä»¥ä¸‹æ˜¯ ECMA-376 çš„åŸæ–‡</p>

<p>17.15.1.88 ThemeFontLang (Theme Font Languages)</p>

<p>These mappings are performed as follows:</p>

<ul>
  <li>For majorAscii/majorHAnsi, locate the font element (Â§20.1.4.1.16) in the majorFont element (Â§20.1.4.1.24) in the theme part for the language specified by the val attribute</li>
  <li>For majorBidi,             locate the font element                in the majorFont element               in the theme part for the language specified by the bidi attribute</li>
  <li>For majorEastAsia,         locate the font element                in the majorFont element               in the theme part for the language specified by the eastAsia attribute</li>
  <li>For minorAscii/minorHAnsi, locate the font element in the minorFont element (Â§20.1.4.1.25) in the theme part for the language specified by the val attribute</li>
  <li>For minorBidi, locate the font element in the minorFont element in the theme part for the language specified by the bidi attribute</li>
  <li>For minorEastAsia,         locate the font element                in the minorFont element in the theme part for the language specified by the eastAsia attribute</li>
</ul>

<p>If this element is omitted, then the default fonts for each region as specified by the latin, ea, and cs elements (Â§21.1.2.3.7; Â§21.1.2.3.3; Â§21.1.2.3.1) should be used</p>

<p>ä¸è¿‡ PPT æ²¡æœ‰æŒ‰ç…§æ–‡æ¡£åš</p>

<p>ä¸ä¿¡ä½ è¯•è¯• MinorAscii çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯ Latin å­—ç¬¦å®é™…ä¸Šæ˜¯ä¸éµå®ˆä¸Šé¢çš„è§„å®šçš„ã€‚è¿”å›çš„æ˜¯ Theme çš„ latin å­—ä½“</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a:p&gt;</span>
    <span class="nt">&lt;a:r&gt;</span>
        <span class="nt">&lt;a:rPr</span> <span class="na">lang=</span><span class="s">"ja-JP"</span> <span class="na">altLang=</span><span class="s">"en-US"</span> <span class="na">sz=</span><span class="s">"2000"</span> <span class="na">smtClean=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;a:t&gt;</span>lindexi<span class="nt">&lt;/a:t&gt;</span>
    <span class="nt">&lt;/a:r&gt;</span>
    <span class="nt">&lt;a:endParaRPr</span> <span class="na">lang=</span><span class="s">"en-US"</span> <span class="na">dirty=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/a:p&gt;</span>

<span class="nt">&lt;a:minorFont&gt;</span>
    <span class="nt">&lt;a:latin</span> <span class="na">typeface=</span><span class="s">"Wingdings"</span> <span class="na">panose=</span><span class="s">"020F0502020204030204"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:ea</span> <span class="na">typeface=</span><span class="s">""</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:cs</span> <span class="na">typeface=</span><span class="s">""</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Jpan"</span> <span class="na">typeface=</span><span class="s">"å¾®è½¯é›…é»‘"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Hang"</span> <span class="na">typeface=</span><span class="s">"ë§‘ì€ ê³ ë”•"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a:font</span> <span class="na">script=</span><span class="s">"Hans"</span> <span class="na">typeface=</span><span class="s">"é€—æ¯”"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/a:minorFont&gt;</span>
</code></pre></div></div>

<!-- ![](image/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£/dotnet OpenXML è§£æ PPT æ–‡æœ¬å­—ä½“è·å–è¯¦è§£5.png) -->

<p><img src="http://image.acmx.xyz/lindexi%2F20208101837395865.jpg" alt="" /></p>

<p>å¯ä»¥çœ‹åˆ°è‹±æ–‡å­—ç¬¦ç”¨çš„æ˜¯ <code class="language-plaintext highlighter-rouge">a:latin</code> çš„ï¼Œè€Œä¸æ˜¯ä½¿ç”¨è¯­è¨€çš„</p>

<p>æ›´å¤šè¯·çœ‹ <a href="https://blog.lindexi.com/post/Office-%E4%BD%BF%E7%94%A8-OpenXML-SDK-%E8%A7%A3%E6%9E%90%E6%96%87%E6%A1%A3%E5%8D%9A%E5%AE%A2%E7%9B%AE%E5%BD%95.html">Office ä½¿ç”¨ OpenXML SDK è§£ææ–‡æ¡£åšå®¢ç›®å½•</a></p>

<p><a href="http://www.brandwares.com/bestpractices/2017/02/xml-hacking-font-themes-complete/">OOXML Hacking: Font Themes Complete - Brandwares</a></p>

<!-- æœ‰å…³å¤šè¯­è¨€å’Œå­—ä½“ï¼Œè¯·çœ‹ [github](https://github.com/lindexi/lindexi_gd/tree/094e0b6de5d341a68906c7dc9e6a3f662cca9020/HerjemhokiNeakunegar) -->

:ET