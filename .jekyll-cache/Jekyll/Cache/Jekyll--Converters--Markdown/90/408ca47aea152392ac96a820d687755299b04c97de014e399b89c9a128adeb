I"ŠF<p>åœ¨ OpenXML é‡Œé¢çš„æ–‡æœ¬æ’ç‰ˆé‡Œé¢ä½¿ç”¨åˆ° spcPct ï¼ˆSpacing Percentï¼‰ å’Œ spcPtsï¼ˆSpacing Pointsï¼‰ä¸¤ä¸ªä¸åŒçš„å•ä½ç”¨æ¥è¡¨ç¤ºæ®µå‰ç©ºç™½å’Œæ®µåç©ºç™½ä»¥åŠè¡Œé—´è·</p>

<!--more-->

<!-- CreateTime:7/8/2020 3:39:37 PM -->

<p>åœ¨ Office çš„æ–‡æœ¬æ’ç‰ˆé‡Œé¢ï¼Œä¼šåœ¨ spcAft (Space After) æ®µåç©ºç™½ç©ºé—´ä»¥åŠ spcBef (Space Before) æ®µå‰ç©ºç™½ç©ºé—´ç­‰ä½¿ç”¨ spcPct ï¼ˆSpacing Percentï¼‰ç™¾åˆ†æ¯”ç©ºé—´ å’Œ spcPtsï¼ˆSpacing Pointsï¼‰ å›ºå®šç‚¹æ•°ç©ºé—´è¡¨ç¤ºç©ºç™½ç©ºé—´</p>

<p>ä»å‘½åä¸Šå¯ä»¥çœ‹å‡º spcPct ï¼ˆSpacing Percentï¼‰ç™¾åˆ†æ¯”ç©ºé—´ å’Œ spcPtsï¼ˆSpacing Pointsï¼‰ å›ºå®šç‚¹æ•°ç©ºé—´çš„ä¸åŒ</p>

<h2 id="spacing-percent">Spacing Percent</h2>

<p>ç™¾åˆ†æ¯”ç©ºé—´ç›¸å¯¹å¤æ‚ï¼Œè¿™ä¸ªå•ä½ä¼šæ ¹æ®ä¸åŒçš„ä¸šåŠ¡é‡‡ç”¨ä¸åŒçš„å€¼ï¼Œè¿™ä¸ªå€¼æœ¬èº«åªä»£è¡¨ç™¾åˆ†æ¯”ï¼Œå€¼çš„æœ¬èº«çš„æ•°æ®å¯ä»¥åŠ ä¸Šç™¾åˆ†æ¯”å•ä½ï¼Œå¦‚æœåŠ ä¸Šå•ä½äº†ï¼Œé‚£ä¹ˆåˆ™è¡¨ç¤ºå¤šå°‘ç™¾åˆ†æ¯”ã€‚å¦‚æœä¸åŠ ä¸Šå•ä½ï¼Œé‚£ä¹ˆé»˜è®¤æ•°æ®å•ä½æ˜¯åƒç™¾åˆ†æ¯”ï¼Œæ„æ€æ˜¯ç”¨ä¸€åƒè¡¨ç¤ºä¸€ä¸ªç™¾åˆ†æ¯”</p>

<p>å¦‚ä¸‹é¢ä»£ç ï¼Œæ·»åŠ äº†å…·ä½“ç™¾åˆ†å·å•ä½ï¼Œæ­¤æ—¶è¡¨ç¤ºçš„å°±æ˜¯ç™¾åˆ†æ¯”</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">pPr</span> <span class="err">â€¦</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">spcBef</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">spcPct</span> <span class="n">val</span><span class="p">=</span><span class="s">"200%"</span><span class="p">/&gt;</span> 
      <span class="p">&lt;/</span><span class="n">a</span><span class="p">:</span><span class="n">spcBef</span><span class="p">&gt;</span> 
    <span class="p">&lt;/</span><span class="n">a</span><span class="p">:</span><span class="n">pPr</span><span class="p">&gt;</span>  
</code></pre></div></div>

<p>å¦‚ä¸‹é¢ä»£ç ï¼Œæ²¡æœ‰æ·»åŠ ä»»ä½•å•ä½ï¼Œæ­¤æ—¶è¡¨ç¤ºçš„å°±æ˜¯åƒå€çš„ç™¾åˆ†æ¯”</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">pPr</span> <span class="err">â€¦</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">spcBef</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">spcPct</span> <span class="n">val</span><span class="p">=</span><span class="s">"200000"</span><span class="p">/&gt;</span> 
      <span class="p">&lt;/</span><span class="n">a</span><span class="p">:</span><span class="n">spcBef</span><span class="p">&gt;</span> 
    <span class="p">&lt;/</span><span class="n">a</span><span class="p">:</span><span class="n">pPr</span><span class="p">&gt;</span>  
</code></pre></div></div>

<p>ä¸Šé¢ä¸¤æ®µä»£ç çš„æ•°å€¼æ˜¯ç­‰ä»·çš„</p>

<p>åœ¨æ‹¿åˆ°ç™¾åˆ†æ¯”çš„å€¼è¿˜éœ€è¦çŸ¥é“è¿™æ˜¯ç›¸å¯¹äºè°çš„å¤§å°æ‰èƒ½è®¡ç®—å‡ºæ¥</p>

<p>é»˜è®¤è¿™ä¸ªæ˜¯ç›¸å¯¹äºå½“å‰åº”ç”¨è¿™ä¸ª a:rPr (RunProperties) çš„ a:t (TextRun) é‡Œé¢çš„å­—å·æœ€å¤§çš„å­—å·çš„å€¼ä½œä¸ºç›¸å¯¹çš„ç™¾åˆ†æ¯”ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨åŒä¸€è¡Œçš„æ®µè½é‡Œé¢æœ‰ä¸åŒçš„å¤§å°çš„å­—å·ï¼Œå¦‚æœ‰ 10 å·çš„å’Œ 20 å·çš„ï¼Œé‚£ä¹ˆå°†ä½¿ç”¨æœ€å¤§çš„å­—å· 20 å·ä½œä¸ºç›¸å¯¹çš„å€¼è®¡ç®—</p>

<p>å…³äºç™¾åˆ†æ¯”å•ä½ç­‰è¯·çœ‹ <a href="https://blog.lindexi.com/post/Office-Open-XML-%E7%9A%84%E6%B5%8B%E9%87%8F%E5%8D%95%E4%BD%8D.html">Office Open XML çš„æµ‹é‡å•ä½</a></p>

<h2 id="spacing-points">Spacing Points</h2>

<p>å›ºå®šç‚¹æ•°ç©ºé—´çš„æ•°å€¼å•ä½æ˜¯ç™¾ç‚¹ä¹Ÿå°±æ˜¯æ•°å€¼ 100 è¡¨ç¤º 1 point å¤§å°</p>

<p>è¿™é‡Œçš„ point å’Œæ–‡æœ¬çš„å­—å·çš„ point æ˜¯ç›¸ç­‰çš„å«ä¹‰</p>

<p>å¦‚ä¸‹ä»£ç ï¼Œç”± <code class="language-plaintext highlighter-rouge">val="1500"</code> è¡¨ç¤ºæ®µå‰ç©ºç™½é•¿åº¦æ˜¯ 15 point å¤§å°</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">pPr</span> <span class="err">â€¦</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">spcBef</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="n">a</span><span class="p">:</span><span class="n">spcPts</span> <span class="n">val</span><span class="p">=</span><span class="s">"1500"</span><span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="n">a</span><span class="p">:</span><span class="n">spcBef</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="n">a</span><span class="p">:</span><span class="n">pPr</span><span class="p">&gt;</span>
</code></pre></div></div>

<h2 id="æ›´å¤šä»£ç ">æ›´å¤šä»£ç </h2>

<p>é™„è¡¨ç¤ºç™¾åˆ†æ¯”çš„æ•°å€¼</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// è¡¨ç¤ºä¸€ä¸ªç™¾åˆ†æ¯”æ•°å€¼</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Percentage</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kt">double</span> <span class="n">Precision</span> <span class="p">=</span> <span class="m">100000.0</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// å°†ä¸€ä¸ªopenxmlè¡¨ç¤ºçš„ç™¾åˆ†æ¯”intå€¼è½¬æ¢</span>
        <span class="c1">/// æ¯1000ä¸ªå•ä½ä»£è¡¨1%</span>
        <span class="c1">/// &lt;param name="value"&gt;&lt;/param&gt;</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="nf">Percentage</span><span class="p">(</span><span class="kt">int</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IntValue</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// å°†ä»ä¸€ä¸ªdoubleæ•°å€¼æ„å»ºopenxmlè¡¨ç¤ºçš„ç™¾åˆ†æ¯”</span>
        <span class="c1">/// æ¯0.01ä¸ªdoubleæ•°å€¼ä»£è¡¨1%</span>
        <span class="c1">/// ä¼šä¸¢å¤±ç²¾åº¦</span>
        <span class="c1">/// &lt;param name="value"&gt;&lt;/param&gt;</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">Percentage</span> <span class="nf">FromDouble</span><span class="p">(</span><span class="kt">double</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="k">value</span> <span class="p">*</span> <span class="n">Precision</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">Percentage</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// openxmlè¡¨ç¤ºçš„ç™¾åˆ†æ¯”intå€¼</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">IntValue</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// openxmlè¡¨ç¤ºçš„ç™¾åˆ†æ¯”doubleå€¼</span>
        <span class="c1">/// 0-1</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">double</span> <span class="n">DoubleValue</span> <span class="p">=&gt;</span> <span class="n">IntValue</span> <span class="p">/</span> <span class="n">Precision</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// è·å–åœ¨æŒ‡å®šèŒƒå›´å†…çš„doubleå€¼</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="min"&gt;&lt;/param&gt;</span>
        <span class="c1">/// &lt;param name="max"&gt;&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="k">public</span> <span class="kt">double</span> <span class="nf">DoubleValueWithRange</span><span class="p">(</span><span class="kt">double</span> <span class="n">min</span><span class="p">,</span> <span class="kt">double</span> <span class="n">max</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">min</span> <span class="p">&gt;</span> <span class="n">max</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidOperationException</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="k">nameof</span><span class="p">(</span><span class="n">max</span><span class="p">)}</span><span class="s">:</span><span class="p">{</span><span class="n">max</span><span class="p">}</span><span class="s"> must greater than </span><span class="p">{</span><span class="k">nameof</span><span class="p">(</span><span class="n">min</span><span class="p">)}</span><span class="s">:</span><span class="p">{</span><span class="n">min</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="kt">var</span> <span class="k">value</span> <span class="p">=</span> <span class="n">IntValue</span> <span class="p">/</span> <span class="n">Precision</span><span class="p">;</span>
            <span class="k">value</span> <span class="p">=</span> <span class="k">value</span> <span class="p">&gt;</span> <span class="n">max</span> <span class="p">?</span> <span class="n">max</span> <span class="p">:</span> <span class="k">value</span><span class="p">;</span>
            <span class="k">value</span> <span class="p">=</span> <span class="k">value</span> <span class="p">&lt;</span> <span class="n">min</span> <span class="p">?</span> <span class="n">min</span> <span class="p">:</span> <span class="k">value</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">value</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">override</span> <span class="kt">bool</span> <span class="nf">Equals</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">obj</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">||</span> <span class="k">this</span><span class="p">.</span><span class="nf">GetType</span><span class="p">()</span> <span class="p">!=</span> <span class="n">obj</span><span class="p">.</span><span class="nf">GetType</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">Percentage</span> <span class="n">p</span> <span class="p">=</span> <span class="p">(</span><span class="n">Percentage</span><span class="p">)</span> <span class="n">obj</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">IntValue</span> <span class="p">==</span> <span class="n">p</span><span class="p">.</span><span class="n">IntValue</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">override</span> <span class="kt">int</span> <span class="nf">GetHashCode</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">IntValue</span><span class="p">.</span><span class="nf">GetHashCode</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="n">Percentage</span> <span class="k">operator</span> <span class="p">+(</span><span class="n">Percentage</span> <span class="n">a</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">a</span><span class="p">;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">Percentage</span> <span class="k">operator</span> <span class="p">-(</span><span class="n">Percentage</span> <span class="n">a</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">Percentage</span><span class="p">(-</span><span class="n">a</span><span class="p">.</span><span class="n">IntValue</span><span class="p">);</span>

        <span class="k">public</span> <span class="k">static</span> <span class="n">Percentage</span> <span class="k">operator</span> <span class="p">+(</span><span class="n">Percentage</span> <span class="n">a</span><span class="p">,</span> <span class="n">Percentage</span> <span class="n">b</span><span class="p">)</span>
            <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">Percentage</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">IntValue</span> <span class="p">+</span> <span class="n">b</span><span class="p">.</span><span class="n">IntValue</span><span class="p">);</span>

        <span class="k">public</span> <span class="k">static</span> <span class="n">Percentage</span> <span class="k">operator</span> <span class="p">-(</span><span class="n">Percentage</span> <span class="n">a</span><span class="p">,</span> <span class="n">Percentage</span> <span class="n">b</span><span class="p">)</span>
            <span class="p">=&gt;</span> <span class="n">a</span> <span class="p">+</span> <span class="p">(-</span><span class="n">b</span><span class="p">);</span>

        <span class="k">public</span> <span class="k">static</span> <span class="n">Percentage</span> <span class="k">operator</span> <span class="p">*(</span><span class="n">Percentage</span> <span class="n">a</span><span class="p">,</span> <span class="n">Percentage</span> <span class="n">b</span><span class="p">)</span>
            <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">Percentage</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">IntValue</span> <span class="p">*</span> <span class="n">b</span><span class="p">.</span><span class="n">IntValue</span><span class="p">);</span>

        <span class="k">public</span> <span class="k">static</span> <span class="n">Percentage</span> <span class="k">operator</span> <span class="p">/(</span><span class="n">Percentage</span> <span class="n">a</span><span class="p">,</span> <span class="n">Percentage</span> <span class="n">b</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">IntValue</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">DivideByZeroException</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="k">new</span> <span class="nf">Percentage</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">IntValue</span> <span class="p">/</span> <span class="n">b</span><span class="p">.</span><span class="n">IntValue</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="k">operator</span> <span class="p">&gt;(</span><span class="n">Percentage</span> <span class="n">a</span><span class="p">,</span> <span class="n">Percentage</span> <span class="n">b</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">IntValue</span> <span class="p">&gt;</span> <span class="n">b</span><span class="p">.</span><span class="n">IntValue</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="k">operator</span> <span class="p">&lt;(</span><span class="n">Percentage</span> <span class="n">a</span><span class="p">,</span> <span class="n">Percentage</span> <span class="n">b</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">b</span> <span class="p">&gt;</span> <span class="n">a</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>æ›´å¤šè¯·çœ‹</p>

<p><a href="https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.drawing.runproperties?view=openxml-2.8.1">RunProperties Class (DocumentFormat.OpenXml.Drawing)</a></p>

:ET