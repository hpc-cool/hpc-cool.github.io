I"±	<p>æœ¬æ–‡æ¥å‘Šè¯‰å¤§å®¶å¦‚ä½•å®ç°ä¸€ä¸ª WeakLazy æ–¹æ³•</p>

<!--more-->

<!-- CreateTime:6/5/2020 9:35:31 AM -->

<p>ä»£ç å¾ˆç®€å•ï¼Œè¯·çœ‹ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">class</span> <span class="nc">WeakLazy</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="k">where</span> <span class="n">T</span> <span class="p">:</span> <span class="k">class</span><span class="err">,</span> <span class="nc">new</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">WeakReference</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">_instance</span> <span class="p">=</span> <span class="k">new</span> <span class="n">WeakReference</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="k">null</span><span class="p">);</span>
        <span class="k">public</span> <span class="n">T</span> <span class="n">Value</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">lock</span> <span class="p">(</span><span class="n">_instance</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">T</span> <span class="k">value</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(!</span><span class="n">_instance</span><span class="p">.</span><span class="nf">TryGetTarget</span><span class="p">(</span><span class="k">out</span> <span class="k">value</span><span class="p">))</span>
                    <span class="p">{</span>
                        <span class="k">value</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">T</span><span class="p">();</span>
                        <span class="n">_instance</span><span class="p">.</span><span class="nf">SetTarget</span><span class="p">(</span><span class="k">value</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">return</span> <span class="k">value</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>è¿™æ ·å°±èƒ½åšåˆ°ä¸€ä¸ªç®€å•çš„ç¼“å­˜</p>

:ET