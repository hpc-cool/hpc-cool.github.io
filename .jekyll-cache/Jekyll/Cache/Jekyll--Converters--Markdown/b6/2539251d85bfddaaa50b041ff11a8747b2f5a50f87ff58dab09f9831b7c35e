I"Î<p>æœ¬æ–‡å‘Šè¯‰å¤§å®¶å¦‚æœåœ¨ Nuget å¼•ç”¨æºä»£ç çš„æ–¹å¼å¼•ç”¨æºä»£ç ï¼Œåœ¨ VisualStudio çš„æ™ºèƒ½æç¤ºå’Œ Resharper çš„æ™ºèƒ½æç¤ºéƒ½èƒ½æ‰¾åˆ°å¯¹åº”çš„ç±»ï¼Œä½†æ˜¯åœ¨ VisualStudio ç¼–è¯‘æˆ–ä½¿ç”¨å‘½ä»¤è¡Œ msbuild ç¼–è¯‘æ—¶æç¤ºæ‰¾ä¸åˆ°ç±»</p>

<!--more-->

<!-- CreateTime:2018/9/29 12:58:16 -->

<!-- csdn -->

<!-- æ ‡ç­¾ï¼šRoslyn,MSBuild,ç¼–è¯‘å™¨ -->

<p>è¿™ä¸ªé—®é¢˜æ˜¯ msbuild çš„ä¸€ä¸ªå‘ï¼Œä¸»è¦æ˜¯æ²¡æœ‰ä¸»åŠ¨å¼•ç”¨ <code class="language-plaintext highlighter-rouge">.nuget.g.props</code> å’Œ <code class="language-plaintext highlighter-rouge">.nuget.g.targets</code> æ–‡ä»¶ï¼Œä½¿ç”¨ Microsoft.NET.Sdk ä½œä¸º Sdk çš„é¡¹ç›®æ–‡ä»¶ä¼šè‡ªåŠ¨åœ¨ obj æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆ project.assets.jsonã€$(ProjectName).csproj.nuget.cacheã€$(ProjectName).csproj.nuget.g.props å’Œ $(ProjectName).csproj.nuget.g.targets æ–‡ä»¶ï¼›å…¶ä¸­ .nuget.g.props å’Œ .nuget.g.targets ä¸­ç”Ÿæˆäº† Import åŒ…ä¸­ç¼–è¯‘ç›¸å…³æ–‡ä»¶çš„ä»£ç ã€‚å…·ä½“è¯·çœ‹<a href="https://blog.walterlv.com/post/problems-of-msbuild-and-nuget.html">MSBuild/Roslyn å’Œ NuGet çš„ 100 ä¸ªå‘ - walterlv</a></p>

<p>ä½†æ˜¯åœ¨ä½¿ç”¨ Nuget å¼•ç”¨æºä»£ç çš„æ—¶å€™ï¼Œå› ä¸ºæ­¤æ—¶æºä»£ç è¿˜æ²¡åŠ å…¥åˆ°ç¼–è¯‘ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™ msbuild æ‰¾ä¸åˆ°ç±»ï¼Œäºæ˜¯å°±æ²¡ç»§ç»­æ‰§è¡Œï¼Œåªæ˜¯å°±æ— æ³•ç¼–è¯‘é€šè¿‡</p>

<p>åœ¨æˆ‘çš„é¡¹ç›®ç¼–è¯‘å‡ºç°ä¸‹é¢çš„æç¤º</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">â€œ</span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">lindexi</span><span class="err">\</span><span class="n">github</span><span class="err">\</span><span class="n">SopisatraJowje</span><span class="err">\</span><span class="n">SopisatraJowje</span><span class="err">\</span><span class="n">SopisatraJowje</span><span class="p">.</span><span class="n">csproj</span><span class="err">â€</span><span class="p">(</span><span class="err">é»˜è®¤ç›®æ ‡</span><span class="p">)</span> <span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="p">-&gt;</span>
<span class="err">â€œ</span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">lindexi</span><span class="err">\</span><span class="n">github</span><span class="err">\</span><span class="n">SopisatraJowje</span><span class="err">\</span><span class="n">SopisatraJowje</span><span class="err">\</span><span class="n">SopisatraJowje</span><span class="p">.</span><span class="n">csproj</span><span class="err">â€</span><span class="p">(</span><span class="n">Build</span> <span class="err">ç›®æ ‡</span><span class="p">)</span> <span class="p">(</span><span class="m">1</span><span class="p">:</span><span class="m">2</span><span class="p">)</span> <span class="p">-&gt;</span>
<span class="err">â€œ</span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">lindexi</span><span class="err">\</span><span class="n">github</span><span class="err">\</span><span class="n">SopisatraJowje</span><span class="err">\</span><span class="n">SopisatraJowje</span><span class="err">\</span><span class="n">SopisatraJowje_rb00pftp_wpftmp</span><span class="p">.</span><span class="n">csproj</span><span class="err">â€</span><span class="p">(</span><span class="n">_CompileTemporaryAssembly</span> <span class="err">ç›®æ ‡</span><span class="p">)</span> <span class="p">(</span>
<span class="m">2</span><span class="p">)</span> <span class="p">-&gt;</span>
<span class="p">(</span><span class="n">CoreCompile</span> <span class="err">ç›®æ ‡</span><span class="p">)</span> <span class="p">-&gt;</span>
  <span class="n">MainWindow</span><span class="p">.</span><span class="n">xaml</span><span class="p">.</span><span class="nf">cs</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="m">12</span><span class="p">):</span> <span class="n">error</span> <span class="n">CS0234</span><span class="p">:</span> <span class="err">å‘½åç©ºé—´â€œ</span><span class="n">lindexi</span><span class="err">â€ä¸­ä¸å­˜åœ¨ç±»å‹æˆ–å‘½åç©ºé—´åâ€œ</span><span class="n">Doubi</span><span class="err">â€</span><span class="p">(</span><span class="err">æ˜¯å¦ç¼ºå°‘ç¨‹åºé›†å¼•ç”¨</span><span class="p">?)</span> <span class="p">[</span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">lindexi</span><span class="err">\</span><span class="n">github</span><span class="err">\</span><span class="n">SopisatraJowj</span>
<span class="n">e</span><span class="err">\</span><span class="n">SopisatraJowje</span><span class="err">\</span><span class="n">SopisatraJowje_rb00pftp_wpftmp</span><span class="p">.</span><span class="n">csproj</span><span class="p">]</span>
</code></pre></div></div>

<p>ç®€å•çš„è§£å†³æ–¹æ³•æ˜¯åœ¨ csproj æ·»åŠ å¼•ç”¨ <code class="language-plaintext highlighter-rouge">.nuget.g.props</code> ä¸¤ä¸ªæ–‡ä»¶ï¼Œå¼•ç”¨çš„æ–¹å¼æ˜¯åœ¨<code class="language-plaintext highlighter-rouge">&lt;Project Sdk="Microsoft.NET.Sdk" ToolsVersion="15.0"&gt;</code> çš„ä¸‹ä¸€å¥å¼•ç”¨ <code class="language-plaintext highlighter-rouge">.nuget.g.props</code> ä¾‹å¦‚æˆ‘åˆ›å»ºäº†é¡¹ç›®æ˜¯ <code class="language-plaintext highlighter-rouge">SopisatraJowje</code> æˆ‘å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼å¼•ç”¨</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Project</span> <span class="na">Sdk=</span><span class="s">"Microsoft.NET.Sdk"</span> <span class="na">ToolsVersion=</span><span class="s">"15.0"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Import</span> <span class="na">Project=</span><span class="s">"obj\SopisatraJowje.csproj.nuget.g.props"</span><span class="nt">&gt;&lt;/Import&gt;</span>

  <span class="c">&lt;!-- ä¸‹é¢æ˜¯åŸæ¥çš„å†…å®¹ --&gt;</span>
  <span class="nt">&lt;PropertyGroup&gt;</span>
    <span class="nt">&lt;LanguageTargets&gt;</span>$(MSBuildToolsPath)\Microsoft.CSharp.targets<span class="nt">&lt;/LanguageTargets&gt;</span>
    <span class="nt">&lt;TargetFrameworks&gt;</span>net45;<span class="nt">&lt;/TargetFrameworks&gt;</span>
    <span class="nt">&lt;OutputType&gt;</span>WinExe<span class="nt">&lt;/OutputType&gt;</span>
  <span class="nt">&lt;/PropertyGroup&gt;</span>
</code></pre></div></div>

<p>åœ¨æ–‡ä»¶çš„æœ€åå†æ·»åŠ å¼•ç”¨ nuget.g.targets æ–‡ä»¶çš„æœ€åéœ€è¦åœ¨ <code class="language-plaintext highlighter-rouge">&lt;/Project&gt;</code> ä¸Šä¸€ä¸ª</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;Import</span> <span class="na">Project=</span><span class="s">"obj\SopisatraJowje.csproj.nuget.g.targets"</span><span class="nt">&gt;&lt;/Import&gt;</span>
<span class="nt">&lt;/Project&gt;</span>
</code></pre></div></div>

<p>ä¹Ÿå°±æ˜¯æ–‡ä»¶çœ‹èµ·æ¥æ˜¯è¿™æ ·</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Project Sdk="Microsoft.NET.Sdk" ToolsVersion="15.0"&gt;
  &lt;Import Project="obj\SopisatraJowje.csproj.nuget.g.props"&gt;&lt;/Import&gt;
  
  &lt;PropertyGroup&gt;
    &lt;LanguageTargets&gt;$(MSBuildToolsPath)\Microsoft.CSharp.targets&lt;/LanguageTargets&gt;
    &lt;TargetFrameworks&gt;net45;&lt;/TargetFrameworks&gt;
    &lt;OutputType&gt;WinExe&lt;/OutputType&gt;
  &lt;/PropertyGroup&gt;
 

  &lt;Import Project="obj\SopisatraJowje.csproj.nuget.g.targets"&gt;&lt;/Import&gt;
&lt;/Project&gt;
</code></pre></div></div>

<p>æ·»åŠ äº†è¿™ä¸¤ä¸ªå¼•ç”¨å°±å¯ä»¥è§£å†³æºä»£ç å¼•ç”¨çš„æ—¶å€™å‡ºç°äº†åœ¨ VisualStudio å¯ä»¥è·³è½¬æ‰¾åˆ°ç±»ï¼Œä½†æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™æ‰¾ä¸åˆ°ç±»çš„é—®é¢˜</p>

<p><a href="https://blog.walterlv.com/post/problems-of-msbuild-and-nuget.html">MSBuild/Roslyn å’Œ NuGet çš„ 100 ä¸ªå‘ - walterlv</a></p>

<p><img src="http://image.acmx.xyz/lindexi%2F2018927201059809" alt="" /></p>

:ET