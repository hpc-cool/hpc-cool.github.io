I"«<p>TextBoxæ˜¯ç»™ç”¨æˆ·è¾“å…¥ï¼Œæˆ‘ä»¬æœ‰æ—¶è¦ç”¨æˆ·åªè¾“å…¥æ•°å­—ï¼Œè€Œç”¨æˆ·è¾“å…¥æ±‰å­—ï¼Œæˆ‘ä»¬å°±æœ‰æç¤ºç”¨æˆ·ï¼Œé‚£ä¹ˆè¿™ä¸œè¥¿ç”¨åˆ°æ¬¡æ•°å¾ˆå¤šï¼Œæˆ‘ä»¬éœ€è¦åšæˆä¸€ä¸ªæ§ä»¶ã€‚
æˆ‘ä»¬å¯ä»¥ç”¨åˆ«äººçš„åº“ï¼Œæˆ‘æ‰¾åˆ°ä¸€ä¸ª<a href="http://jamescroft.co.uk">å¤§ç¥</a>å†™çš„åº“ï¼Œå¾ˆå¥½ç”¨
æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªåº“å¯ä»¥å®šä¹‰å¾ˆå¤šéªŒè¯ï¼Œæˆ‘è®°å½•æˆ‘å¦‚ä½•ä½¿ç”¨ä»–è¿™ä¸ªåº“ï¼Œè¿˜æœ‰å¦‚ä½•å»ä¿®æ”¹è¿™ä¸ªåº“ã€‚å¦‚ä½•è‡ªå®šä¹‰æ§ä»¶åšä¸€ä¸ªå’Œå¤§ç¥åšçš„ä¸€æ ·çš„æ§ä»¶ã€‚</p>

<!--more-->

<!-- CreateTime:2018/8/10 19:16:51 -->

<div id="toc"></div>

<h2 id="nuget">Nuget</h2>

<p>æˆ‘ä»¬ç”¨è¿™ä¸ªåº“æ˜¯jamescroftå†™çš„ï¼Œä»–ä¸Šä¼ åˆ°Nugetï¼Œæˆ‘ä»¬å¯ä»¥å»ä¸‹è½½</p>

<p>ç”¨Nugetæœç´¢<code class="language-plaintext highlighter-rouge">WinUX.UWP.Xaml.Controls</code></p>

<p><img src="http://image.acmx.xyz/fc7733af-8526-44d2-84b9-99b41ef99f4a2016121214411.jpg" alt="" /></p>

<p>ä¸‹è½½å®Œæˆå°±å¥½</p>

<h2 id="ä½¿ç”¨åº“">ä½¿ç”¨åº“</h2>

<p>æˆ‘ä»¬ç»å¸¸éœ€è¦éªŒè¯ç”¨æˆ·è¾“å…¥ï¼Œä¸æ˜¯ä½¿ç”¨ä¸€ä¸ªè§„åˆ™ï¼Œæ˜¯æœ‰å¾ˆå¤šè§„åˆ™ã€‚æˆ‘ä»¬å¸¸ç”¨çš„è§„åˆ™ä¹Ÿå°±å‡ ä¸ªï¼Œæ•°å­—ã€URLâ€¦â€¦</p>

<p>æˆ‘ä»¬ä¸‹è½½åº“ï¼Œæœ‰å¸¸ç”¨è§„åˆ™</p>

<p>â€“ DateTimeValidationRule 
  æ—¥æœŸè§„åˆ™ï¼Œè¾“å…¥å¯ä»¥è½¬æ—¥æœŸ</p>

<p>â€“ DecimalValidationRule  <br />
  æ•°å­—ï¼Œè¾“å…¥å¯ä»¥è½¬æ•°å­—</p>

<p>â€“ DoubleValidationRule
  è¾“å…¥å¯ä»¥è½¬æµ®ç‚¹</p>

<p>â€“ EmailValidationRule
  é‚®ç®±ï¼Œè¾“å…¥æ˜¯mail</p>

<p>â€“ IntValidationRule
  æ•´å½¢ï¼Œè¾“å…¥å¯ä»¥è½¬æ•´å½¢</p>

<p>â€“ RegexValidationRule
  æˆ‘ä»¬è‡ªå·±å®šä¹‰æ­£åˆ™ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦å¤æ‚çš„ï¼Œè¦æ±‚é•¿åº¦</p>

<p>â€“ UrlValidationRule
  è¾“å…¥æ˜¯URL</p>

<p>æˆ‘ä»¬è¦åœ¨èµ„æºå®šä¹‰ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰å¤šæ¡éªŒè¯</p>

<p>å…ˆå†™ï¼Œå› ä¸ºæˆ‘ä»¬å¼•ç”¨åº“å’Œæˆ‘çš„ä¸çŸ¥ä¸€ç©ºé—´</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     <span class="n">xmlns</span><span class="p">:</span><span class="n">validation</span><span class="p">=</span><span class="s">"using:WinUX.Data.Validation"</span>
     <span class="n">xmlns</span><span class="p">:</span><span class="n">rules</span><span class="p">=</span><span class="s">"using:WinUX.Data.Validation.Rules"</span>
     <span class="n">xmlns</span><span class="p">:</span><span class="n">controls</span><span class="p">=</span><span class="s">"using:WinUX.Xaml.Controls"</span>

</code></pre></div></div>

<p>åœ¨èµ„æºå®šä¹‰ï¼Œæˆ‘ä»¬éœ€è¦å¤šæ¡ï¼Œçœ‹èµ·æ¥å¥½é•¿ï¼Œå¦‚æœæˆ‘ä»¬è¦ç”¨ä¸¤æ¬¡ï¼Œé‚£ä¹ˆè¿˜æ˜¯å†™èµ„æº</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="nt">&lt;Grid.Resources&gt;</span>
            <span class="nt">&lt;validation:ValidationRules</span> <span class="na">x:Key=</span><span class="s">"UrlSample"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;validation:ValidationRules.Rules&gt;</span>
                    <span class="nt">&lt;rules:UrlValidationRule</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;/validation:ValidationRules.Rules&gt;</span>
            <span class="nt">&lt;/validation:ValidationRules&gt;</span>
        <span class="nt">&lt;/Grid.Resources&gt;</span>
 
</code></pre></div></div>

<p>ä¸‹é¢ç›´æ¥æŠ„å¤§ç¥å†™çš„</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     <span class="nt">&lt;controls:ValidatingTextBox</span> <span class="na">IsMandatory=</span><span class="s">"True"</span> <span class="na">Header=</span><span class="s">"Website"</span> <span class="na">Text=</span><span class="s">"http://www.jamescroft.co.uk"</span> 
                                    <span class="na">MaxLength=</span><span class="s">"50"</span> 
                                    <span class="na">ValidationRules=</span><span class="s">"{StaticResource Url}"</span> 
                                    <span class="na">VerticalAlignment=</span><span class="s">"Center"</span><span class="nt">/&gt;</span>
 
</code></pre></div></div>

<p><img src="http://image.acmx.xyz/validaTextbox20161212145937.gif" alt="" /></p>

<p><code class="language-plaintext highlighter-rouge">MaxLength</code> æœ€å¤§é•¿åº¦</p>

<p><code class="language-plaintext highlighter-rouge">ValidationRules</code> éªŒè¯è§„åˆ™</p>

<!-- `IsMandatory` è¾“å…¥æ˜¯å¦å¯¹

è¿™ä¸ªå€¼ç»‘å®šåˆ°ViewModelå¯ä»¥å¾—åˆ°æ˜¯å¦å¯ä»¥è¾“å…¥åˆ°ViewModel -->

<p><code class="language-plaintext highlighter-rouge">IsMandatory</code> è¾“å…¥è§„åˆ™</p>

<p><code class="language-plaintext highlighter-rouge">MandatoryValidationMessage</code> è¾“å…¥è§„åˆ™æç¤º</p>

<p>å¦‚æœ<code class="language-plaintext highlighter-rouge">IsMandatory=true</code>åœ¨æ²¡æœ‰è¾“å…¥ï¼Œæ˜¾ç¤º<code class="language-plaintext highlighter-rouge">MandatoryValidationMessage</code></p>

<p><code class="language-plaintext highlighter-rouge">IsInvalid</code> è¾“å…¥æ˜¯å¦å¯¹</p>

<p>è¿™ä¸ªå€¼ç»‘å®šåˆ°ViewModelå¯ä»¥å¾—åˆ°æ˜¯å¦å¯ä»¥è¾“å…¥åˆ°ViewModel</p>

<p>å¦‚æœæˆ‘ä»¬éœ€è¦å†™è¾“å…¥é”™äº†æç¤º</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     <span class="nt">&lt;rules:UrlValidationRule</span> <span class="na">ErrorMessage=</span><span class="s">"è¾“å…¥é”™"</span><span class="nt">&gt;&lt;/rules:UrlValidationRule&gt;</span>
</code></pre></div></div>

<p>å¦‚æœéœ€è¦ä½¿ç”¨æ­£åˆ™ï¼Œæˆ‘ä»¬çš„éªŒè¯å¤åˆ¶ï¼Œéœ€è¦ä½¿ç”¨<code class="language-plaintext highlighter-rouge">RegexValidationRule</code>ï¼Œåœ¨<code class="language-plaintext highlighter-rouge">Regex</code>å†™æ­£åˆ™</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="nt">&lt;controls:ValidatingTextBox</span> <span class="na">IsMandatory=</span><span class="s">"True"</span> <span class="na">Header=</span><span class="s">"Website"</span> <span class="na">Text=</span><span class="s">""</span> 
                                    <span class="na">MaxLength=</span><span class="s">"0"</span> <span class="na">MandatoryValidationMessage=</span><span class="s">"è¾“å…¥"</span> 
                                    <span class="na">VerticalAlignment=</span><span class="s">"Center"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;controls:ValidatingTextBox.ValidationRules&gt;</span>
               <span class="nt">&lt;validation:ValidationRules&gt;</span>
                   <span class="nt">&lt;validation:ValidationRules.Rules&gt;</span>
                        <span class="nt">&lt;rules:RegexValidationRule</span> <span class="na">Regex=</span><span class="s">"mailto:\w+([-+.]\w+)*@\w+([-.]\w+)*.\w+([-.]\w+)*"</span><span class="nt">&gt;&lt;/rules:RegexValidationRule&gt;</span>
                   <span class="nt">&lt;/validation:ValidationRules.Rules&gt;</span>
               <span class="nt">&lt;/validation:ValidationRules&gt;</span>
            <span class="nt">&lt;/controls:ValidatingTextBox.ValidationRules&gt;</span>
            <span class="nt">&lt;controls:ValidatingTextBox.ValidationTextBlock</span> <span class="nt">&gt;</span>
                <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">"ValidationTextBlock"</span><span class="nt">&gt;&lt;/TextBlock&gt;</span>
            <span class="nt">&lt;/controls:ValidatingTextBox.ValidationTextBlock&gt;</span>
        <span class="nt">&lt;/controls:ValidatingTextBox&gt;</span>


</code></pre></div></div>

<p>ä½¿ç”¨å¾ˆç®€å•ï¼Œé‚£ä¹ˆè¿™å¦‚ä½•åšã€‚</p>

<p>ä¸‹é¢æˆ‘æ¥è¯´ä¸‹ï¼Œä»–è¿™ä¸ªå¦‚ä½•åšï¼Œè¿™æœ‰äº›å¤æ‚ï¼Œæˆ‘ä»¬åˆ†å¼€æ¥è¯´ï¼Œå¼€å§‹æ˜¯åŠŸèƒ½</p>

<h2 id="åˆ¤æ–­è¾“å…¥å­—ç¬¦é•¿åº¦">åˆ¤æ–­è¾“å…¥å­—ç¬¦é•¿åº¦</h2>

<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªTextBlockæ¥æ˜¾ç¤ºæœ€å¤§é•¿åº¦ã€ç°åœ¨å­—ç¬¦é•¿åº¦</p>

<p>æˆ‘ä»¬çš„TextBlockçš„åç§°<code class="language-plaintext highlighter-rouge">remainingCharacters</code>ï¼Œåœ¨è¾“å…¥å˜åŒ–ä¿®æ”¹</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">UpdateRemainingCharacters</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">//åˆ¤æ–­ä¸ä¸ºç©º</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">remainingCharacters</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">//å¦‚æœæœ€å¤§é•¿åº¦==0ï¼Œä¸æ˜¾ç¤º</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">MaxLength</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">remainingCharacters</span><span class="p">.</span><span class="n">Visibility</span> <span class="p">=</span> <span class="n">Visibility</span><span class="p">.</span><span class="n">Collapsed</span><span class="p">;</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="c1">//Textæ˜¯ç°åœ¨å­—ç¬¦ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªæ–°å­—ç¬¦ä¸²æ¥å¾—åˆ°</span>
                <span class="kt">var</span> <span class="n">remainingChar</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"{0}/{1}"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Length</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">MaxLength</span><span class="p">);</span>

                <span class="k">this</span><span class="p">.</span><span class="n">remainingCharacters</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">remainingChar</span><span class="p">;</span>

                <span class="c1">//è¿™å¥æ˜¯æ²¡ç”¨</span>
                <span class="k">this</span><span class="p">.</span><span class="n">remainingCharacters</span><span class="p">.</span><span class="n">Visibility</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">MaxLength</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">?</span> <span class="n">Visibility</span><span class="p">.</span><span class="n">Visible</span> <span class="p">:</span> <span class="n">Visibility</span><span class="p">.</span><span class="n">Collapsed</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

</code></pre></div></div>

<p>ä¸Šé¢æ˜¯å¤§ç¥å†™çš„ï¼Œæˆ‘å»ºè®®å¯ä»¥ç®€å•ä¸€ç‚¹ã€‚</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">UpdateRemainingCharacters</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">remainingCharacters</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">MaxLength</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">remainingCharacters</span><span class="p">.</span><span class="n">Visibility</span> <span class="p">=</span> <span class="n">Visibility</span><span class="p">.</span><span class="n">Collapsed</span><span class="p">;</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="kt">int</span> <span class="n">length</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">Text</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="n">length</span> <span class="p">=</span> <span class="n">Text</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="kt">var</span> <span class="n">remainingChar</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"{0}/{1}"</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">MaxLength</span><span class="p">);</span>

                <span class="n">remainingCharacters</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">remainingChar</span><span class="p">;</span>

                <span class="c1">//The above has judge the MaxLength ,and if it's 0,the Visibility will Collapsed</span>
                <span class="c1">//ä¸Šé¢ä»£ç æœ‰åˆ¤æ–­MaxLengthï¼Œå¦‚æœæ˜¯0ï¼Œéšè—</span>
                <span class="c1">//this.remainingCharacters.Visibility = this.MaxLength &gt; 0 ? Visibility.Visible : Visibility.Collapsed;</span>
            <span class="p">}</span>
        <span class="p">}</span>

</code></pre></div></div>

<h2 id="æ˜¯å¦è¦æ£€æŸ¥">æ˜¯å¦è¦æ£€æŸ¥</h2>

<p>æˆ‘ä»¬å…ˆåˆ¤æ–­æ˜¯å¦è¦æ£€æŸ¥ï¼Œå¦‚æœä¸è¦æ£€æŸ¥ï¼Œé‚£ä¹ˆå°±è¿”å›å¯¹</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">return</span> <span class="p">!</span><span class="n">IsMandatory</span><span class="p">;</span>

</code></pre></div></div>

<p>å¦‚æœè¦æ£€æŸ¥ï¼Œæˆ‘ä»¬çš„è¾“å…¥æ˜¯ç©ºï¼Œæˆ‘ä»¬è¦æç¤ºç”¨æˆ·è¾“å…¥</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="k">if</span> <span class="p">(!</span><span class="k">this</span><span class="p">.</span><span class="n">IsMandatory</span> <span class="p">&amp;&amp;</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrWhiteSpace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Text</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">ValidationTextBlock</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">MandatoryValidationMessage</span><span class="p">;</span>
            <span class="p">}</span>

</code></pre></div></div>

<p>ä¸Šé¢ä»£ç çš„ ValidationTextBlock å°±æ˜¯æç¤º</p>

<p>æˆ‘ä»¬åˆ¤æ–­ï¼Œå¦‚æœè¾“å…¥ä¸æ˜¯ç©ºï¼Œå°±è¿”å›è§„åˆ™åˆ¤æ–­ã€‚</p>

<p>äºæ˜¯æˆ‘ä»¬æ”¹ä¸º å¦‚æœä¸æ£€æŸ¥æˆ–è¾“å…¥æ˜¯ä¸ç©ºçš„ï¼Œè¿”å›trueã€‚å¦‚æœè¾“å…¥ä¸æ˜¯ä¸ºç©ºï¼Œç»§ç»­ä½¿ç”¨è§„åˆ™ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ValidationTextBlock</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">MandatoryValidationMessage</span><span class="p">;</span>

</code></pre></div></div>

<p>æ€»çš„ä»£ç è¯·çœ‹ï¼š</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">IsMandatoryFieldValid</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">//ä¸æ£€æŸ¥ || è¾“å…¥ä¸æ˜¯ç©º</span>
            <span class="c1">//å¦‚æœä¸æ£€æŸ¥ï¼Œtrue</span>
            <span class="c1">//å¦‚æœæ£€æŸ¥ å¦‚æœè¾“å…¥ä¸æ˜¯ç©º true</span>
            <span class="k">if</span> <span class="p">(!</span><span class="k">this</span><span class="p">.</span><span class="n">IsMandatory</span> <span class="p">||</span> <span class="p">!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrWhiteSpace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Text</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">ValidationTextBlock</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="n">ValidationTextBlock</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">MandatoryValidationMessage</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">VisualStateManager</span><span class="p">.</span><span class="nf">GoToState</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s">"Mandatory"</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>

</code></pre></div></div>

<h2 id="é•¿åº¦">é•¿åº¦</h2>

<p>æˆ‘ä»¬é€šè¿‡æ£€æŸ¥éªŒè¯ï¼Œæˆ‘ä»¬ç»§ç»­åˆ¤æ–­ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥æ£€æŸ¥é•¿åº¦ <code class="language-plaintext highlighter-rouge">Text.Length &gt; this.MaxLength</code> ï¼Œå¦‚æœå¤§äºé•¿åº¦ï¼Œä¸é€šè¿‡ï¼Œæç¤ºç”¨æˆ·ã€‚</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="kt">bool</span><span class="p">[]</span> <span class="n">isInvalid</span> <span class="p">=</span> <span class="p">{</span> <span class="p">!</span><span class="k">this</span><span class="p">.</span><span class="nf">IsMandatoryFieldValid</span><span class="p">()</span> <span class="p">};</span>

            <span class="k">if</span> <span class="p">(!</span><span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">MaxLength</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="n">MaxLength</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">])</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">ValidationTextBlock</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="n">ValidationTextBlock</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"The text exceeds the maximum length."</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>    <span class="c1">//ä¸çŸ¥é“isInvalid </span>

</code></pre></div></div>

<h2 id="åˆ¤æ–­">åˆ¤æ–­</h2>

<p>å¦‚æœè¾“å…¥é•¿åº¦ä¸å¤§äºæœ€å¤§å¯ä»¥æ¥å—çš„è¾“å…¥ï¼Œæˆ‘ä»¬åˆ¤æ–­æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œè¿™æ ·å†™æ˜¯å› ä¸ºåˆ¤æ–­é•¿åº¦çš„é€Ÿåº¦æ¯”åé¢çš„åˆ¤æ–­å¿«</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                    <span class="k">if</span> <span class="p">(</span><span class="n">ValidationRules</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">temp</span> <span class="k">in</span> <span class="n">ValidationRules</span><span class="p">.</span><span class="n">Rules</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="p">!</span><span class="n">temp</span><span class="p">.</span><span class="nf">IsValid</span><span class="p">(</span><span class="n">Text</span><span class="p">);</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">&amp;&amp;</span> <span class="n">ValidationTextBlock</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="n">ValidationTextBlock</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">temp</span><span class="p">.</span><span class="n">ErrorMessage</span><span class="p">;</span>
                                <span class="k">break</span><span class="p">;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>

</code></pre></div></div>

<p>å¤§ç¥å†™çš„ä½¿ç”¨TakeWhileï¼Œè¿™å‡½æ•°åˆ¤æ–­æ‰€æœ‰çš„å€¼ç¬¦åˆæ¡ä»¶ã€‚</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           <span class="k">if</span> <span class="p">(!</span><span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">MaxLength</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="n">MaxLength</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">])</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">ValidationTextBlock</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="n">ValidationTextBlock</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"The text exceeds the maximum length."</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">ValidationRules</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="c1">// Run through all of the validation rules for this text box and check is valid.</span>
                        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">rule</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="n">ValidationRules</span><span class="p">.</span><span class="n">Rules</span><span class="p">.</span><span class="nf">TakeWhile</span><span class="p">(</span><span class="n">rule</span> <span class="p">=&gt;</span> <span class="p">!</span><span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">]))</span>
                        <span class="p">{</span>
                            <span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="p">!</span><span class="n">rule</span><span class="p">.</span><span class="nf">IsValid</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>

                            <span class="k">if</span> <span class="p">(</span><span class="n">isInvalid</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="n">ValidationTextBlock</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="k">this</span><span class="p">.</span><span class="n">ValidationTextBlock</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">rule</span><span class="p">.</span><span class="n">ErrorMessage</span><span class="p">;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>

                    <span class="c1">//if (ValidationRules != null)</span>
                    <span class="c1">//{</span>
                    <span class="c1">//    foreach (var temp in ValidationRules.Rules)</span>
                    <span class="c1">//    {</span>
                    <span class="c1">//        isInvalid[0] = !temp.IsValid(Text);</span>
                    <span class="c1">//        if (isInvalid[0] &amp;&amp; ValidationTextBlock != null)</span>
                    <span class="c1">//        {</span>
                    <span class="c1">//            ValidationTextBlock.Text = temp.ErrorMessage;</span>
                    <span class="c1">//            break;</span>
                    <span class="c1">//        }</span>
                    <span class="c1">//    }</span>
                    <span class="c1">//}</span>
                <span class="p">}</span>
            <span class="p">}</span>

</code></pre></div></div>

<p>æˆ‘ä»¬éœ€è¦æŠŠåˆ¤æ–­æ”¾åˆ°IsInvalidï¼Œ<code class="language-plaintext highlighter-rouge">IsInvalid = isInvalid[0];</code></p>

<p>æˆ‘ä»¬æŠŠä¸Šé¢å†™çš„åšå‡½æ•°ï¼Œè¾“å…¥æ”¹å˜æˆ‘ä»¬ä½¿ç”¨æ›´æ–°æ¥åšåˆ¤æ–­ã€‚å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯æ‰€æœ‰çš„è¾“å…¥éƒ½è°ƒç”¨ï¼Œæ‰€ä»¥å¯èƒ½è§„åˆ™æ¯”è¾ƒæ…¢å°±ä¼šè®©ç”¨æˆ·éš¾ä»¥è¾“å…¥ã€‚</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">OnTextChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">TextChangedEventArgs</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nf">Update</span><span class="p">();</span>
        <span class="p">}</span>

</code></pre></div></div>

<h2 id="å¦‚ä½•å†™æ£€æŸ¥">å¦‚ä½•å†™æ£€æŸ¥</h2>

<p>æˆ‘ä»¬çš„æ ¸å¿ƒå°±æ˜¯å®ƒï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç±»æ¥æ”¾ç”¨æˆ·å†™çš„æ£€æŸ¥</p>

<p>è¿™ç±»æˆ‘å°±æ”¾<code class="language-plaintext highlighter-rouge">public List&lt;ValidationRule&gt; Rules { get; private set; }</code></p>

<p>å¼€å§‹æ ¸å¿ƒValidationRuleï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šæ£€æŸ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªValidationRuleï¼Œå®šä¹‰çš„æ£€æŸ¥éƒ½å¯ä»¥ä¿®æ”¹ValidationRuleæ–°æ£€æŸ¥</p>

<p>ValidationRuleåªæœ‰ä¸€ä¸ªå±æ€§ï¼Œé”™è¯¯æ˜¾ç¤ºçš„Message</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="kt">string</span> <span class="n">_errorMessage</span><span class="p">;</span>

        <span class="k">public</span> <span class="kt">string</span> <span class="n">ErrorMessage</span>
        <span class="p">{</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="n">_errorMessage</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrWhiteSpace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_errorMessage</span><span class="p">)</span> <span class="p">?</span> <span class="s">"Field invalid."</span> <span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="n">_errorMessage</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>å…¶å®å¦‚æœ<code class="language-plaintext highlighter-rouge">_errorMessage</code>ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬è¦è¿”å›é»˜è®¤çš„ï¼Œä¸è¦è¿”å›â€Field invalid.â€</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// If the errorMessage is null  </span>
        <span class="c1">/// return DefaultErrorMessage</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="n">DefaultErrorMessage</span>
        <span class="p">{</span>
            <span class="k">set</span><span class="p">;</span>
            <span class="k">get</span><span class="p">;</span>
        <span class="p">}</span> <span class="p">=</span> <span class="s">"Field invalid."</span><span class="p">;</span>

        <span class="k">private</span> <span class="kt">string</span> <span class="n">_errorMessage</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Gets the error message to display for the rule.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">ErrorMessage</span>
        <span class="p">{</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="n">_errorMessage</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrWhiteSpace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_errorMessage</span><span class="p">)</span> <span class="p">?</span> <span class="n">DefaultErrorMessage</span> <span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="n">_errorMessage</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

</code></pre></div></div>

<p>ç„¶åå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­æ˜¯å¦é€šè¿‡</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">abstract</span> <span class="kt">bool</span> <span class="nf">IsValid</span><span class="p">(</span><span class="kt">object</span> <span class="k">value</span><span class="p">);</span>

</code></pre></div></div>

<p>ç„¶åæˆ‘ä»¬å¯ä»¥å¼€å§‹åšæ£€æŸ¥</p>

<p>å¦‚ DateTime çš„åˆ¤æ–­</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">public</span> <span class="k">override</span> <span class="kt">bool</span> <span class="nf">IsValid</span><span class="p">(</span><span class="kt">object</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">value</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kt">var</span> <span class="n">val</span> <span class="p">=</span> <span class="k">value</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">DateTime</span> <span class="n">temp</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">DateTime</span><span class="p">.</span><span class="nf">TryParse</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="k">out</span> <span class="n">temp</span><span class="p">);</span>
        <span class="p">}</span>

</code></pre></div></div>

<p>è¿˜æœ‰æ•°å­— decimal åˆ¤æ–­</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">public</span> <span class="k">override</span> <span class="kt">bool</span> <span class="nf">IsValid</span><span class="p">(</span><span class="kt">object</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">value</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kt">var</span> <span class="n">val</span> <span class="p">=</span> <span class="k">value</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrWhiteSpace</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kt">decimal</span> <span class="n">temp</span><span class="p">;</span>
            <span class="k">return</span> <span class="kt">decimal</span><span class="p">.</span><span class="nf">TryParse</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="k">out</span> <span class="n">temp</span><span class="p">);</span>
        <span class="p">}</span>

</code></pre></div></div>

<h2 id="ç”¨æˆ·æ§ä»¶">ç”¨æˆ·æ§ä»¶</h2>

<!-- ä¸çŸ¥Customer Controlå«ç”¨æˆ·æ§ä»¶ï¼Ÿä¸æƒ³æŸ¥ï¼Œå¤§å®¶çŸ¥é“æˆ‘è¯´ä»€ä¹ˆå°±å¥½ -->

<p>æˆ‘ä»¬ä½¿ç”¨ç»§æ‰¿TextBoxåšè‡ªå·±çš„æ§ä»¶</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">ValidatingTextBox</span> <span class="p">:</span> <span class="n">TextBox</span>

</code></pre></div></div>

<p>æˆ‘ä»¬ä¸Šé¢ç”¨äº†<code class="language-plaintext highlighter-rouge">remainingCharacters</code> <code class="language-plaintext highlighter-rouge">ValidationTextBlock</code> æˆ‘ä»¬éœ€è¦æŠŠå®ƒæ˜¾ç¤º</p>

<p>æˆ‘ä»¬å‘Šè¯‰åæ¥å†™ ControlTemplate æˆ‘ä»¬è¦<code class="language-plaintext highlighter-rouge">remainingCharactersTextBlock</code> <code class="language-plaintext highlighter-rouge">ValidationTextBlock</code>è¿™ä¸¤ä¸ªï¼Œæˆ‘ä»¬ç»™ xaml å†™çš„èµ„æºåå­— RemainingCharactersï¼ŒValidationText ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ OnApplyTemplate è·å¾—è¿™ä¸¤ä¸ªå±æ€§</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnApplyTemplate</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">OnApplyTemplate</span><span class="p">();</span>

            <span class="k">this</span><span class="p">.</span><span class="n">remainingCharacters</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">GetTemplateChild</span><span class="p">(</span><span class="s">"RemainingCharacters"</span><span class="p">)</span> <span class="k">as</span> <span class="n">TextBlock</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">ValidationTextBlock</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">GetTemplateChild</span><span class="p">(</span><span class="s">"ValidationText"</span><span class="p">)</span> <span class="k">as</span> <span class="n">TextBlock</span><span class="p">;</span>
        <span class="p">}</span>    

</code></pre></div></div>

<p>ä½†æˆ‘ä»¬éœ€åœ¨ValidatingTextBox çš„ç±»ä¸Šé¢å†™ä¸‹é¢çš„ä»£ç ï¼Œå‘Šè¯‰ xaml éœ€è¦æœ‰è¿™ä¸¤ä¸ªå±æ€§ï¼Œè™½ç„¶ä¸å†™ä¹Ÿæ˜¯ä¸ä¼šæŠ¥é”™çš„ï¼Œä½†æ˜¯ä¸€èˆ¬éƒ½ä¼šå†™ã€‚</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">[</span><span class="nf">TemplatePart</span><span class="p">(</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"ValidationText"</span><span class="p">,</span> <span class="n">Type</span> <span class="p">=</span> <span class="k">typeof</span><span class="p">(</span><span class="n">TextBlock</span><span class="p">))]</span>
    <span class="p">[</span><span class="nf">TemplatePart</span><span class="p">(</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"RemainingCharacters"</span><span class="p">,</span> <span class="n">Type</span> <span class="p">=</span> <span class="k">typeof</span><span class="p">(</span><span class="n">TextBlock</span><span class="p">))]</span>

</code></pre></div></div>

<p>åƒåœ¾wråšè¿™æ˜¯æ˜¯æ”¯æŒåšç•Œé¢çš„äººå’Œåšé€»è¾‘å¯ä»¥ä¸¤ä¸ªã€‚ï¼Œåšç•Œé¢åªè¦çŸ¥é“æœ‰é‚£äº›æ§ä»¶å°±å¥½
TemplatePart æ˜¯å‘Šè¯‰åšç•Œé¢ï¼Œæˆ‘çš„éœ€è¦åå­—ä¸º Nameï¼Œç±»å‹ä¸ºä»€ä¹ˆçš„æ§ä»¶ï¼Œä½ è¦åšå‰å°å†™è¿™ä¸ªæ§ä»¶ã€‚</p>

<p>å†™å®Œäº†ç•Œé¢ï¼Œæˆ‘ä»¬è¿˜éœ€åŠ äº‹ä»¶ï¼Œè·å¾—æ–‡å­—ä¿®æ”¹</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnApplyTemplate</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">OnApplyTemplate</span><span class="p">();</span>

            <span class="k">this</span><span class="p">.</span><span class="n">remainingCharacters</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">GetTemplateChild</span><span class="p">(</span><span class="s">"RemainingCharacters"</span><span class="p">)</span> <span class="k">as</span> <span class="n">TextBlock</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">ValidationTextBlock</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">GetTemplateChild</span><span class="p">(</span><span class="s">"ValidationText"</span><span class="p">)</span> <span class="k">as</span> <span class="n">TextBlock</span><span class="p">;</span>

            <span class="k">this</span><span class="p">.</span><span class="nf">Update</span><span class="p">();</span>

            <span class="k">if</span> <span class="p">(!</span><span class="k">this</span><span class="p">.</span><span class="n">IsTemplateApplied</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="n">TextChanged</span> <span class="p">+=</span> <span class="k">this</span><span class="p">.</span><span class="n">OnTextChanged</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="n">IsEnabledChanged</span> <span class="p">+=</span> <span class="k">this</span><span class="p">.</span><span class="n">OnIsEnabledChanged</span><span class="p">;</span>

                <span class="k">this</span><span class="p">.</span><span class="n">IsTemplateApplied</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

</code></pre></div></div>

<p>æˆ‘ä»¬è®¾Styleï¼Œä»–æ²¡æœ‰Keyï¼Œè¿™æ ·æ‰€æœ‰çš„æ§ä»¶éƒ½ä½¿ç”¨æˆ‘ä»¬å†™çš„ Style</p>

<p>æˆ‘ä»¬æ–°å»ºä¸€ä¸ªèµ„æºï¼Œåªè¦é‡Œé¢æœ‰<code class="language-plaintext highlighter-rouge">&lt;Style TargetType="controls:ValidatingTextBox"&gt;</code></p>

<p>æˆ‘ä»¬ç”¨æ–°å»ºå‰¯æœ¬ï¼Œç›´æ¥å¤åˆ¶TextBoxçš„Styleï¼Œä¸éœ€è¦åšä»€ä¹ˆä¿®æ”¹ã€‚</p>

<p>æˆ‘ä»¬åœ¨ä¸‹é¢ï¼Œä¿®æ”¹æ˜¾ç¤º</p>

<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªHeadã€ä¸€ä¸ªæ˜¾ç¤ºå­—ç¬¦æ•°ã€ä¸€ä¸ªéªŒè¯ï¼ŒTextBlock</p>

<p>ä½†æ˜¯è¿˜è®°å¾—æˆ‘ä»¬çº¦å®šï¼Œéœ€è¦æ˜¾ç¤ºå­—ç¬¦æ•°çš„åå­—RemainingCharactersï¼Œæ˜¾ç¤ºéªŒè¯åå­—ValidationText</p>

<p>äºæ˜¯æˆ‘ä»¬ä½¿ç”¨å¸ƒå±€ï¼Œç›´æ¥æ”¾TextBlockï¼Œäºæ˜¯æˆ‘ä»¬çš„æ§ä»¶åšå¥½ã€‚</p>

<p>æœ‰ä¸€äº›æ¯”è¾ƒéš¾è¯´æˆ‘æ²¡æœ‰è¯´ï¼Œè¯·å»çœ‹ä»£ç  http://git.oschina.net/lindexi/WinUX-UWP-Toolkit</p>

:ET