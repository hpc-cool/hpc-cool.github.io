I"ğ6<p>æœ¬æ–‡å‘Šè¯‰å¤§å®¶å¦‚ä½•é€šè¿‡ WMI æ‹¿åˆ°æ˜¾å¡ä¿¡æ¯</p>

<!--more-->

<!-- CreateTime:2019/8/31 16:55:58 -->

<!-- æ ‡ç­¾ï¼šdotnet,C#,WMI -->

<p>å¦‚æœä½¿ç”¨çš„æ˜¯ dotnet core è¯·å…ˆå¼•ç”¨ Microsoft.Windows.Compatibility æ‰å¯ä»¥ä½¿ç”¨ WMI ä»£ç </p>

<p>é€šè¿‡ä¸‹é¢çš„ä»£ç å¯ä»¥æ‹¿åˆ°æ‰€æœ‰çš„æ˜¾å¡ä¿¡æ¯</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ManagementObjectSearcher</span> <span class="n">managementObject</span> <span class="p">=</span>
                    <span class="k">new</span> <span class="nf">ManagementObjectSearcher</span><span class="p">(</span><span class="s">"select * from Win32_VideoController"</span><span class="p">);</span>
</code></pre></div></div>

<p>å› ä¸ºæ˜¾å¡æ˜¯å¯èƒ½æœ‰å¾ˆå¤šä¸ªï¼Œé€šè¿‡è¿™ä¸ªä»£ç å°±å¯ä»¥æ‰¾åˆ°æ‰€æœ‰çš„æ˜¾å¡</p>

<p>åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ”¶é›†æ˜¾å¡çš„æŒ‡å®šä¿¡æ¯</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                <span class="kt">var</span> <span class="n">str</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

                <span class="k">foreach</span> <span class="p">(</span><span class="n">ManagementObject</span> <span class="n">m</span> <span class="k">in</span> <span class="n">managementObject</span><span class="p">.</span><span class="nf">Get</span><span class="p">())</span>
                <span class="p">{</span>
                    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">temp</span> <span class="k">in</span> <span class="k">new</span><span class="p">[]</span>
                    <span class="p">{</span>
                        <span class="s">"AcceleratorCapabilities"</span><span class="p">,</span> <span class="c1">//AcceleratorCapabilities Â --å›¾å½¢å’Œè§†é¢‘æ§åˆ¶å™¨çš„ä¸‰ç»´é˜µåˆ—çš„èƒ½åŠ›</span>
                        <span class="s">"AdapterCompatibility"</span><span class="p">,</span> <span class="c1">//AdapterCompatibility Â --ç”¨äºæ­¤æ§åˆ¶å™¨ä¸ç³»ç»Ÿæ¯”è¾ƒå…¼å®¹æ€§ä¸€èˆ¬èŠ¯ç‰‡ç»„</span>
                        <span class="s">"AdapterDACType"</span><span class="p">,</span> <span class="c1">//AdapterDACType Â --å§“åæˆ–æ•°å­— - æ¨¡æ‹Ÿè½¬æ¢å™¨ï¼ˆDACï¼‰èŠ¯ç‰‡çš„æ ‡è¯†ç¬¦</span>
                        <span class="s">"AdapterRAM"</span><span class="p">,</span> <span class="c1">//AdapterRAM Â --è§†é¢‘é€‚é…å™¨çš„å†…å­˜å¤§å°</span>
                        <span class="s">"Availability"</span><span class="p">,</span> <span class="c1">//Availability Â --å¯ç”¨æ€§å’Œè®¾å¤‡çš„çŠ¶æ€</span>
                        <span class="s">"CapabilityDescriptions"</span><span class="p">,</span> <span class="c1">//CapabilityDescriptions Â --è‡ªç”±å½¢å¼å­—ç¬¦ä¸²æä¾›æ›´è¯¦ç»†çš„è§£é‡Šä¸­çš„ä»»ä½•åŠ é€Ÿå™¨èƒ½åŠ›é˜µåˆ—æ‰€æŒ‡ç¤ºçš„è§†é¢‘åŠ é€Ÿå™¨åŠŸèƒ½</span>
                        <span class="s">"Caption"</span><span class="p">,</span> <span class="c1">//Caption Â --å¯¹è±¡çš„ç®€çŸ­æè¿°</span>
<span class="c1">//ColorTableEntries Â --å°ºå¯¸ç³»ç»Ÿçš„è‰²è¡¨</span>
<span class="c1">//ConfigManagerErrorCode Â --Win32çš„é…ç½®ç®¡ç†å™¨é”™è¯¯ä»£ç </span>
<span class="c1">//ConfigManagerUserConfig Â --å¦‚æœä¸ºTRUEï¼Œè¯¥è£…ç½®æ˜¯ä½¿ç”¨ç”¨æˆ·å®šä¹‰çš„é…ç½®</span>
<span class="c1">//CreationClassName Â --ç¬¬ä¸€ä¸ªå…·ä½“ç±»çš„åç§°å‡ºç°åœ¨åˆ›å»ºå®ä¾‹æ‰€ä½¿ç”¨çš„ç»§æ‰¿é“¾</span>
<span class="c1">//CurrentBitsPerPixel Â --ä½¿ç”¨çš„æ¯”ç‰¹æ•°ä»¥æ˜¾ç¤ºæ¯ä¸ªåƒç´ </span>
<span class="c1">//CurrentHorizontalResolution Â --æ°´å¹³åƒç´ çš„å½“å‰æ•°é‡</span>
<span class="c1">//CurrentNumberOfColors Â --åœ¨å½“å‰çš„åˆ†è¾¨ç‡æ”¯æŒçš„è‰²å½©æ•°ç›®</span>
<span class="c1">//CurrentNumberOfColumns Â --æ­¤è§†é¢‘æ§åˆ¶å™¨åˆ—ï¼ˆå¦‚æœåœ¨å­—ç¬¦æ¨¡å¼ä¸‹ï¼‰ç¼–å·</span>
<span class="c1">//CurrentNumberOfRows Â --æ­¤è§†é¢‘æ§åˆ¶å™¨è¡Œï¼ˆå¦‚æœåœ¨å­—ç¬¦æ¨¡å¼ä¸‹ï¼‰ç¼–å·</span>
<span class="c1">//CurrentRefreshRate Â --é¢‘ç‡åœ¨è¯¥è§†é¢‘æ§åˆ¶å™¨åˆ·æ–°ç›‘è§†å™¨çš„å›¾åƒ</span>
<span class="c1">//CurrentScanMode Â --å½“å‰æ‰«ææ¨¡å¼</span>
<span class="c1">//CurrentVerticalResolution Â --å½“å‰å‚ç›´åƒç´ æ•°é‡</span>
<span class="c1">//Description Â --æè¿°</span>
                        <span class="s">"DeviceID"</span><span class="p">,</span> <span class="c1">//DeviceID Â --è¯¥è§†é¢‘æ§åˆ¶å™¨æ ‡è¯†ç¬¦ï¼ˆå”¯ä¸€çš„è®¡ç®—æœºç³»ç»Ÿï¼‰</span>
<span class="c1">//DeviceSpecificPens Â --ç›®å‰è®¸å¤šè®¾å¤‡ä¸“ç”¨ç¬”ã€‚å€¼0xFFFFè¡¨ç¤ºè®¾å¤‡ä¸æ”¯æŒç¬”ã€‚</span>
<span class="c1">//DitherType Â --æŠ–åŠ¨å‹è§†é¢‘æ§åˆ¶å™¨</span>
                        <span class="s">"DriverDate"</span><span class="p">,</span> <span class="c1">//DriverDate Â --å½“å‰å·²å®‰è£…çš„è§†é¢‘é©±åŠ¨ç¨‹åºçš„æœ€åä¿®æ”¹æ—¥æœŸå’Œæ—¶é—´</span>
                        <span class="s">"DriverVersion"</span><span class="p">,</span> <span class="c1">//DriverVersion Â --è§†é¢‘é©±åŠ¨ç¨‹åºçš„ç‰ˆæœ¬å·</span>
<span class="c1">//ErrorCleared Â --å¦‚æœä¸ºçœŸï¼ŒæŠ¥ä¸Šä¸€ä¸ªé”™è¯¯ä»£ç å±æ€§ä¸­çš„é”™è¯¯ç°å·²æ¸…é™¤</span>
<span class="c1">//ErrorDescription Â --å¯èƒ½é‡‡å–çš„çº æ­£æªæ–½å­—ç¬¦ä¸²æä¾›æœ‰å…³è®°å½•åœ¨ä¸€ä¸ªé”™è¯¯ä»£ç å±æ€§é”™è¯¯çš„è¯¦ç»†ä¿¡æ¯</span>
<span class="c1">//ICMIntent Â --åº”ä½¿ç”¨é»˜è®¤ä¸‰ç§å¯èƒ½çš„é…è‰²æ–¹æ³•æˆ–æ„å›¾ä¸­çš„ä¸€ä¸ªç‰¹å®šå€¼</span>
<span class="c1">//ICMMethod Â --å¤„ç†ICMæ–¹æ³•ã€‚å¯¹äºéICMçš„åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªå±æ€§å†³å®šäº†ICMæ˜¯å¦å·²å¯ç”¨å¯¹äºICMçš„åº”ç”¨ç¨‹åºï¼Œç³»ç»Ÿå°†æ£€æŸ¥æ­¤å±æ€§æ¥ç¡®å®šå¦‚ä½•å¤„ç†ICMæ”¯æŒ</span>
<span class="c1">//InfFilename Â --è§†é¢‘é€‚é…å™¨çš„è·¯å¾„.infæ–‡ä»¶</span>
<span class="c1">//InfSection Â --Windowsçš„è§†é¢‘ä¿¡æ¯æ‰€åœ¨çš„.infæ–‡ä»¶</span>
                        <span class="s">"InstallDate"</span><span class="p">,</span> <span class="c1">//InstallDate Â --å®‰è£…çš„æ—¥æœŸ</span>
                        <span class="s">"InstalledDisplayDrivers"</span><span class="p">,</span> <span class="c1">//InstalledDisplayDrivers Â --å·²å®‰è£…çš„æ˜¾ç¤ºè®¾å¤‡é©±åŠ¨ç¨‹åºçš„åç§°</span>
<span class="c1">//LastErrorCode Â --æŠ¥å‘Šçš„é€»è¾‘è®¾å¤‡ä¸Šä¸€ä¸ªé”™è¯¯ä»£ç Â </span>
<span class="c1">//MaxMemorySupported Â --ä»¥å­—èŠ‚ä¸ºå•ä½æ”¯æŒçš„å†…å­˜æœ€é«˜é™é¢</span>
<span class="c1">//MaxNumberControlled Â --å¯æ”¯æŒé€šè¿‡è¯¥æ§åˆ¶å™¨å¯ç›´æ¥å¯»å€çš„å®ä½“çš„æœ€å¤§æ•°é‡</span>
<span class="c1">//MaxRefreshRate Â --åœ¨èµ«å…¹è§†é¢‘æ§åˆ¶å™¨çš„æœ€å¤§åˆ·æ–°ç‡</span>
<span class="c1">//MinRefreshRate Â  --åœ¨èµ«å…¹è§†é¢‘æ§åˆ¶å™¨çš„æœ€å°åˆ·æ–°ç‡</span>
<span class="c1">//Monochrome Â --å¦‚æœæ˜¯TRUEï¼Œç°é˜¶ç”¨äºæ˜¾ç¤ºå›¾åƒã€‚</span>
<span class="c1">//Name Â --æ ‡ç­¾ç”±è¯¥å¯¹è±¡æ˜¯å·²çŸ¥çš„ã€‚å½“å­ç±»ï¼Œè¯¥å±æ€§å¯ä»¥è¢«è¦†ç›–æ˜¯ä¸€ä¸ªå…³é”®å±æ€§ã€‚</span>
<span class="c1">//NumberOfColorPlanes Â --å½“å‰ä¸€äº›é¢œè‰²å¹³é¢ã€‚å¦‚æœè¯¥å€¼ä¸é€‚ç”¨äºå½“å‰è§†é¢‘çš„é…ç½®ï¼Œè¾“å…¥0ï¼ˆé›¶ï¼‰</span>
<span class="c1">//NumberOfVideoPages Â --å½“å‰çš„åˆ†è¾¨ç‡å’Œå¯ç”¨å†…å­˜æ”¯æŒè§†é¢‘é¡µæ•°</span>
<span class="c1">//PNPDeviceID Â --å³æ’å³ç”¨é€»è¾‘è®¾å¤‡çš„æ’­æ”¾è£…ç½®è¯†åˆ«ç¬¦</span>
<span class="c1">//PowerManagementCapabilities Â --é€»è¾‘è®¾å¤‡çš„ç‰¹å®šåŠŸç‡ç›¸å…³çš„èƒ½åŠ›é˜µåˆ—</span>
<span class="c1">//PowerManagementSupported Â --å¦‚æœä¸ºTRUEï¼Œè¯¥è£…ç½®å¯ä»¥æ˜¯ç”µæºç®¡ç†ï¼ˆå¯ä»¥æŠ•å…¥æŒ‚èµ·æ¨¡å¼ï¼Œç­‰ç­‰ï¼‰</span>
<span class="c1">//ProtocolSupported Â --ç”±æ§åˆ¶å™¨ä½¿ç”¨åè®®è®¿é—®â€œæ§åˆ¶â€çš„è®¾å¤‡</span>
<span class="c1">//ReservedSystemPaletteEntries Â --ç³»ç»Ÿè°ƒè‰²æ¿ä¿ç•™çš„æ¡ç›®æ•°</span>
<span class="c1">//SpecificationVersion Â --åˆå§‹åŒ–æ•°æ®è§„èŒƒçš„ç‰ˆæœ¬å·ï¼ˆåœ¨å…¶ä¸Šçš„ç»“æ„çš„åŸºç¡€ï¼‰</span>
<span class="c1">//Status Â --å¯¹è±¡çš„å½“å‰çŠ¶æ€</span>
<span class="c1">//StatusInfo Â --å¯¹è±¡çš„å½“å‰çŠ¶æ€è¯¦ç»†ä¿¡æ¯</span>
<span class="c1">//SystemCreationClassName Â --è¯¥ä½œç”¨åŸŸè®¡ç®—æœºçš„åˆ›å»ºç±»åˆ«åç§°å±æ€§çš„å€¼</span>
<span class="c1">//SystemName Â --ç³»ç»Ÿçš„åç§°</span>
<span class="c1">//SystemPaletteEntries Â --å½“å‰ä¸€äº›ç³»ç»Ÿè°ƒè‰²æ¿é¢œè‰²ç´¢å¼•æ¡ç›®</span>
<span class="c1">//TimeOfLastReset Â --è¯¥æ§åˆ¶å™¨æ˜¯æœ€åä¸€æ¬¡å¤ä½æ—¥æœŸå’Œæ—¶é—´ï¼Œè¿™å¯èƒ½æ„å‘³ç€è¯¥æ§åˆ¶å™¨è¢«æ–­ç”µæˆ–é‡æ–°åˆå§‹åŒ–</span>
<span class="c1">//VideoArchitecture Â --è§†é¢‘ä½“ç³»ç»“æ„çš„ç±»å‹</span>
                        <span class="c1">//"VideoMemoryType", //VideoMemoryType Â --æ˜¾å­˜ç±»å‹</span>
<span class="c1">//VideoMode Â --å½“å‰è§†é¢‘æ¨¡å¼</span>
<span class="c1">//VideoModeDescription Â --å½“å‰çš„åˆ†è¾¨ç‡ï¼Œé¢œè‰²å’Œè§†é¢‘æ§åˆ¶å™¨çš„æ‰«ææ¨¡å¼è®¾ç½®</span>
<span class="c1">//VideoProcessor Â --æ— æ ¼å¼çš„å­—ç¬¦ä¸²æè¿°è§†é¢‘å¤„ç†å™¨</span>
                    <span class="p">})</span>
                    <span class="p">{</span>
                        <span class="n">str</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">temp</span><span class="p">);</span>
                        <span class="n">str</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">" "</span><span class="p">);</span>
                        <span class="n">str</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">temp</span><span class="p">]?.</span><span class="nf">ToString</span><span class="p">()</span> <span class="p">??</span> <span class="s">""</span><span class="p">);</span>
                        <span class="n">str</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">"\n"</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="k">return</span> <span class="n">str</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
</code></pre></div></div>

<p>å› ä¸ºæ˜¾å¡çš„å¾ˆå¤šä¿¡æ¯éƒ½æ˜¯ä¸éœ€è¦çš„ï¼Œæ‰€ä»¥å°±æ³¨é‡Šäº†ï¼Œå°ä¼™ä¼´å¯ä»¥æ‹¿åˆ°è‡ªå·±éœ€è¦çš„ä¿¡æ¯</p>

<p>è¿è¡Œä¸Šé¢çš„ä»£ç å¤§æ¦‚å¯ä»¥æ‹¿åˆ°è¿™äº›ä¿¡æ¯</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">AcceleratorCapabilities</span> <span class="p">:</span>
<span class="n">AdapterCompatibility</span>    <span class="p">:</span> <span class="n">Intel</span> <span class="n">Corporation</span>
<span class="n">AdapterDACType</span>          <span class="p">:</span> <span class="n">Internal</span>
<span class="n">AdapterRAM</span>              <span class="p">:</span> <span class="m">1073741824</span>
<span class="n">Availability</span>            <span class="p">:</span> <span class="m">3</span>
<span class="n">CapabilityDescriptions</span>  <span class="p">:</span>
<span class="n">Caption</span>                 <span class="p">:</span> <span class="nf">Intel</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="n">HD</span> <span class="n">Graphics</span> <span class="m">530</span>
<span class="n">DeviceID</span>                <span class="p">:</span> <span class="n">VideoController1</span>
<span class="n">DriverDate</span>              <span class="p">:</span> <span class="m">20181119000000.000000</span><span class="p">-</span><span class="m">000</span>
<span class="n">DriverVersion</span>           <span class="p">:</span> <span class="m">23.20</span><span class="p">.</span><span class="m">16.4973</span>
<span class="n">InstallDate</span>             <span class="p">:</span>
<span class="n">InstalledDisplayDrivers</span> <span class="p">:</span> <span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">WINDOWS</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">DriverStore</span><span class="err">\</span><span class="n">FileRepository</span><span class="err">\</span><span class="n">igdlh64</span><span class="p">.</span><span class="n">inf_amd64_2c92d70c30b8effe</span><span class="err">\</span><span class="n">igdumdim64</span><span class="p">.</span>
                          <span class="n">dll</span><span class="p">,</span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">WINDOWS</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">DriverStore</span><span class="err">\</span><span class="n">FileRepository</span><span class="err">\</span><span class="n">igdlh64</span><span class="p">.</span><span class="n">inf_amd64_2c92d70c30b8effe</span><span class="err">\</span><span class="n">igd10iu</span>
                          <span class="n">md64</span><span class="p">.</span><span class="n">dll</span><span class="p">,</span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">WINDOWS</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">DriverStore</span><span class="err">\</span><span class="n">FileRepository</span><span class="err">\</span><span class="n">igdlh64</span><span class="p">.</span><span class="n">inf_amd64_2c92d70c30b8effe</span><span class="err">\</span><span class="n">ig</span>
                          <span class="n">d10iumd64</span><span class="p">.</span><span class="n">dll</span><span class="p">,</span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">WINDOWS</span><span class="err">\</span><span class="n">System32</span><span class="err">\</span><span class="n">DriverStore</span><span class="err">\</span><span class="n">FileRepository</span><span class="err">\</span><span class="n">igdlh64</span><span class="p">.</span><span class="n">inf_amd64_2c92d70c30b8ef</span>
                          <span class="n">fe</span><span class="err">\</span><span class="n">igd12umd64</span><span class="p">.</span><span class="n">dll</span>
</code></pre></div></div>

<p>é€šè¿‡ Caption å’Œé©±åŠ¨å®‰è£…æ—¶é—´å°±å¯ä»¥çŸ¥é“å½“å‰çš„æ˜¾å¡é©±åŠ¨</p>

:ET