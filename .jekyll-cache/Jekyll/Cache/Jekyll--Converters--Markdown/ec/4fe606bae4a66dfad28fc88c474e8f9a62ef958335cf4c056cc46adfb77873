I"ˆ;<p>æœ¬æ–‡å‘Šè¯‰å¤§å®¶å¦‚ä½•ä½¿ç”¨å¤šä¸ªæ–¹å¼è®¿é—®ç½‘é¡µï¼Œå¯ä»¥è·å¾—ç½‘é¡µæºä»£ç ï¼Œå¯ä»¥åšçˆ¬å–ç½‘ç»œä¿¡æ¯ã€‚</p>

<!--more-->

<!-- CreateTime:2018/8/10 19:16:51 -->

<div id="toc"></div>
<!-- csdn -->

<p>Windows10 UWP è¦è®¿é—® csdnåšå®¢ï¼Œå¯ä»¥ä½¿ç”¨<code class="language-plaintext highlighter-rouge">Windows.Web.Http.HttpClient</code>ï¼Œä¸‹é¢å°è¯•è®¿é—®ä¸€ä¸‹æˆ‘çš„åšå®¢ <a href="http://blog.csdn.net/lindexi_gd/article/details/50392343">http://blog.csdn.net/lindexi_gd/article/details/50392343</a></p>

<p>æˆ‘å…ˆåœ¨ xaml æ·»åŠ ä¸€ä¸ª TextBlock ï¼Œè¿™ä¸ª TextBlock æ˜¯ <code class="language-plaintext highlighter-rouge">tb</code> ç”¨æ¥æ‹¿åˆ°æˆ‘è®¿é—®é¡µé¢æ‹¿åˆ°çš„å†…å®¹</p>

<pre><code class="language-C#">
            string str = "http://blog.csdn.net/lindexi_gd/article/details/50392343";

            using (Windows.Web.Http.HttpClient client = new Windows.Web.Http.HttpClient())

            {

                try

                {

                    Windows.Web.Http.HttpResponseMessage response = await client.GetAsync(new Uri(str));

                    if (response != null &amp;&amp; response.StatusCode == Windows.Web.Http.HttpStatusCode.Ok)

                    {

                        using (Windows.Storage.Streams.InMemoryRandomAccessStream stream = new Windows.Storage.Streams.InMemoryRandomAccessStream())

                        {

                            await response.Content.WriteToStreamAsync(stream);

                            stream.Seek(0);                            

                            Windows.Storage.Streams.Buffer buffer = new Windows.Storage.Streams.Buffer((uint)stream.Size);

                            await stream.ReadAsync(buffer, (uint)stream.Size, Windows.Storage.Streams.InputStreamOptions.Partial);

                            using (Windows.Storage.Streams.DataReader dataReader = Windows.Storage.Streams.DataReader.FromBuffer(buffer))

                            {

                                tb.Text = dataReader.ReadString((uint)stream.Size);

                            }

                        }

                    }

                }

                catch

                {

                }

</code></pre>

<p>åœ¨å‰å°æœ‰ä¸€ä¸ªTextBlockï¼Œåå­—æ˜¯ tb ï¼Œç•Œé¢è¿˜æœ‰ä¸€ä¸ª æŒ‰é’®ï¼ŒæŒ‰é’®ç‚¹å‡»è§¦å‘ä¸Šé¢ä»£ç ï¼Œè®¿é—®åšå®¢ï¼Œå¾—åˆ°çš„å†…å®¹æ”¾åœ¨ tb æ˜¾ç¤º</p>

<p>è¿™æ—¶æŒ‰ä¸‹ F5 è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ç•Œé¢</p>

<p><img src="http://image.acmx.xyz/AwCCAwMAItoFAMV%2BBQA28wYAAQAEAK4%2BAQBmQwIAaOgJAOjZ%2F201732119010.jpg" alt="" /></p>

<p>é™¤äº† httpClient è¿˜å¯ä»¥ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">HttpWebRequest</code> ï¼Œè¯·çœ‹ä¸‹é¢</p>

<pre><code class="language-C#">
            System.Net.HttpWebRequest request = null;

            request = System.Net.WebRequest.Create(str) as System.Net.HttpWebRequest;

            request.Accept = "text/html, application/xhtml+xml, image/jxr, */*";
            //æœ‰äº›ç½‘ç«™éœ€è¦ Accept å¦‚æœè¿™ä¸ªä¸å¯¹ï¼Œä¸è¿”å›

            request.Method = "GET";

            request.CookieContainer = new System.Net.CookieContainer();

            try

            {

                System.Net.HttpWebResponse response = (System.Net.HttpWebResponse)await request.GetResponseAsync();

                if (response != null &amp;&amp; response.StatusCode==System.Net.HttpStatusCode.OK)

                {

                    tb.Text = response.ContentLength.ToString();

                    using (Stream stream= response.GetResponseStream())

                    {

                        byte[] buffer = new byte[10240];
                        //å®é™…å¯ä»¥ç”¨å…¶ä»–æ–¹æ³•

                        stream.Read(buffer, 0, 10240);

                        tb.Text = System.Text.Encoding.UTF8.GetString(buffer);
                        //åœ¨å“ªçŸ¥é“æ˜¯UTF8ï¼Ÿå®é™…ä¸Šè§£æç½‘é¡µè¿™é‡Œæ¯”è¾ƒéš¾ï¼Œæˆ‘ç”¨çš„æ˜¯çŸ¥é“ä»–æ˜¯ UTF8

                    }

                }

            }

            catch

            {

            }

</code></pre>

<p><img src="http://image.acmx.xyz/AwCCAwMAItoFAMV%2BBQA28wYAAQAEAK4%2BAQBmQwIAaOgJAOjZ%2F201732119047.jpg" alt="" /></p>

<p>éœ€è¦æ³¨æ„ <code class="language-plaintext highlighter-rouge">Windows.Web.Http.HttpClient</code> å’Œ <code class="language-plaintext highlighter-rouge">System.Net.Http.HttpClient</code> æ˜¯ä¸ç›¸åŒï¼Œè¯·çœ‹<a href="https://www.cnblogs.com/mushroom/p/5079964.html">æ­ç§˜Windows10 UWPä¸­çš„httpclientæ¥å£[2] - è˜‘è‡å…ˆç”Ÿ - åšå®¢å›­</a> å’Œ void å¤§ç¥å†™çš„ <a href="https://validvoid.net/demystifying-httpclient-apis-in-the-uwp/">è¯¦è§£ UWP (é€šç”¨ Windows å¹³å°) ä¸­çš„ä¸¤ç§ HttpClient API</a></p>

<h2 id="è®¾ç½®ä»£ç†">è®¾ç½®ä»£ç†</h2>

<p>ç°åœ¨çš„ UWP ç¨‹åºåªèƒ½ä½¿ç”¨ IE çš„ä»£ç†ï¼Œè€Œä¸èƒ½è‡ªå®šä¹‰ä»£ç†ï¼Œè™½ç„¶å­˜åœ¨ httpClientHandler.Proxy å¯ä»¥è®¾ç½® IWebProxy ï¼Œæˆ‘ä¹Ÿå°è¯•å†™äº†è‡ªå·±çš„æœ¬åœ°ä»£ç†ï¼Œä½†æ˜¯æ²¡æœ‰è®¿é—®</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">public</span> <span class="k">class</span> <span class="nc">WebProxy</span> <span class="p">:</span> <span class="n">IWebProxy</span>
    <span class="p">{</span>
        <span class="c1">/// &lt;inheritdoc /&gt;</span>
        <span class="k">public</span> <span class="n">Uri</span> <span class="nf">GetProxy</span><span class="p">(</span><span class="n">Uri</span> <span class="n">destination</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="s">"socks5://127.0.0.1:10112"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;inheritdoc /&gt;</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">IsBypassed</span><span class="p">(</span><span class="n">Uri</span> <span class="n">host</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;inheritdoc /&gt;</span>
        <span class="k">public</span> <span class="n">ICredentials</span> <span class="n">Credentials</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>æˆ‘åœ¨ GetProxy ä½¿ç”¨æ–­ç‚¹ï¼Œåœ¨ä½¿ç”¨ä¸‹é¢ä»£ç è¿è¡Œï¼Œæ²¡æœ‰è¿›å…¥åˆšæ‰å†™çš„å‡½æ•°</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            <span class="kt">var</span> <span class="n">httpClientHandler</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClientHandler</span><span class="p">();</span>
            <span class="n">httpClientHandler</span><span class="p">.</span><span class="n">UseProxy</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">httpClientHandler</span><span class="p">.</span><span class="n">Proxy</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebProxy</span><span class="p">();</span>

            <span class="kt">var</span> <span class="n">httpClient</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">(</span><span class="n">httpClientHandler</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">str</span> <span class="p">=</span> <span class="k">await</span> <span class="n">httpClient</span><span class="p">.</span><span class="nf">GetStringAsync</span><span class="p">(</span><span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="s">"https://www.google.com"</span><span class="p">));</span>

            <span class="n">Debug</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="webview">WebView</h2>

<p>è¿˜æœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ WebView å°±æ˜¯ Edge æµè§ˆå™¨ï¼Œæ‰€ä»¥é€šè¿‡æµè§ˆå™¨å¯ä»¥åšå‡ºæ›´å¼ºå¤§çš„æ•ˆæœã€‚</p>

<p>å…ˆåœ¨ç•Œé¢æ·»åŠ ä¸€ä¸ªæŒ‰é’®å’Œæ§ä»¶</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="p">&lt;</span><span class="n">WebView</span> <span class="n">x</span><span class="p">:</span><span class="n">Name</span><span class="p">=</span><span class="s">"TraymorxasluPoocigur"</span><span class="p">&gt;&lt;/</span><span class="n">WebView</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">Button</span> <span class="n">HorizontalAlignment</span><span class="p">=</span><span class="s">"Center"</span> <span class="n">Content</span><span class="p">=</span><span class="s">"ç¡®å®š"</span> <span class="n">Click</span><span class="p">=</span><span class="s">"FersamaltaiJearxaltray_OnClick"</span><span class="p">&gt;&lt;/</span><span class="n">Button</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>åœ¨æŒ‰é’®ç‚¹å‡»çš„æ—¶å€™ï¼Œå°è¯•ä¸‹é¢å‡ ä¸ªæ–¹å¼è®¿é—®ç½‘é¡µ</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">FersamaltaiJearxaltray_OnClick</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">TraymorxasluPoocigur</span><span class="p">.</span><span class="nf">Navigate</span><span class="p">(</span><span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="s">"http://lindexi.github.io"</span><span class="p">));</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>è®¿é—®è§£å†³æ–¹æ¡ˆèµ„æº</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">void</span> <span class="nf">FersamaltaiJearxaltray_OnClick</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">TraymorxasluPoocigur</span><span class="p">.</span><span class="nf">Navigate</span><span class="p">(</span><span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="s">"ms-appx:///æ—å¾·ç†™.html"</span><span class="p">));</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">Debug</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">exception</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>å‚è§ï¼š<a href="https://lindexi.gitee.io/post/win10-uwp-%E8%AE%BF%E9%97%AE%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E6%96%87%E4%BB%B6.html">win10 uwp è®¿é—®è§£å†³æ–¹æ¡ˆæ–‡ä»¶</a></p>

<p>è®¿é—®æœ¬åœ°çš„æ–‡ä»¶</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                <span class="kt">var</span> <span class="n">file</span> <span class="p">=</span> <span class="k">await</span> <span class="n">StorageFile</span><span class="p">.</span><span class="nf">GetFileFromApplicationUriAsync</span><span class="p">(</span><span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="s">"ms-appx:///æ—å¾·ç†™.html"</span><span class="p">));</span>

                <span class="kt">var</span> <span class="n">folder</span> <span class="p">=</span> <span class="n">ApplicationData</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">LocalFolder</span><span class="p">;</span>

                <span class="kt">var</span> <span class="n">str</span> <span class="p">=</span> <span class="k">await</span> <span class="n">FileIO</span><span class="p">.</span><span class="nf">ReadTextAsync</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

                <span class="n">file</span> <span class="p">=</span> <span class="k">await</span> <span class="n">folder</span><span class="p">.</span><span class="nf">CreateFileAsync</span><span class="p">(</span><span class="s">"æ—å¾·ç†™.html"</span><span class="p">,</span> <span class="n">CreationCollisionOption</span><span class="p">.</span><span class="n">ReplaceExisting</span><span class="p">);</span>

                <span class="k">await</span> <span class="n">FileIO</span><span class="p">.</span><span class="nf">WriteTextAsync</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>

                <span class="n">TraymorxasluPoocigur</span><span class="p">.</span><span class="nf">Navigate</span><span class="p">(</span><span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="s">"ms-appdata:///local/æ—å¾·ç†™.html"</span><span class="p">));</span>
</code></pre></div></div>

<p>è®¿é—®å­—ç¬¦ä¸²</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                <span class="kt">var</span> <span class="n">file</span> <span class="p">=</span> <span class="k">await</span> <span class="n">StorageFile</span><span class="p">.</span><span class="nf">GetFileFromApplicationUriAsync</span><span class="p">(</span><span class="k">new</span> <span class="nf">Uri</span><span class="p">(</span><span class="s">"ms-appx:///æ—å¾·ç†™.html"</span><span class="p">));</span>

                <span class="kt">var</span> <span class="n">str</span> <span class="p">=</span> <span class="k">await</span> <span class="n">FileIO</span><span class="p">.</span><span class="nf">ReadTextAsync</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

                <span class="n">TraymorxasluPoocigur</span><span class="p">.</span><span class="nf">NavigateToString</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</code></pre></div></div>

<p>å‚è§ï¼š
<a href="https://lindexi.oschina.io/lindexi/post/win10-uwp-%E6%A8%A1%E6%8B%9F%E7%BD%91%E9%A1%B5%E8%BE%93%E5%85%A5.html">win10 uwp æ¨¡æ‹Ÿç½‘é¡µè¾“å…¥</a></p>

<p><a href="https://blog.csdn.net/lindexi_gd/article/details/72516802">å¦‚ä½•ä½¿ç”¨ C# çˆ¬è™«è·å¾—ä¸“æ åšå®¢æ›´æ–°æ’è¡Œ - CSDNåšå®¢</a></p>

:ET