I"í<p>æœ¬æ–‡è®°å½•ä¸€äº›å¸¸è§çš„ä½¿ç”¨ EF Core çš„é—®é¢˜</p>

<!--more-->

<!-- CreateTime:2020/3/15 15:06:19 -->

<h2 id="ç‰ˆæœ¬å¤ªä½">ç‰ˆæœ¬å¤ªä½</h2>

<p>æ‰§è¡Œå‘½ä»¤<code class="language-plaintext highlighter-rouge">dotnet ef migrations add lindexi.github.io</code>æ˜¾ç¤ºä¸‹é¢ä»£ç </p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet ef --info
It was not possible to find any compatible framework version
The framework 'Microsoft.NETCore.App', version '3.1.2' was not found.
  - The following frameworks were found:
      2.1.12 at [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
      2.1.14 at [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
      2.1.15 at [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
      2.2.6 at [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
      2.2.7 at [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
      3.0.0 at [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
      3.0.2 at [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
      3.1.0 at [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
      3.1.1 at [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]

You can resolve the problem by installing the specified framework and/or SDK.

The specified framework can be found at:
  - https://aka.ms/dotnet-core-applaunch?framework=Microsoft.NETCore.App&amp;framework_version=3.1.2&amp;arch=x64&amp;rid=win10-x64
</code></pre></div></div>

<p>æ­¤é—®é¢˜è¦ä¹ˆ EF ç‰ˆæœ¬ä¸å¯¹ï¼Œè¦ä¹ˆ SDK ç‰ˆæœ¬å¤ªä½ï¼Œè§£å†³æ–¹æ³•æ˜¯æ›´æ–° EF å’Œæ›´æ–° SDK ç‰ˆæœ¬</p>

<p>å¯ä»¥ä½¿ç”¨æˆ‘çš„ä¸€ä¸ªå·¥å…·ååŠ©æ›´æ–° EF ç‰ˆæœ¬ï¼Œè¿™ä¸ªå·¥å…·èƒ½æ›´æ–°æ‰€æœ‰å·¥å…·çš„ç‰ˆæœ¬ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹</p>

<ol>
  <li>é€šè¿‡ä¸‹é¢ä»£ç å®‰è£… <code class="language-plaintext highlighter-rouge">dotnet tool install -g dotnetCampus.UpdateAllDotNetTools </code> æ­¤åä½¿ç”¨ä¸ç”¨å†æ¬¡å®‰è£…</li>
  <li>é€šè¿‡ä¸‹é¢ä»£ç æ›´æ–°æ‰€æœ‰å·¥å…· <code class="language-plaintext highlighter-rouge">dotnet updatealltools</code></li>
</ol>

<p>å…¶æ¬¡è¿›å…¥ <a href="https://dotnet.microsoft.com/">https://dotnet.microsoft.com/</a> ä¸‹è½½å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ SDK å°±å¯ä»¥</p>

<h2 id="ä»£ç æ„å»ºä¸é€šè¿‡">ä»£ç æ„å»ºä¸é€šè¿‡</h2>

<p>ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">dotnet ef</code> ç¬¬ä¸€ä»¶äº‹å°±æ˜¯æ‰§è¡Œæ„å»ºï¼Œå¦‚æœæ­¤æ—¶çš„ä»£ç æ„å»ºä¸é€šè¿‡ï¼Œé‚£ä¹ˆè‡ªç„¶å¤±è´¥</p>

<p>è¯·åœ¨è¿ç§»å¤±è´¥æ—¶å°è¯•ç”¨ <code class="language-plaintext highlighter-rouge">dotnet build</code> çœ‹æ˜¯å¦èƒ½æ„å»ºé€šè¿‡</p>

<h2 id="æ²¡æœ‰é…ç½®è·¯å¾„">æ²¡æœ‰é…ç½®è·¯å¾„</h2>

<p>å¦‚ä½¿ç”¨ Sqlite éœ€è¦åœ¨ ConfigureServices é‡Œé¢å…ˆé…ç½®å¥½æ•°æ®åº“è·¯å¾„ï¼Œå¦‚ä¸‹é¢ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<p>å¦åˆ™ä¼šæœ‰å¦‚ä¸‹æç¤º</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>System.InvalidOperationException: Unable to resolve service for type 'Microsoft.EntityFrameworkCore.Migrations.IMigrator'. This is often because no database provider has been configured for this DbContext. A provider can be configured by overriding the DbContext.OnConfiguring method or by using AddDbContext on the application service provider. If AddDbContext is used, then also ensure that your DbContext type accepts a DbContextOptions&lt;TContext&gt; object in its constructor and passes it to the base constructor for DbContext.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.InfrastructureExtensions.GetService[TService](IInfrastructure`1 accessor)
   at Microsoft.EntityFrameworkCore.Infrastructure.AccessorExtensions.GetService[TService](IInfrastructure`1 accessor)
   at Microsoft.EntityFrameworkCore.Design.DesignTimeServiceCollectionExtensions.&lt;&gt;c__DisplayClass1_0.&lt;AddDbContextDesignTimeServices&gt;b__7(IServiceProvider _)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitDisposeCache(ServiceCallSite transientCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.&lt;&gt;c__DisplayClass1_0.&lt;RealizeService&gt;b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.GetService(Type serviceType, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
   at Microsoft.EntityFrameworkCore.Design.Internal.MigrationsOperations.EnsureServices(IServiceProvider services)
   at Microsoft.EntityFrameworkCore.Design.Internal.MigrationsOperations.AddMigration(String name, String outputDir, String contextType)
   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.AddMigrationImpl(String name, String outputDir, String contextType)
   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.AddMigration.&lt;&gt;c__DisplayClass0_0.&lt;.ctor&gt;b__0()
   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.&lt;&gt;c__DisplayClass3_0`1.&lt;Execute&gt;b__0()
   at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.Execute(Action action)
Unable to resolve service for type 'Microsoft.EntityFrameworkCore.Migrations.IMigrator'. This is often because no database provider has been configured for this DbContext. A provider can be configured by overriding the DbContext.OnConfiguring method or by using AddDbContext on the application service provider. If AddDbContext is used, then also ensure that your DbContext type accepts a DbContextOptions&lt;TContext&gt; object in its constructor and passes it to the base constructor for DbContext.
</code></pre></div></div>

:ET