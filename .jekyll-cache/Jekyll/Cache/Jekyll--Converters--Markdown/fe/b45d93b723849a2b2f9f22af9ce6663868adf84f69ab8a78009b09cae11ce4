I"”h<p>åœ¨ UWP æ˜¯ä¸æ”¯æŒåœ¨ Setter é‡Œé¢çš„ Value è¿›è¡Œç»‘å®šï¼Œå¦‚æœæƒ³è¦åœ¨ ItemsPanelTemplate é‡Œé¢ç»‘å®šæ˜¾ç¤ºæ–¹å‘ï¼Œé‚£ä¹ˆéœ€è¦é€šè¿‡é™„åŠ å±æ€§çš„æ–¹æ³•ç»‘å®šã€‚å¦‚æœåœ¨åå°ä»£ç å®šä¹‰äº† Orientation å±æ€§æƒ³è¦åœ¨ xaml ç»‘å®šåˆ° ListView çš„æ ·å¼ï¼Œå¯ä»¥å°è¯•å¤šåˆ›å»ºä¸€ä¸ªå¸®åŠ©å±æ€§ï¼Œç”¨äºåœ¨é‡Œé¢ç»‘å®š</p>

<!--more-->

<!-- CreateTime:2019/3/16 10:28:44 -->

<!-- csdn -->
<div id="toc"></div>

<p>æˆ‘åœ¨åå°ä»£ç å®šä¹‰äº†å±æ€§ Orientation è¯·çœ‹ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">public</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">DependencyProperty</span> <span class="n">OrientationProperty</span> <span class="p">=</span> <span class="n">DependencyProperty</span><span class="p">.</span><span class="nf">Register</span><span class="p">(</span>
            <span class="s">"Orientation"</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">Orientation</span><span class="p">),</span> <span class="k">typeof</span><span class="p">(</span><span class="n">MainPage</span><span class="p">),</span> <span class="k">new</span> <span class="nf">PropertyMetadata</span><span class="p">(</span><span class="k">default</span><span class="p">(</span><span class="n">Orientation</span><span class="p">)));</span>

        <span class="k">public</span> <span class="n">Orientation</span> <span class="n">Orientation</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="n">Orientation</span><span class="p">)</span> <span class="nf">GetValue</span><span class="p">(</span><span class="n">OrientationProperty</span><span class="p">);</span> <span class="p">}</span>
            <span class="k">set</span> <span class="p">{</span> <span class="nf">SetValue</span><span class="p">(</span><span class="n">OrientationProperty</span><span class="p">,</span> <span class="k">value</span><span class="p">);</span> <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>æˆ‘åœ¨ xaml æœ‰ä¸€ä¸ª ListView å‡†å¤‡å°† Orientation ç»‘å®šåˆ° ListView çš„ ItemsPanel é€šè¿‡ä¸€ä¸ªæ ·å¼</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="n">Setter</span> <span class="n">Property</span><span class="p">=</span><span class="s">"ItemsPanel"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">Setter</span><span class="p">.</span><span class="n">Value</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">ItemsPanelTemplate</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="n">ItemsStackPanel</span> <span class="n">Orientation</span><span class="p">=</span><span class="s">"{Binding Orientation, RelativeSource={RelativeSource Mode=TemplatedParent}}"</span><span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="n">ItemsPanelTemplate</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="n">Setter</span><span class="p">.</span><span class="n">Value</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">Setter</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>åœ¨å¼€å§‹ç»‘å®šçš„æ—¶å€™ï¼Œæ²¡æœ‰æç¤ºä»»ä½•ä¿¡æ¯ï¼Œä¹Ÿæ²¡æœ‰ç»‘å®šæˆåŠŸ</p>

<p>å› ä¸ºåœ¨ <a href="https://docs.microsoft.com/en-us/uwp/api/Windows.UI.Xaml.Setter#Windows_UI_Xaml_Setter_Value">Setter Class (Windows.UI.Xaml) - Windows UWP applications</a> è¯´åˆ°åœ¨ UWP æ˜¯ä¸æ”¯æŒåœ¨ Setting çš„ Value ç»‘å®šï¼Œè¿™ä¸ªå’Œ WPF ä¸ç›¸åŒï¼Œå»ºè®®ä½¿ç”¨é™æ€çš„èµ„æº</p>

<blockquote>
  <p>Windows Presentation Foundation (WPF) and Microsoft Silverlight supported the ability to use a Binding expression to supply the Value for a Setter in a Style. The Windows Runtime doesnâ€™t support a Binding usage for Setter.Value (the Binding wonâ€™t evaluate and the Setter has no effect, you wonâ€™t get errors, but you wonâ€™t get the desired result either). When you convert XAML styles from Windows Presentation Foundation (WPF) or Microsoft Silverlight XAML, replace any Binding expression usages with strings or objects that set values, or refactor the values as shared {StaticResource} markup extension values rather than Binding -obtained values.</p>
</blockquote>

<p>åœ¨è¿™é‡Œæ˜¯å‡ ä¹æ— æ³•é€šè¿‡é™æ€èµ„æºåšåˆ°ç»‘å®šçš„ï¼Œé‚£ä¹ˆå¦‚ä½•è®©åœ¨åå°ä»£ç ä¿®æ”¹çš„æ—¶å€™ï¼Œå¯ä»¥ä¿®æ”¹ xaml é‡Œé¢çš„ ListView çš„åˆ—è¡¨æ˜¾ç¤ºæ–¹å‘ç»‘å®šåˆ°åå°çš„å±æ€§ï¼Ÿ</p>

<p>åœ¨åå°ä»£ç åˆ›å»ºä¸€ä¸ªå¸®åŠ©ç»‘å®šçš„ç±»ï¼Œè¿™ä¸ªç±»é‡Œé¢åŒ…å«äº†ä¸€ä¸ªé™„åŠ å±æ€§ï¼Œå°†ä¼šåœ¨è¿™ä¸ªé™„åŠ å±æ€§é‡Œé¢å°è¯•ç»‘å®š</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">public</span> <span class="k">class</span> <span class="nc">BindingHelper</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">DependencyProperty</span> <span class="n">ItemsPanelOrientationProperty</span> <span class="p">=</span> <span class="n">DependencyProperty</span><span class="p">.</span><span class="nf">RegisterAttached</span><span class="p">(</span>
            <span class="s">"ItemsPanelOrientation"</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="kt">bool</span><span class="p">),</span> <span class="k">typeof</span><span class="p">(</span><span class="n">BindingHelper</span><span class="p">),</span>
            <span class="k">new</span> <span class="nf">PropertyMetadata</span><span class="p">(</span><span class="k">default</span><span class="p">(</span><span class="kt">bool</span><span class="p">),</span> <span class="n">ItemsPanelOrientation_OnPropertyChanged</span><span class="p">));</span>

    <span class="p">}</span>
</code></pre></div></div>

<p>æ ¸å¿ƒå°±åœ¨ <code class="language-plaintext highlighter-rouge">ItemsPanelOrientation_OnPropertyChanged</code> æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢æ‰¾åˆ° ItemsStackPanel ç„¶åè®¾ç½®ç»‘å®š</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">private</span> <span class="k">static</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">ItemsPanelOrientation_OnPropertyChanged</span><span class="p">(</span><span class="n">DependencyObject</span> <span class="n">d</span><span class="p">,</span>
            <span class="n">DependencyPropertyChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="k">is</span> <span class="n">ListView</span> <span class="n">listView</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">await</span> <span class="n">listView</span><span class="p">.</span><span class="n">Dispatcher</span><span class="p">.</span><span class="nf">RunAsync</span><span class="p">(</span><span class="n">CoreDispatcherPriority</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">listView</span><span class="p">.</span><span class="n">ItemsPanelRoot</span> <span class="k">is</span> <span class="n">ItemsStackPanel</span> <span class="n">stackPanel</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">BindingOperations</span><span class="p">.</span><span class="nf">SetBinding</span><span class="p">(</span><span class="n">stackPanel</span><span class="p">,</span> <span class="n">ItemsStackPanel</span><span class="p">.</span><span class="n">OrientationProperty</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Binding</span><span class="p">()</span>
                        <span class="p">{</span>
                            <span class="n">Path</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PropertyPath</span><span class="p">(</span><span class="s">"Orientation"</span><span class="p">),</span>
                            <span class="n">Mode</span> <span class="p">=</span> <span class="n">BindingMode</span><span class="p">.</span><span class="n">OneWay</span>
                        <span class="p">});</span>
                    <span class="p">}</span>
                <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>é‚£ä¹ˆä¸ºä»€ä¹ˆéœ€è¦åœ¨ <code class="language-plaintext highlighter-rouge">listView.Dispatcher.RunAsync</code> é‡Œé¢ç»‘å®šï¼Ÿå› ä¸ºåˆå§‹çš„æ—¶å€™ <code class="language-plaintext highlighter-rouge">listView.ItemsPanelRoot</code> æ˜¯æ²¡æœ‰å€¼çš„ï¼Œéœ€è¦ç­‰å¾…åˆ›å»ºå®Œæˆè¿™ä¸ªå±æ€§</p>

<p>ä¸Šé¢çš„ä»£ç æ˜¯ç›´æ¥ç»‘å®šï¼Œç»‘å®šåˆ° DataContext ä¹Ÿå°±æ˜¯éœ€è¦åœ¨ ListView æŒ‡å®š DataContext æ‰å¯ä»¥ç»‘å®š</p>

<p>æŒ‡å®šå½“å‰çš„ Page ä½œä¸º ListView çš„ DataContext è¯·çœ‹ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="n">Page</span> <span class="n">x</span><span class="p">:</span><span class="n">Name</span><span class="p">=</span><span class="s">"Page1"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">ListView</span> <span class="n">DataContext</span><span class="p">=</span><span class="s">"{x:Bind Page1}"</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>åœ¨æ ·å¼é‡Œé¢å¤šè®¾ç½®ä¸€ä¸ªé™„åŠ å±æ€§ï¼Œè¿™é‡Œçš„ Orientation ç»‘å®šæ˜¯ä¸ä¼šç»‘å®šçš„</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                <span class="p">&lt;</span><span class="n">Style</span> <span class="n">TargetType</span><span class="p">=</span><span class="s">"ListView"</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="n">Setter</span> <span class="n">Property</span><span class="p">=</span><span class="s">"ItemsPanel"</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="n">Setter</span><span class="p">.</span><span class="n">Value</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="n">ItemsPanelTemplate</span><span class="p">&gt;</span>
                                <span class="p">&lt;</span><span class="n">ItemsStackPanel</span> <span class="n">Orientation</span><span class="p">=</span><span class="s">"{Binding Orientation, RelativeSource={RelativeSource Mode=TemplatedParent}}"</span><span class="p">/&gt;</span>
                            <span class="p">&lt;/</span><span class="n">ItemsPanelTemplate</span><span class="p">&gt;</span>
                        <span class="p">&lt;/</span><span class="n">Setter</span><span class="p">.</span><span class="n">Value</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="n">Setter</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="n">Setter</span> <span class="n">Property</span><span class="p">=</span><span class="s">"local:BindingHelper.ItemsPanelOrientation"</span> <span class="n">Value</span><span class="p">=</span><span class="s">"True"</span><span class="p">&gt;&lt;/</span><span class="n">Setter</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="n">Style</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>æ·»åŠ ä¸€äº›å…ƒç´ ç”¨äº ListView è¿›è¡Œæµ‹è¯•</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">&lt;</span><span class="n">Page</span>
    <span class="n">x</span><span class="p">:</span><span class="n">Class</span><span class="p">=</span><span class="s">"KeejemairbouLirallpurpallnasfakaw.MainPage"</span>
    <span class="n">xmlns</span><span class="p">=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
    <span class="n">xmlns</span><span class="p">:</span><span class="n">x</span><span class="p">=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
    <span class="n">xmlns</span><span class="p">:</span><span class="n">local</span><span class="p">=</span><span class="s">"using:KeejemairbouLirallpurpallnasfakaw"</span>
    <span class="n">xmlns</span><span class="p">:</span><span class="n">d</span><span class="p">=</span><span class="s">"http://schemas.microsoft.com/expression/blend/2008"</span>
    <span class="n">xmlns</span><span class="p">:</span><span class="n">mc</span><span class="p">=</span><span class="s">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span>
    <span class="n">mc</span><span class="p">:</span><span class="n">Ignorable</span><span class="p">=</span><span class="s">"d"</span>
    <span class="n">x</span><span class="p">:</span><span class="n">Name</span><span class="p">=</span><span class="s">"Page1"</span>
    <span class="n">Background</span><span class="p">=</span><span class="s">"{ThemeResource ApplicationPageBackgroundThemeBrush}"</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="n">Grid</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">ListView</span> <span class="n">DataContext</span><span class="p">=</span><span class="s">"{x:Bind Page1}"</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="n">ListView</span><span class="p">.</span><span class="n">Style</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="n">Style</span> <span class="n">TargetType</span><span class="p">=</span><span class="s">"ListView"</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="n">Setter</span> <span class="n">Property</span><span class="p">=</span><span class="s">"ItemsPanel"</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="n">Setter</span><span class="p">.</span><span class="n">Value</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="n">ItemsPanelTemplate</span><span class="p">&gt;</span>
                                <span class="p">&lt;</span><span class="n">ItemsStackPanel</span> <span class="p">/&gt;</span>
                            <span class="p">&lt;/</span><span class="n">ItemsPanelTemplate</span><span class="p">&gt;</span>
                        <span class="p">&lt;/</span><span class="n">Setter</span><span class="p">.</span><span class="n">Value</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="n">Setter</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="n">Setter</span> <span class="n">Property</span><span class="p">=</span><span class="s">"local:BindingHelper.ItemsPanelOrientation"</span> <span class="n">Value</span><span class="p">=</span><span class="s">"True"</span><span class="p">&gt;&lt;/</span><span class="n">Setter</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="n">Style</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="n">ListView</span><span class="p">.</span><span class="n">Style</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="n">ListView</span><span class="p">.</span><span class="n">Items</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="n">TextBlock</span> <span class="n">Text</span><span class="p">=</span><span class="s">"1"</span><span class="p">&gt;&lt;/</span><span class="n">TextBlock</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="n">TextBlock</span> <span class="n">Text</span><span class="p">=</span><span class="s">"2"</span><span class="p">&gt;&lt;/</span><span class="n">TextBlock</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="n">TextBlock</span> <span class="n">Text</span><span class="p">=</span><span class="s">"3"</span><span class="p">&gt;&lt;/</span><span class="n">TextBlock</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="n">ListView</span><span class="p">.</span><span class="n">Items</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="n">ListView</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="n">Grid</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">Page</span><span class="p">&gt;</span>

</code></pre></div></div>

<p>åœ¨åå°ä»£ç çš„æ„é€ å‡½æ•°å†™ä¸€ä¸ªå¾ªç¯ï¼Œå®šæ—¶ä¿®æ”¹åå°å±æ€§çš„æ–¹å‘çš„å¤§å°è¯·çœ‹ä»£ç </p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">public</span> <span class="nf">MainPage</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nf">InitializeComponent</span><span class="p">();</span>

            <span class="n">Task</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">await</span> <span class="n">Dispatcher</span><span class="p">.</span><span class="nf">RunAsync</span><span class="p">(</span><span class="n">CoreDispatcherPriority</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span>
                        <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">Orientation</span> <span class="p">=</span> <span class="n">Orientation</span><span class="p">.</span><span class="n">Horizontal</span><span class="p">;</span> <span class="p">});</span>

                    <span class="k">await</span> <span class="n">Task</span><span class="p">.</span><span class="nf">Delay</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">5</span><span class="p">));</span>

                    <span class="k">await</span> <span class="n">Dispatcher</span><span class="p">.</span><span class="nf">RunAsync</span><span class="p">(</span><span class="n">CoreDispatcherPriority</span><span class="p">.</span><span class="n">Normal</span><span class="p">,</span>
                        <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">Orientation</span> <span class="p">=</span> <span class="n">Orientation</span><span class="p">.</span><span class="n">Vertical</span><span class="p">;</span> <span class="p">});</span>

                    <span class="k">await</span> <span class="n">Task</span><span class="p">.</span><span class="nf">Delay</span><span class="p">(</span><span class="n">TimeSpan</span><span class="p">.</span><span class="nf">FromSeconds</span><span class="p">(</span><span class="m">5</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>ç°åœ¨çœ‹èµ·æ¥çš„ç•Œé¢æ˜¯</p>

<p><img src="http://image.acmx.xyz/lindexi%2F201931610244652" alt="" /></p>

<p>å†™åˆ°è¿™é‡Œçš„ä»£ç è¯·çœ‹ <a href="https://github.com/lindexi/lindexi_gd/tree/43ee46e847179b61157c5bfbbdec0382ccc97268/KeejemairbouLirallpurpallnasfakaw">https://github.com/lindexi/lindexi_gd/tree/43ee46e847179b61157c5bfbbdec0382ccc97268/KeejemairbouLirallpurpallnasfakaw</a></p>

<p>ä¸è¿‡é™„åŠ å±æ€§é‡Œé¢ä½¿ç”¨å»¶è¿Ÿè¿˜æ˜¯ä¸é è°±ï¼Œå¯èƒ½å»¶è¿Ÿæ‹¿åˆ°çš„ ListView çš„æ•°æ®æ˜¯ç©ºï¼Œæ‰€ä»¥å»ºè®®çš„æ–¹æ³•æ˜¯ä¿®æ”¹é™„åŠ å±æ€§</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">public</span> <span class="k">class</span> <span class="nc">BindingHelper</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">DependencyProperty</span> <span class="n">ItemsPanelOrientationProperty</span> <span class="p">=</span> <span class="n">DependencyProperty</span><span class="p">.</span><span class="nf">RegisterAttached</span><span class="p">(</span>
            <span class="s">"ItemsPanelOrientation"</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="kt">bool</span><span class="p">),</span> <span class="k">typeof</span><span class="p">(</span><span class="n">BindingHelper</span><span class="p">),</span>
            <span class="k">new</span> <span class="nf">PropertyMetadata</span><span class="p">(</span><span class="k">default</span><span class="p">(</span><span class="kt">bool</span><span class="p">),</span> <span class="n">ItemsPanelOrientation_OnPropertyChanged</span><span class="p">));</span>

        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">ItemsPanelOrientation_OnPropertyChanged</span><span class="p">(</span><span class="n">DependencyObject</span> <span class="n">d</span><span class="p">,</span>
            <span class="n">DependencyPropertyChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="k">is</span> <span class="n">ListView</span> <span class="n">listView</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">listView</span><span class="p">.</span><span class="n">IsLoaded</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="nf">SetBind</span><span class="p">(</span><span class="n">listView</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">listView</span><span class="p">.</span><span class="n">Loaded</span> <span class="p">+=</span> <span class="n">ListView_Loaded</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">ListView_Loaded</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nf">SetBind</span><span class="p">((</span><span class="n">ListView</span><span class="p">)</span> <span class="n">sender</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">SetBind</span><span class="p">(</span><span class="n">ListView</span> <span class="n">listView</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">listView</span><span class="p">.</span><span class="n">ItemsPanelRoot</span> <span class="k">is</span> <span class="n">ItemsStackPanel</span> <span class="n">stackPanel</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">BindingOperations</span><span class="p">.</span><span class="nf">SetBinding</span><span class="p">(</span><span class="n">stackPanel</span><span class="p">,</span> <span class="n">ItemsStackPanel</span><span class="p">.</span><span class="n">OrientationProperty</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Binding</span><span class="p">()</span>
                <span class="p">{</span>
                    <span class="n">Path</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PropertyPath</span><span class="p">(</span><span class="s">"Orientation"</span><span class="p">),</span>
                    <span class="n">Mode</span> <span class="p">=</span> <span class="n">BindingMode</span><span class="p">.</span><span class="n">OneWay</span>
                <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">SetItemsPanelOrientation</span><span class="p">(</span><span class="n">DependencyObject</span> <span class="n">element</span><span class="p">,</span> <span class="kt">bool</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">element</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">ItemsPanelOrientationProperty</span><span class="p">,</span> <span class="k">value</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">GetItemsPanelOrientation</span><span class="p">(</span><span class="n">DependencyObject</span> <span class="n">element</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="n">element</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">ItemsPanelOrientationProperty</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

:ET